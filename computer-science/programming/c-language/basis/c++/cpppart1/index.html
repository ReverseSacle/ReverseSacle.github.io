<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content=#222><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=icon type=image/ico sizes=48x48 href=/images/favicon.ico><link rel=alternate type=application/rss+xml title=逆转天平 href=https://www.reversesacle.com/rss.xml><link rel=alternate type=application/atom+xml title=逆转天平 href=https://www.reversesacle.com/atom.xml><link rel=alternate type=application/json title=逆转天平 href=https://www.reversesacle.com/feed.json><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel=stylesheet href=/css/app.css><meta name=description content=编程语言><link rel=canonical href=https://www.reversesacle.com/computer-science/programming/c-language/basis/c++/cpppart1/ ><title>C++基础知识-第一部分-C++98/03标准 - C++基础 - C语言 - 编程 - 计算机科学 | ReverseSacle-Blog</title><meta name=generator content="Hexo 6.3.0"></head><body itemscope itemtype=http://schema.org/WebPage><div id=loading><div class=dotloader><div class=dot></div><div class=dot></div><div class=dot></div><div class=dot></div><div class=dot></div></div></div><div id=container><header id=header itemscope itemtype=http://schema.org/WPHeader><div class=inner><div id=brand><div class=pjax><h1 itemprop="name headline">C++基础知识-第一部分-C++98/03标准</h1><div class=meta><span class=item title="创建时间：2022-02-18 16:51:20"><span class=icon><i class="ic i-calendar"></i></span> <span class=text>发表于</span> <time itemprop="dateCreated datePublished" datetime=2022-02-18T16:51:20+08:00>2022-02-18</time></span><span class=item title=本文字数><span class=icon><i class="ic i-pen"></i></span> <span class=text>本文字数</span> <span>56k</span> <span class=text>字</span></span><span class=item title=阅读时长><span class=icon><i class="ic i-clock"></i></span> <span class=text>阅读时长</span> <span>1:05</span></span></div></div></div><nav id=nav><div class=inner><div class=toggle><div class=lines role=navigation aria-label=切换导航栏><span class=line></span><span class=line></span><span class=line></span></div></div><ul class=menu><li class="item title"><a href=/ rel=start>ReverseSacle-Blog</a></li></ul><ul class=right><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id=imgs class=pjax><ul><li class=item data-background-image=https://resa-imgs.oss-accelerate.aliyuncs.com/img/acg16.webp></li><li class=item data-background-image=https://resa-imgs.oss-accelerate.aliyuncs.com/img/acg4.webp></li><li class=item data-background-image=https://resa-imgs.oss-accelerate.aliyuncs.com/img/acg12.webp></li><li class=item data-background-image=https://resa-imgs.oss-accelerate.aliyuncs.com/img/acg14.webp></li><li class=item data-background-image=https://resa-imgs.oss-accelerate.aliyuncs.com/img/acg11.webp></li><li class=item data-background-image=https://resa-imgs.oss-accelerate.aliyuncs.com/img/acg5.webp></li></ul></div></header><div id=waves><svg class=waves xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink viewBox="0 24 150 28" preserveAspectRatio=none shape-rendering=auto><defs><path id=gentle-wave d="M-160 44c30 0 58-18 88-18s58 18 88 18 58-18 88-18 58 18 88 18v44h-352z"/></defs><g class=parallax><use xlink:href=#gentle-wave x=48 y=0 /><use xlink:href=#gentle-wave x=48 y=3 /><use xlink:href=#gentle-wave x=48 y=5 /><use xlink:href=#gentle-wave x=48 y=7 /></g></svg></div><main><div class=inner><div id=main class=pjax><div class="article wrap"><div class=breadcrumb itemscope itemtype=https://schema.org/BreadcrumbList><i class="ic i-home"></i> <span><a href=/ >首页</a></span><i class="ic i-angle-right"></i> <span itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=/categories/computer-science/ itemprop=item rel=index title="分类于 计算机科学"><span itemprop=name>计算机科学</span></a><meta itemprop=position content=1></span><i class="ic i-angle-right"></i> <span itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=/categories/computer-science/programming/ itemprop=item rel=index title="分类于 编程"><span itemprop=name>编程</span></a><meta itemprop=position content=2></span><i class="ic i-angle-right"></i> <span itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=/categories/computer-science/programming/c-language/ itemprop=item rel=index title="分类于 C语言"><span itemprop=name>C语言</span></a><meta itemprop=position content=3></span><i class="ic i-angle-right"></i> <span class=current itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=/categories/computer-science/programming/c-language/cpp-basic/ itemprop=item rel=index title="分类于 C++基础"><span itemprop=name>C++基础</span></a><meta itemprop=position content=4></span></div><article itemscope itemtype=http://schema.org/Article class="post block" lang=zh-CN><link itemprop=mainEntityOfPage href=https://www.reversesacle.com/computer-science/programming/c-language/basis/c++/cpppart1/ ><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content=/images/avatar.webp><meta itemprop=name content=ReverseSacle><meta itemprop=description content="所见即所得，所思即所行, 知识书库 & 学习点滴"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content=逆转天平></span><div class="body md" itemprop=articleBody><div class="note info no-icon"><p>以C语言为底层基础的C++基础知识</p><p>带<code>?</code>的是对整体基础的补充项</p><p>持续修正中.....</p></div><h2 id=概述><a class=anchor href=#概述>#</a> 概述</h2><p>1983年，贝尔实验室的Bjarne Stroustrup开始开发<code>C++</code>，最初称为<code>C with Classes</code>。</p><ul><li>1998年，第一个国际标准<code>C++98</code>(ISO/IEC 14882:1998)发布</li><li>2003年，<code>C++03</code>(ISO/IEC 14882:2003)发布，主要是对<code>C++98</code>进行错误修正和小幅改进。</li><li>2011年，<code>C++11</code>(ISO/IEC 14882:2011)发布，原名<code>C++0x</code>。</li><li>2014年，<code>C++14</code>(ISO/IEC 14882:2014)发布，主要是对<code>C++11</code>进行改进和补充。</li><li>2017年，<code>C++17</code>(ISO/IEC 14882:2017)发布，引入了一些重要的新特性和改进。</li><li>2020年，<code>C++20</code>(ISO/IEC 14882:2020)发布，引入了许多新特性。</li></ul><p><code>C++</code>是一种通用编程语言，它是C语言的扩展，并引入了面向对象编程(OOP)的特性。</p><details class=info><summary>面向对象？</summary><div><p><strong>面向对象</strong>是一种编程范式，更强调数据和方法的封装、继承和多态，强调对象之间的交互和关系，就是把构成问题事务分解成各个对象，建立对象的目的不是为了完成一个步骤，而是为了描叙某个事物在整个解决问题的步骤中的行为。</p><ul><li>优点 - 易维护、易复用、易扩展，由于面向对象有封装、继承、多态性的特性，可以设计出低耦合的系统，使系统更加灵活、更加易于维护</li><li>缺点 - 性能比面向过程低</li></ul></div></details><h2 id=初始化赋值><a class=anchor href=#初始化赋值>#</a> 初始化赋值</h2><p>可以把值写在小括号中，等于号可以省略</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">int</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id=相关输入输出基本操作><a class=anchor href=#相关输入输出基本操作>#</a> 相关输入/输出基本操作</h2><table><thead><tr><th style=text-align:left>操作符/命令</th><th style=text-align:left>描述</th></tr></thead><tbody><tr><td style=text-align:left><code>std::cout &lt;&lt;</code></td><td style=text-align:left>输出各种类型的数据</td></tr><tr><td style=text-align:left><code>std::cin &gt;&gt;</code></td><td style=text-align:left>为变量输入值</td></tr><tr><td style=text-align:left><code>&lt;&lt;</code>操作符</td><td style=text-align:left>可以拼接多个数据项，例如<code>&lt;&lt; 数据1 &lt;&lt; 数据2</code></td></tr><tr><td style=text-align:left><code>std::endl</code></td><td style=text-align:left>用于换行</td></tr><tr><td style=text-align:left><code>using namespace std</code></td><td style=text-align:left>指定缺省的命名空间<code>std</code>，例如<code>std::cout</code>可简写为<code>cout</code></td></tr></tbody></table><details class=info><summary>using关键字有什么用？</summary><div><p><strong>别名声明(Type Alias)</strong> - <code>using</code>可以用来创建类型别名。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">using</span> MyInt <span class="token operator">=</span> <span class="token keyword">int</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> DoubleVector <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre>MyInt i <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre>DoubleVector vec <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>命名空间别名</strong> - <code>using</code>可以用来给命名空间起别名。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">namespace</span> VeryLongNamespaceName <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=2></td><td><pre>    <span class="token comment">// ...</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=4></td><td><pre></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token comment">// 别名</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">using</span> VLN <span class="token operator">=</span> VeryLongNamespaceName<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token comment">// 使用别名</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token class-name">VLN</span><span class="token double-colon punctuation">::</span><span class="token function">someFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>using指令(using Directive)</strong> - <code>using</code>可以用作命名空间的引入指令，使得命名空间中的所有成员都可以直接使用，而不需要通过命名空间限定符。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">// 引入命名空间</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> SomeNamespace<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token comment">// 可直接使用 SomeNamespace 中的成员</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token function">someFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>using模板</strong> - 在模板编程中，<code>using</code>用于引入模板别名。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">template</span> <span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> MyContainer <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre>MyContainer<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> myVector<span class="token punctuation">;</span></pre></td></tr></table></figure></div></details><details class=info><summary>是否该直接使用using namespace std？</summary><div><p>尽管<code>using namespace std;</code>是一种方便的方法，但它可能会引入一些潜在的问题，特别是在较大的项目中或者在头文件中使用时，因为 <code>std</code> 命名空间中的标识符可能会与用户定义的标识符冲突，导致意外的行为。</p><p>只在必要时使用<code>using</code>声明，避免引入整个<code>std</code>命名空间</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cout<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cin<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr></table></figure></div></details><h2 id=数据类型><a class=anchor href=#数据类型>#</a> 数据类型</h2><p><strong>整形</strong></p><ul><li>下面的<code>0</code> → 零</li><li>二进制书写时必须以<code>0b</code>或<code>0B</code>开头，例如<code>int b = 0B100111</code>(并非C++标准，而是编译器自带)</li><li>十六进制书写时必须以<code>0x</code>或<code>0X</code>开头，例如<code>int b = Oxffff</code></li><li>书写十进制时，不要在前面加0，会被编译器当成八进制</li></ul><p><strong>字符串</strong></p><p><code>string</code>不是C++的基本数据类型而是<strong>类</strong>，用sizeof关键字求取占用内存的字节大小是没有意义的。</p><p><code>string</code>类型是通过动态分配内存来存储字符序列的，末尾不是以<code>\0</code>为终止符，与C语言的字符串以终止符<code>\0</code>来表示字符结束不同。</p><p><code>string</code>类型会在内部记录字符串的长度，因此不需要使用终止符来表示字符串的结束。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>cin<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">using</span> std<span class="token double-colon punctuation">::</span>string<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=6></td><td><pre></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=9></td><td><pre>    string str <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre>    cin <span class="token operator">>></span> str<span class="token punctuation">;</span><span class="token comment">// 以空格为分隔符，手动输入字符串</span></pre></td></tr><tr><td data-num=11></td><td><pre>    <span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 获取输入的整行字符</span></pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><code>std::string</code>类型传递给C语言的<code>char*</code>类型时，需先使用<code>c_str()</code>成员函数来获取字符串的C风格表示(以<code>\0</code>结尾的字符数组)，然后再将其传递给接受<code>char*</code>参数的C函数。这是因为<code>std::string</code>使用动态内存分配来存储字符串，而C风格的字符串是以<code>\0</code>结尾的字符数组。</p><p>如果需要在C函数中修改字符串，不能直接在<code>c_str()</code>返回的指针上进行修改，因为<code>c_str()</code>返回的是一个指向<code>const char</code>的指针，试图在其上进行修改是未定义行为。</p><details class=info><summary>C++中怎么定义常量？常量存放在内存的哪个位置？</summary><div><p>在C++中，可以使用关键字<code>const</code>或<code>constexpr(C++11标准)</code>来定义常量。常量是一种不可变的值，它的值在程序执行过程中不会改变。</p><p><strong>常量存放在内存的位置</strong></p><ul><li><p><strong>放在符号表中</strong> - 对于普通的常量(如<code>const int</code>)，它们通常会被放在程序的符号表中。符号表是一个数据结构，存储了变量名和其对应的内存地址</p></li><li><p><strong>放在代码段中</strong> - 对于一些常量表达式，编译器可能会将它们直接嵌入到生成的机器代码中，这样常量就被存放在代码段(<code>.text</code>段)中。这样的常量在程序运行期间是只读的</p></li><li><p><strong>放在数据段中</strong> - 在一些情况下，特别是当常量较大或者需要在运行时计算得到时，编译器可能会将常量放在数据段(<code>.data</code>段)中</p></li></ul></div></details><h2 id=函数><a class=anchor href=#函数>#</a> 函数</h2><h3 id=默认函数参数><a class=anchor href=#默认函数参数>#</a> 默认函数参数</h3><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">int</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span><span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token comment">// Err ,声明和实现中只能其中一个有默认参数</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token comment">int func1(int a,int b = 10) &#123;</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token comment">	return a + b;</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token comment">&#125;</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=10></td><td><pre></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token comment">// Err ,从开始有默认参数的位置起，到最后都需要有默认参数</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token comment">int func1(int a,int b = 10,int c) &#123;</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token comment">    return a + b</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token comment">&#125;</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=17></td><td><pre></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">int</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span><span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=19></td><td><pre>    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=21></td><td><pre></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=24></td><td><pre>    <span class="token keyword">int</span> ret2 <span class="token operator">=</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 默认参数可不填</span></pre></td></tr><tr><td data-num=25></td><td><pre></pre></td></tr><tr><td data-num=26></td><td><pre>    <span class="token comment">// 如果函数有默认值，</span></pre></td></tr><tr><td data-num=27></td><td><pre>    <span class="token comment">// 当传值时，不能只传入其中一个实参，全部默认参数值都需填写。</span></pre></td></tr><tr><td data-num=28></td><td><pre>    <span class="token comment">//int ret1 = func2(10,20);// Err</span></pre></td></tr><tr><td data-num=29></td><td><pre>    <span class="token keyword">int</span> ret3 <span class="token operator">=</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=30></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id=占位参数><a class=anchor href=#占位参数>#</a> 占位参数</h3><p>可用于区别<code>前置++</code>与<code>后置++</code>。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token comment">// 占位参数只需类型</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">int</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=5></td><td><pre>    <span class="token keyword">return</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token comment">// 占位参数也可以有默认值</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">int</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token keyword">return</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=11></td><td><pre></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 占位参数也需要传参</span></pre></td></tr><tr><td data-num=15></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id=函数重载><a class=anchor href=#函数重载>#</a> 函数重载</h3><p>函数重载是<code>C++</code>中一种允许在同一作用域内定义多个具有相同名称但参数列表不同的函数的特性。</p><p><strong>条件</strong></p><ul><li>同一作用域</li><li>函数名称相同</li><li>函数参数类型不同、或个数不同、或顺序不同</li><li>当有多个函数能匹配时会报错</li><li>const不能作为函数重载的特征</li></ul><p>返回类型与函数重载无关；参数名称与函数重载无关。</p><figure class="highlight cpp"><figcaption data-lang=C++><span>函数重载案例1</span></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">// 原始函数</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=3></td><td><pre>    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=5></td><td><pre></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token comment">// 形参类型不同</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">char</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=10></td><td><pre></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token comment">// 形参顺序不同</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> b<span class="token punctuation">,</span><span class="token keyword">char</span> a<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=13></td><td><pre>    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=15></td><td><pre></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token comment">// 形参个数不同</span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">,</span><span class="token keyword">int</span> c<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=18></td><td><pre>    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight cpp"><figcaption data-lang=C++><span>函数重载案例2</span></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token comment">// 原始函数</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">&amp;</span> a<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"int&amp; a"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=8></td><td><pre></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token comment">// const不能作为重载依据</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> a<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=11></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"const int&amp; a"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=13></td><td><pre></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token comment">/**********************************************/</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token comment">// 传入常量10，int&amp; a = 10不合法</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">void</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">&amp;</span> a<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=17></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"int&amp; a"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=19></td><td><pre></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token comment">// 传入常量10，const int&amp; a = 10，</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token comment">// 由编译器解析为int temp = 10;int&amp; a = temp;</span></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token keyword">void</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> a<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=23></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"const int&amp; a"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token comment">/**********************************************/</span></pre></td></tr><tr><td data-num=26></td><td><pre></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token comment">// 默认函数参数会导致有多个函数能匹配</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token keyword">void</span> <span class="token function">func3</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=29></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"int&amp; a"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=31></td><td><pre></pre></td></tr><tr><td data-num=32></td><td><pre><span class="token keyword">void</span> <span class="token function">func3</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=33></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"const int&amp; a"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=34></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=35></td><td><pre></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=38></td><td><pre>    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=39></td><td><pre>    </pre></td></tr><tr><td data-num=40></td><td><pre>    <span class="token function">func</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 调用为int&amp; a</span></pre></td></tr><tr><td data-num=41></td><td><pre>    <span class="token function">func2</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 调用为int&amp; a</span></pre></td></tr><tr><td data-num=42></td><td><pre>    <span class="token comment">//func3(10);// Err 出现二异性</span></pre></td></tr><tr><td data-num=43></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>z</pre></td></tr><tr><td data-num=44></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><details class=info><summary>函数重载的优缺点？</summary><div><p><strong>优点</strong></p><ul><li><p><strong>更直观的接口设计</strong> - 函数重载允许使用相同的函数名来表示相关性很强的操作，从而提高了代码的可读性和直观性。例如，可以定义多个<code>print</code>函数，分别用于输出不同类型的数据，而不需要为每个类型起不同的函数名</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=2></td><td><pre>    <span class="token comment">// 输出整数</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=4></td><td><pre></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">double</span> value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token comment">// 输出浮点数</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=8></td><td><pre></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string<span class="token operator">&amp;</span> value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token comment">// 输出字符串</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li><li><p><strong>避免命名冲突</strong> - 函数重载允许在同一作用域内定义多个函数，避免了不同功能的函数之间的命名冲突。如果没有函数重载，为了区分不同功能的函数，可能需要给它们起更长的、更复杂的名字</p></li></ul><p><strong>缺点</strong></p><ul><li><p><strong>可能导致混淆</strong> - 函数重载在一些情况下可能导致代码的混淆，尤其是在函数参数类型相近但有细微差异的情况下。这可能会引起一些不易察觉的错误</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">void</span> <span class="token function">processData</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=2></td><td><pre>    <span class="token comment">// 处理整数数据</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=4></td><td><pre></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">void</span> <span class="token function">processData</span><span class="token punctuation">(</span><span class="token keyword">double</span> value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token comment">// 处理浮点数数据</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=8></td><td><pre></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=10></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=11></td><td><pre>    <span class="token function">processData</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 调用哪个函数？</span></pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li><li><p><strong>增加编译时和运行时开销</strong> - 编译器需要根据函数调用的上下文来确定调用哪个函数，这可能导致编译时的开销增加。而在运行时，需要进行函数匹配，这可能导致一些微小的性能损失</p></li><li><p><strong>不支持返回类型重载</strong> - 函数重载不能仅仅通过返回类型的不同来区分函数，因为<code>C++</code>不允许仅通过返回类型的不同来进行函数重载。这可能在某些情况下限制了函数重载的灵活性</p></li></ul></div></details><details class=info><summary>函数传递参数有哪几种方式？</summary><div><ul><li><p><strong>传值(Pass by Value)</strong> - 参数的实际值被复制到函数的形式参数中。在函数内部对形式参数的修改不影响实际参数</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">void</span> <span class="token function">passByValue</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=2></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=3></td><td><pre>    <span class="token comment">// 对 x 的修改不影响调用方的变量</span></pre></td></tr><tr><td data-num=4></td><td><pre>    x <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li><li><p><strong>传引用(Pass by Reference)</strong> - 参数通过引用传递，函数可以直接修改调用方的变量，引用用<code>&amp;</code>表示</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">void</span> <span class="token function">passByReference</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=2></td><td><pre>    x <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li><li><p><strong>传指针(Pass by Pointer)</strong> - 与传引用类似，通过指针传递参数，允许函数修改调用方的变量，指针用<code>*</code>表示</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">void</span> <span class="token function">passByPointer</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>x<span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=2></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=3></td><td><pre>    <span class="token comment">// 通过指针修改 x 指向的变量</span></pre></td></tr><tr><td data-num=4></td><td><pre>    <span class="token operator">*</span>x <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li><li><p><strong>传递const引用(Pass by Const Reference)</strong> - 通过const引用传递参数，可以避免不必要的复制，并且防止函数内部修改调用方的变量，通常用于大型对象的传递，以避免复制整个对象。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">void</span> <span class="token function">passByConstReference</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">&amp;</span>x<span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=2></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=3></td><td><pre>    <span class="token comment">// x 是只读的，无法在函数内部修改</span></pre></td></tr><tr><td data-num=4></td><td><pre>    <span class="token comment">// 但可以使用 x 的值</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li><li><p><strong>传递数组</strong> - 数组名作为指针传递给函数。可以使用指针或引用方式，数组传递给函数时，传递了数组的首地址</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">void</span> <span class="token function">passArray</span><span class="token punctuation">(</span><span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> size<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=2></td><td><pre>    <span class="token comment">// 使用数组</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=4></td><td><pre></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token comment">// 或者使用引用</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">void</span> <span class="token function">passArrayReference</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token comment">// 使用数组</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li></ul></div></details><details class=info><summary>如何让函数在main函数执行前执行？</summary><div><p>在<code>C++</code>中，全局对象(global objects)的构造函数会在<code>main</code>函数执行之前被调用。在C语言中，没有类似于<code>C++</code>中全局对象构造函数的概念。在C语言中，全局变量的初始化是在程序启动时进行的，但是没有直接的机制可以在<code>main</code>函数执行前执行特定的代码。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token comment">// 全局对象，构造函数中的代码会在main函数执行前执行</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">struct</span> <span class="token class-name">GlobalInitializer</span> </pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token function">GlobalInitializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=8></td><td><pre>        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Initialization before main."</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre>        <span class="token comment">// 这里可以添加需要在main函数执行前执行的代码</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token comment">// 全局对象，构造函数中的代码会在main函数执行前执行</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">static</span> GlobalInitializer initializer<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=17></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=18></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Inside main."</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre>    <span class="token comment">// 这里是 main 函数的代码</span></pre></td></tr><tr><td data-num=20></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></div></details><h2 id=内存管理操作><a class=anchor href=#内存管理操作>#</a> 内存管理操作</h2><p><code>new</code>操作符 - 用于动态分配内存以创建对象或数组</p><p><code>delete</code>操作符 - 用于释放动态分配的内存</p><p><code>new</code>操作符内存分配成功时，返回的是对象类型的指针，类型严格与对象匹配，无须进行类型转换，故new是符合<strong>类型安全</strong>性的操作符。</p><p><code>malloc</code>内存分配成功则是返回<code>void *</code>，需要通过强制类型转换将<code>void *</code>指针转换成我们需要的类型。 类型安全很大程度上可以等价于内存安全，类型安全的代码不会试图返回自己没被授权的内存区域。</p><p><strong>变量的堆内存申请与释放</strong></p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=5></td><td><pre>    <span class="token comment">// 申请1个int字节大小的内存空间，并初始化为10</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token keyword">int</span><span class="token operator">*</span> val <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">delete</span> val<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><strong>数组的堆内存申请与释放</strong></p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=5></td><td><pre>    <span class="token keyword">int</span><span class="token operator">*</span> array <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 申请10个int字节大小的内存空间</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token comment">// 申请10个int字节大小的内存空间，并初始化为0</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">int</span><span class="token operator">*</span> array2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre>    </pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token comment">// 未定义的写法❌</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token comment">// int* array2 = new int[10](1);</span></pre></td></tr><tr><td data-num=11></td><td><pre>    </pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> array<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre>    <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> array2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><details class=info><summary>new操作符如何为对象分配内存？</summary><div><p>使用new操作符来分配对象内存时会经历三个步骤</p><ul><li>第一步 - 调用operator new函数(对于数组是operator new[])分配一块足够大的/<strong>原始</strong>的/未命名的内存空间以便存储特定类型的对象</li><li>第二步 - 编译器运行相应的<strong>构造函数</strong>以构造对象，并为其传入初值</li><li>第三部 - 对象构造完成后，返回一个指向该对象的指针</li></ul></div></details><details class=info><summary>delete操作符如何释放对象内存？</summary><div><p>使用delete操作符来释放对象内存时会经历两个步骤</p><ul><li>第一步 - 调用对象的析构函数</li><li>第二步 - 编译器调用operator delete(或operator delete[])函数释放内存空间</li></ul></div></details><details class=info><summary>new/delete与malloc/free之间的区别与联系？</summary><div><p><strong>相同点</strong></p><ul><li>对于没有构造与析构的过程的内部数据类型来说，两者是等价的</li><li>都可以用于申请动态内存和释放内存</li></ul><p><strong>不同点</strong></p><ul><li><code>new/delete</code>可以调用对象的构造函数和析构函数，属于运算符，在编译器权限之内</li><li><code>malloc/free</code>仅用于内存分配和释放，属于库函数，不在编译器权限之内</li><li><code>new</code>是类型安全的，而<code>malloc</code>返回的数据类型是<code>void *</code>，需要显式地进行类型转换</li><li><code>new</code>可以自动计算所需字节数，而<code>malloc</code>需要手动计算</li><li><code>new</code>申请内存失败时抛出<code>bad_malloc</code>异常，而<code>malloc</code>返回空指针</li></ul><p>new操作符从自由存储区(free store)上为对象动态分配内存空间，而malloc函数从堆上动态分配内存。自由存储区是<code>C++</code>基于new操作符的一个抽象概念，凡是通过new操作符进行内存申请，该内存即为自由存储区。那么自由存储区是否能够是堆(问题等价于new是否能在堆上动态分配内存)，这取决于operator new的实现细节。自由存储区不仅可以是堆，还可以是静态存储区，这都看operator new在哪里为对象分配内存。</p></div></details><details class=info><summary>delete与delete []的区别？</summary><div><p>对于简单类型来说，使用<code>new</code>分配后，不管是数组还是非数组的形式，这两种方式都可以释放内存。对于自定义类型来说，就需要</p><ul><li>对单个对象使用<code>delete</code></li><li>对对象数组使用<code>delete []</code> - 逐个调用数组中对象的析构函数，从而释放所有内存</li></ul><p>如果反过来使用，即对于单个对象使用<code>delete []</code>，对于对象数组使用<code>delete</code>，其行为是未定义的。所以，最恰当的方式就是，如果用了<code>new</code>，就用<code>delete</code>；如果用了<code>new []</code>，就用<code>delete []</code>。</p></div></details><details class=info><summary>有了malloc/free为什么还要new/delete？</summary><div><p>对于一些非内部数据类型(例如类)来说，光用<code>maloc/free</code>无法满足要求。对象在创建的同时要自动执行构造函数，对象在消亡的时候要自动执行析构函数，而由于<code>malloc/free</code>是库函数而不是运算符，不在编译器的控制权限内(库函数是编译好的代码由链接器链接到代码中)，也就不能自动执行构造函数和析构函数。所以，在<code>c++</code>中需要一个能完成动态内存分配和初始化工作的运算符new，以及一个能完成清理和释放内存工作的运算符delete。</p><p>对于类，使用malloc后，该对象的成员变量并没有被初始化，因此自定义类型结构用malloc是不合适。</p></div></details><details class=info><summary>既然new/delete的功能完全覆盖了malloc/free，为什么C++不把malloc/free淘汰呢？(new分配的内存可以通过free释放吗？)</summary><div><p>因为<code>C++</code>程序经常要调用C函数，而C程序只能用malloc/free管理动态内存。如果用free释放掉new创建的动态对象，那么该对象会因无法执行析构函数，可能导致程序出错。如果用delete释放掉malloc申请的动态内存，理论上讲程序不会出错，但是该程序的可读性很差。所以new/delete必须配对使用，malloc/free也一样。</p></div></details><details class=info><summary>new delete，new[] delete[]一定要配对使用吗？为什么？</summary><div><p>一定要配对使用，因为</p><ul><li><p><strong>正确释放内存</strong> - <code>new</code>和<code>new[]</code>都执行内存分配和对象构造，而<code>delete</code>和<code>delete[]</code>则负责对象析构和内存释放。如果不使用正确的配对，可能导致对象析构不完全或者释放的内存不符合分配时的规则</p></li><li><p><strong>处理数组元素析构</strong> - 当使用<code>new[]</code>分配数组内存时，构造函数可能被调用多次，因此在释放时需要调用每个元素的析构函数。<code>delete[]</code>会负责调用每个元素的析构函数，而<code>delete</code>只会调用单个对象的析构函数</p></li><li><p><strong>防止未定义行为</strong> - <code>C++</code>标准规定使用<code>new</code>时应该使用<code>delete</code>，使用<code>new[]</code>时应该使用<code>delete[]</code>。不遵循这一规则可能导致未定义行为，因为标准并没有定义不同形式的<code>new</code>和<code>delete</code>之间的确切行为</p></li></ul></div></details><h2 id=左值引用别名><a class=anchor href=#左值引用别名>#</a> 左值引用(别名)</h2><h3 id=初始化><a class=anchor href=#初始化>#</a> 初始化</h3><p>引用符号 - <code>&amp;</code></p><p>引用相当于内存空间内数据所在位置的别名，通过该别名可直接操作内存空间内对应的数据。</p><p>语法 - <code>数据类型 &amp;引用名 = 被引用变量名</code></p><ul><li>被引用变量名为值，该值可变</li><li>实质相当于 - <code>数据类型* const 变量名</code></li><li>引用必须初始化，初始化后，被引用对象不可改变</li></ul><p>引用的数据类型要与原变量的数据类型相同。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=3></td><td><pre>	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=4></td><td><pre>	<span class="token keyword">int</span><span class="token operator">&amp;</span> b <span class="token operator">=</span> i<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre>	<span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=6></td><td><pre>    </pre></td></tr><tr><td data-num=7></td><td><pre>	b <span class="token operator">=</span> j<span class="token punctuation">;</span><span class="token comment">// 并非改变被引用对象，而是将变量j的值赋值给变量b所指内存空间</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id=引用作为参数><a class=anchor href=#引用作为参数>#</a> 引用作为参数</h3><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">&amp;</span> a<span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">&amp;</span> b<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token keyword">int</span> temp <span class="token operator">=</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre>    a <span class="token operator">=</span> b<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre>    b <span class="token operator">=</span> temp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=10></td><td><pre></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=13></td><td><pre>    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span>b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token function">swap</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id=引用作返回值><a class=anchor href=#引用作返回值>#</a> 引用作返回值</h3><p>不可返回局部变量的引用，会非法访问未申请内存空间(野指针)。<br>引用的返回可作左值。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">int</span><span class="token operator">&amp;</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token keyword">static</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">// 改变了该变量的生命周期</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">return</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=9></td><td><pre></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">int</span><span class="token operator">&amp;</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">&amp;</span> ra<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token operator">++</span>ra<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre>    <span class="token keyword">return</span> ra<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=15></td><td><pre></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=18></td><td><pre>    <span class="token keyword">int</span> <span class="token operator">&amp;</span>ref <span class="token operator">=</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre>    <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span><span class="token comment">// 引用返回做左值</span></pre></td></tr><tr><td data-num=20></td><td><pre></pre></td></tr><tr><td data-num=21></td><td><pre>    <span class="token comment">// 返回引用形参的地址，b、a，ra的地址相同</span></pre></td></tr><tr><td data-num=22></td><td><pre>    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=23></td><td><pre>    <span class="token keyword">int</span><span class="token operator">&amp;</span> b <span class="token operator">=</span> <span class="token function">test2</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id=const修饰的常量引用><a class=anchor href=#const修饰的常量引用>#</a> const修饰的常量引用</h3><p>使用<code>const</code>关键字修饰引用，表示引用的对象是常量，不能通过该引用修改所引用的值。</p><p>如果引用的数据对象类型不匹配，被const修饰后，编译器将为其创建临时变量，让引用指向临时变量。</p><p>如果函数的实参不是左值或与const引用形参的类型不匹配，编译器将创建正确类型的匿名变量，将实参的值传递给匿名变量，并让形参引用该变量。</p><p><strong>应用场景</strong></p><ul><li>const可以避免无意中修改数据的编程错误</li><li>const使函数能够处理const和非const实参，否则将只能接受非const实参</li><li>使用const，函数能正确生成并使用临时变量</li></ul><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=4></td><td><pre></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">void</span> <span class="token function">showValue</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> v <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=8></td><td><pre></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">void</span> <span class="token function">showstring</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> str<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=10></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> str <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=12></td><td><pre></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=15></td><td><pre>    <span class="token comment">//int &amp;ref = 10;// 引用不能用于常量，常量为右值</span></pre></td></tr><tr><td data-num=16></td><td><pre>    </pre></td></tr><tr><td data-num=17></td><td><pre>    <span class="token comment">// const 修饰后，编译器调整为int temp = 10;int &amp;ref = temp;</span></pre></td></tr><tr><td data-num=18></td><td><pre>    <span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">&amp;</span>ref <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre>    <span class="token comment">//ref = 100;// Err，const 修饰后，值不可变</span></pre></td></tr><tr><td data-num=20></td><td><pre>    </pre></td></tr><tr><td data-num=21></td><td><pre>    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=22></td><td><pre>    <span class="token comment">// 函数形参是被const修饰的引用，编译器会创建相匹配类型的匿名变量并将值传递</span></pre></td></tr><tr><td data-num=23></td><td><pre>    <span class="token function">showValue</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre>    <span class="token function">showstring</span><span class="token punctuation">(</span><span class="token string">"xxxx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=25></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><hr><details class=info><summary>引用的应用场景？</summary><div><p><strong>不需要在函数中修改实参的情况</strong></p><ul><li>如果实参很小，则传值即可</li><li>如果实参是数组，则使用const指针</li><li>如果实参是较大的结构，则使用const指针或const引用</li><li>如果实参是类，则使用const引用，按引用标准方式传递</li></ul><p><strong>需要在函数中修改实参的情况</strong></p><ul><li>如果实参是内置数据结构，则使用指针</li><li>如果实参是数组，则只能使用指针</li><li>如果实参是结构体，引用和指针都可使用</li><li>如果实参是类，则使用引用</li></ul></div></details><details class=info><summary>指针和引用的区别？</summary><div><p>指针和引用是<code>C++</code>中两种不同的机制，用于处理变量的地址和访问。区别主要有</p><p><strong>定义和初始化</strong></p><ul><li><p>指针 - 指针是一个变量，其值是一个内存地址。通过使用<code>*</code>运算符来声明和使用指针。需要使用取地址运算符 <code>&amp;</code> 来获取变量的地址</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">int</span> <span class="token operator">*</span>ptr <span class="token operator">=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">;</span>  <span class="token comment">// 声明并初始化指针</span></pre></td></tr></table></figure></li><li><p>引用 - 引用是一个别名，是已经存在的变量的别名。通过使用<code>&amp;</code>运算符来声明和使用引用</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">int</span> <span class="token operator">&amp;</span>ref <span class="token operator">=</span> x<span class="token punctuation">;</span>  <span class="token comment">// 声明并初始化引用</span></pre></td></tr></table></figure></li></ul><p><strong>空值</strong></p><ul><li>指针 - 指针可以为空(<code>nullptr</code>、<code>NULL</code>或0)，表示不指向任何有效的地址</li><li>引用 - 引用不能为空，它必须在声明时初始化，并且一直引用同一个变量</li></ul><p><strong>可变性</strong></p><ul><li><p>指针 - 指针本身是一个变量，可以被重新赋值指向不同的地址</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">int</span> <span class="token operator">*</span>ptr <span class="token operator">=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre>ptr <span class="token operator">=</span> <span class="token operator">&amp;</span>y<span class="token punctuation">;</span><span class="token comment">// 改变指针的指向</span></pre></td></tr></table></figure></li><li><p>引用 - 引用一旦初始化后，不能再引用其他变量。它始终引用相同的变量</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">int</span> <span class="token operator">&amp;</span>ref <span class="token operator">=</span> x<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token comment">// ref = y;// 错误，引用无法重新绑定到其他变量</span></pre></td></tr></table></figure></li></ul><p><strong>语法</strong></p><ul><li><p>指针 - 通过<code>*</code>运算符来间接访问指向的变量</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">int</span> <span class="token operator">*</span>ptr <span class="token operator">=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">int</span> value <span class="token operator">=</span> <span class="token operator">*</span>ptr<span class="token punctuation">;</span><span class="token comment">// 通过指针获取值</span></pre></td></tr></table></figure></li><li><p>引用 - 直接使用引用即可，无需额外的解引用操作</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">int</span> <span class="token operator">&amp;</span>ref <span class="token operator">=</span> x<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">int</span> value <span class="token operator">=</span> ref<span class="token punctuation">;</span><span class="token comment">// 直接使用引用获取值</span></pre></td></tr></table></figure></li></ul><p><strong>空引用</strong></p><ul><li><p>指针 - 可以是空指针</p></li><li><p>引用 - 不允许空引用，必须初始化为某个变量</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">int</span> <span class="token operator">*</span>ptr <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span><span class="token comment">// 空指针</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token comment">// int &amp;ref;// 错误，引用必须初始化</span></pre></td></tr></table></figure></li></ul><p><strong>操作符重载</strong></p><ul><li>指针 - 可以进行指针运算，如指针加法和减法</li><li>引用 - 没有指针运算，直接就是对变量的引用</li></ul></div></details><h2 id=类和对象><a class=anchor href=#类和对象>#</a> 类和对象</h2><h3 id=概述-2><a class=anchor href=#概述-2>#</a> 概述</h3><p>具有相同性质的<strong>对象</strong>，可以抽象为<strong>类</strong>。</p><ul><li>类的成员可以是任意数据类型</li><li>类的成员函数可以直接访问该类的其他成员</li><li>成员函数可以重载，可以递归</li></ul><p>在类的外部，一般不直接访问对象成员而是使用成员函数来进行对成员的相关操作 - <strong>面向对象思想</strong></p><details class=info><summary>::范围解析运算符(Scope Resolution Operator)是什么？</summary><div><ul><li><p><strong>访问命名空间的成员</strong> - <code>::</code>可以用于访问命名空间中的变量、函数或类。当在全局命名空间中有一个局部变量或函数和一个全局变量或函数同名时，<code>::</code>可以用于指定使用全局的那个</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">int</span> globalVar <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=2></td><td><pre></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=4></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=5></td><td><pre>    <span class="token keyword">int</span> globalVar <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token comment">// 使用范围解析运算符访问全局变量</span></pre></td></tr><tr><td data-num=7></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token double-colon punctuation">::</span>globalVar <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span> <span class="token comment">// 输出全局变量的值</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token comment">// ::用于明确指定使用的是全局变量还是类的静态成员。</span></pre></td></tr></table></figure></li><li><p><strong>访问类的静态成员</strong> - <code>::</code>也可用于访问类的静态成员(静态变量或静态函数)，无需创建类的实例</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MyClass</span> </pre></td></tr><tr><td data-num=2></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=4></td><td><pre>    <span class="token keyword">static</span> <span class="token keyword">int</span> staticVar<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre>    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">staticFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre>        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Static Function"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token comment">// 初始化静态成员变量</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">int</span> MyClass<span class="token double-colon punctuation">::</span>staticVar <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=14></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=15></td><td><pre>    <span class="token comment">// 使用范围解析运算符访问静态成员</span></pre></td></tr><tr><td data-num=16></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> MyClass<span class="token double-colon punctuation">::</span>staticVar <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=17></td><td><pre>    <span class="token class-name">MyClass</span><span class="token double-colon punctuation">::</span><span class="token function">staticFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=18></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token comment">// ::用于明确指定使用的是全局变量还是类的静态成员。</span></pre></td></tr></table></figure></li></ul></div></details><details class=info><summary>C++对象内存模型是怎样的？</summary><div><p><strong>对象布局</strong></p><p><code>C++</code>对象的布局包括对象中成员变量的排列方式以及虚函数表(vtable)的存在(如果类使用了虚函数)。</p><ul><li><strong>成员变量排列</strong> - C++对象中的非静态成员变量按照它们在类定义中的声明顺序排列，但编译器可以对成员进行优化以减小内存对齐的浪费</li><li><strong>虚函数表</strong> - 如果类包含虚函数，每个对象都会有一个指向虚函数表的指针。虚函数表是一个数组，其中存储了类的虚函数的地址。这使得在继承和多态的情况下能够正确地调用对象的虚函数</li></ul><p><strong>内存分配</strong></p><p><code>C++</code>对象可以通过静态分配(栈上分配)或动态分配(堆上分配)。</p><ul><li><p><strong>栈上分配</strong> - 对象在栈上分配内存，其生命周期与包含它的作用域相对应。栈上分配的对象在作用域结束时自动销毁</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre>MyClass obj<span class="token punctuation">;</span><span class="token comment">// 栈上分配对象</span></pre></td></tr></table></figure></li><li><p><strong>堆上分配</strong> - 通过 <code>new</code> 运算符在堆上分配对象。堆上分配的对象需要手动释放，否则可能会导致内存泄漏</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre>MyClass <span class="token operator">*</span>ptr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 堆上分配对象</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">delete</span> ptr<span class="token punctuation">;</span></pre></td></tr></table></figure></li></ul><p><strong>内存对齐</strong></p><p>为了提高访问速度，<code>C++</code>对象在内存中可能按照某种规则进行对齐。这种对齐通常是基于平台的架构和编译器的要求。可以使用<code>alignof</code>运算符获取对象的对齐要求。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MyClass</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=4></td><td><pre>    <span class="token keyword">int</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre>    <span class="token keyword">char</span> b<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token keyword">double</span> c<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=10></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=11></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Alignment of MyClass: "</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">alignof</span><span class="token punctuation">(</span>MyClass<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></div></details><details class=info><summary>介绍下C++中的struct和class？</summary><div><p><code>struct</code>和<code>class</code>都是用于定义自定义数据类型(用户定义类型)的关键字，它们之间的主要区别在于成员默认的访问权限和继承方式。</p><ul><li><p>struct</p><ul><li><p>默认的成员访问权限为<code>public</code></p></li><li><p>在<code>struct</code>中，成员默认为<code>public</code>，可以被外部访问</p></li></ul></li><li><p>class</p><ul><li>默认的成员访问权限为<code>private</code></li><li>在<code>class</code>中，成员默认为<code>private</code>，需要通过公共成员函数来访问</li></ul></li><li><p>相似点</p><ul><li>在使用上，<code>struct</code>和<code>class</code>的成员函数、构造函数、析构函数等用法是一样的</li><li>在两者中都可以定义成员变量和成员函数</li></ul></li></ul><p>如果只是用于表示一些简单的数据结构，可以使用<code>struct</code>。</p><p>如果需要进行更多的封装，实现信息隐藏，可以使用<code>class</code>。</p></div></details><details class=info><summary>为什么要将class成员函数声明和定义分开？</summary><div><p>将类的成员函数声明和定义分开是一种常见的编程习惯，这样做有以下几个优点</p><ul><li><p><strong>分离接口和实现</strong> - 将类的成员函数声明放在头文件(.h 或 .hpp 文件)中，而将实现放在源文件(.cpp 文件)中，可以清晰地分离类的接口和实现。这使得用户只需要包含头文件就能使用类的接口，而不需要关心实现的细节。这有助于提高代码的模块化和可维护性</p></li><li><p><strong>减少编译依赖</strong> - 当类的实现发生改变时，如果将实现放在头文件中，所有包含该头文件的文件都需要重新编译。而如果将实现放在源文件中，只有包含头文件的文件需要重新编译，其他文件则不受影响。这有助于减小编译依赖，提高编译效率</p></li><li><p><strong>隐藏实现细节</strong> - 将实现放在源文件中可以隐藏类的具体实现细节，防止用户直接访问类的私有成员或实现细节。这符合封装的原则，使得类的使用者只需要关心类的接口，而不需要了解其实现细节</p></li><li><p><strong>编译器优化</strong> - 将成员函数的实现放在源文件中，可以使编译器更容易进行优化，因为它只需要处理源文件中实际使用到的代码。如果实现放在头文件中，每个包含该头文件的文件都会包含相同的实现，可能导致代码膨胀和编译时间增加</p></li></ul></div></details><h3 id=封装encapsulation><a class=anchor href=#封装encapsulation>#</a> 封装(Encapsulation)</h3><p>通过将<strong>属性和行为</strong>作为一个整体，并加以权限控制，此过程称为<strong>封装</strong>，即将客观事物封装成抽象的类，而类可以把自己的数据和方法暴露给可信的类或者对象，对不可信的类或对象则进行信息隐藏。</p><p>类中的属性和行为统一称为成员。</p><ul><li><strong>属性</strong>也被称为成员属性/成员变量</li><li><strong>行为</strong>也被称为成员函数/成员方法</li></ul><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token comment">// class关键字用于类的声明，class + 类名</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Circle</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span><span class="token comment">// 公共权限</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">int</span> r<span class="token punctuation">;</span><span class="token comment">// 属性</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token keyword">double</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">3.14</span> <span class="token operator">*</span> r<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token comment">// 行为</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token keyword">void</span> <span class="token function">setr</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> r <span class="token operator">=</span> a<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token comment">// 通过行为为成员属性赋值</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=15></td><td><pre>    Circle c1<span class="token punctuation">;</span><span class="token comment">// 实例化的类被称为对象</span></pre></td></tr><tr><td data-num=16></td><td><pre>    cl<span class="token punctuation">.</span>r <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">// 通过`.`操作符访问属性和行为</span></pre></td></tr><tr><td data-num=17></td><td><pre>    <span class="token comment">//c1.setr(10);</span></pre></td></tr><tr><td data-num=18></td><td><pre>    c1<span class="token punctuation">.</span><span class="token function">calculate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h4 id=访问权限><a class=anchor href=#访问权限>#</a> 访问权限</h4><ul><li><strong>public</strong>(公共权限) - 成员类内可访问，类外可访问</li><li><strong>protected</strong>(保护权限) - 成员类内可访问，类外不可访问，子类可访问</li><li><strong>private</strong>(私有权限) - 成员类内可访问，类外不可访问，子类不可访问</li></ul><p>结构体struct与class的唯一区别是<strong>默认权限不同</strong>。</p><ul><li>struct默认权限是public(公有权限)</li><li>class默认权限是私有private(私有权限)</li></ul><h4 id=构造函数与析构函数><a class=anchor href=#构造函数与析构函数>#</a> 构造函数与析构函数</h4><p>默认情况下，编译器至少给一个类添加以下4个函数，构造函数和析构函数可以不写。</p><ul><li>默认构造函数(无参，函数体为空)</li><li>默认析构函数(无参，函数体为空)</li><li>默认拷贝构造函数，对属性进行值拷贝</li><li>赋值运算符<code>operator=</code>对属性值进行值拷贝</li></ul><p><strong>构造函数和析构函数相同点</strong></p><ul><li>都不需要写返回类型</li><li>函数名与类名相同，并且只执行一次</li><li>不能手动调用，访问权限通常是公共权限</li></ul><p><strong>构造函数</strong></p><ul><li>语法 - <code>类名() &#123;&#125;</code></li><li>可以有参数，可发生重载，使用new创建时会调用构造函数</li><li>构造函数在<strong>类实例化</strong>时会被编译器自动调用，相当于自启动</li><li>倘若定义了有参构造函数，则编译器不提供无参构造函数，但会提供默认拷贝构造函数</li></ul><p><strong>拷贝构造函数</strong></p><ul><li><p>规则与构造函数基本相同</p></li><li><p>以值传递的方式调用函数时，如果实参为对象就会被调用</p></li><li><p>函数以值的方式返回对象类型时，可能会被调用(Linux不会)</p></li><li><p>默认拷贝模式为浅拷贝</p></li><li><p>倘若定义了拷贝构造函数，编译器不在提供其他构造函数</p></li></ul><p><strong>析构函数</strong></p><ul><li><p>语法 - <code>~类名() &#123;&#125;</code></p></li><li><p>使用delete销毁对象时会调用析构函数</p></li><li><p>不可有参数，不可发生重载</p></li><li><p>构造函数在<strong>类离开作用域</strong>时会被编译器自动调用，相当于自清理</p></li></ul><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">int</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token comment">// 默认构造函数</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"默认构造函数调用"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=11></td><td><pre>    <span class="token comment">// 有参构造函数</span></pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=13></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=14></td><td><pre>        age <span class="token operator">=</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"有参构造函数调用"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=17></td><td><pre>    <span class="token comment">// 拷贝构造函数</span></pre></td></tr><tr><td data-num=18></td><td><pre>    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">const</span> Person<span class="token operator">&amp;</span> p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=19></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=20></td><td><pre>        age <span class="token operator">=</span> p<span class="token punctuation">.</span>age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=21></td><td><pre>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"拷贝构造函数调用"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=22></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=23></td><td><pre>    <span class="token comment">// 析构函数</span></pre></td></tr><tr><td data-num=24></td><td><pre>    <span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"析构函数调用"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=26></td><td><pre></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=29></td><td><pre>    <span class="token comment">// 默认构造函数调用，不能加()，会被认为是函数的调用</span></pre></td></tr><tr><td data-num=30></td><td><pre>    Person p1<span class="token punctuation">;</span><span class="token comment">// 对象声明</span></pre></td></tr><tr><td data-num=31></td><td><pre>    <span class="token comment">// 1.括号法</span></pre></td></tr><tr><td data-num=32></td><td><pre>    <span class="token comment">/******************************************************************/</span></pre></td></tr><tr><td data-num=33></td><td><pre>    <span class="token comment">// 匿名对象有参构造调用，执行结束后，系统会立即回收匿名对象，无法再被使用</span></pre></td></tr><tr><td data-num=34></td><td><pre>    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=35></td><td><pre>    </pre></td></tr><tr><td data-num=36></td><td><pre>    Person <span class="token function">p2</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 有参构造函数调用</span></pre></td></tr><tr><td data-num=37></td><td><pre>    Person <span class="token function">p3</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 拷贝构造函数调用</span></pre></td></tr><tr><td data-num=38></td><td><pre>    </pre></td></tr><tr><td data-num=39></td><td><pre>    <span class="token comment">// 重定义错误，匿名对象拷贝构造调用，会被编译器识别为(Person p2)对象声明</span></pre></td></tr><tr><td data-num=40></td><td><pre>    <span class="token comment">//Person(p2);</span></pre></td></tr><tr><td data-num=41></td><td><pre>    <span class="token comment">/******************************************************************/</span></pre></td></tr><tr><td data-num=42></td><td><pre>    </pre></td></tr><tr><td data-num=43></td><td><pre>    <span class="token comment">// 2.显示法</span></pre></td></tr><tr><td data-num=44></td><td><pre>    Person p4 <span class="token operator">=</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 有参构造函数调用</span></pre></td></tr><tr><td data-num=45></td><td><pre>    Person p5 <span class="token operator">=</span> <span class="token function">Person</span><span class="token punctuation">(</span>p4<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 参数为对象，拷贝构造函数调用</span></pre></td></tr><tr><td data-num=46></td><td><pre>    </pre></td></tr><tr><td data-num=47></td><td><pre>    <span class="token comment">// 3.隐式转换法</span></pre></td></tr><tr><td data-num=48></td><td><pre>    Person p6 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">// 有参构造函数调用，相当于Person p6 = Person(10);</span></pre></td></tr><tr><td data-num=49></td><td><pre>    Person p7 <span class="token operator">=</span> p4<span class="token punctuation">;</span><span class="token comment">// 拷贝构造函数调用</span></pre></td></tr><tr><td data-num=50></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=51></td><td><pre></pre></td></tr><tr><td data-num=52></td><td><pre><span class="token comment">// 返回一个新的拷贝对象</span></pre></td></tr><tr><td data-num=53></td><td><pre>Person <span class="token function">newperson</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=54></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=55></td><td><pre>    Person p<span class="token punctuation">;</span><span class="token comment">// 旧的Person</span></pre></td></tr><tr><td data-num=56></td><td><pre>    <span class="token keyword">return</span> p<span class="token punctuation">;</span><span class="token comment">// 返回一个新的Person，不是旧的</span></pre></td></tr><tr><td data-num=57></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><details class=info><summary>C++中的所有构造函数？</summary><div><p><strong>默认构造函数(Default Constructor)</strong></p><ul><li><p>没有参数的构造函数</p></li><li><p>如果没有为类定义构造函数，编译器会自动生成默认构造函数</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MyClass</span> </pre></td></tr><tr><td data-num=2></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=4></td><td><pre>    <span class="token function">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=5></td><td><pre>        <span class="token comment">// 构造函数的实现</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token comment">// 其他成员函数...</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li></ul><p><strong>带参数的构造函数(Parameterized Constructor)</strong> - 接受一个或多个参数的构造函数，用于在创建对象时进行初始化。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Point</span> </pre></td></tr><tr><td data-num=2></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=4></td><td><pre>    <span class="token function">Point</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">xCoord</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">yCoord</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=5></td><td><pre>        <span class="token comment">// 构造函数的实现</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token comment">// 其他成员函数...</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token keyword">int</span> xCoord<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token keyword">int</span> yCoord<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>复制构造函数(Copy Constructor)</strong> - 用于在对象之间进行复制初始化，即从一个已有对象创建新对象，这是在对象初始化时调用的构造函数。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MyClass</span> </pre></td></tr><tr><td data-num=2></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=4></td><td><pre>    <span class="token function">MyClass</span><span class="token punctuation">(</span><span class="token keyword">const</span> MyClass<span class="token operator">&amp;</span> other<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=5></td><td><pre>        <span class="token comment">// 复制构造函数的实现</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token comment">// 其他成员函数...</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>移动构造函数(Move Constructor)</strong> - 用于在对象之间进行移动语义的初始化，通常与移动语义和右值引用一起使用。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MyString</span> </pre></td></tr><tr><td data-num=2></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=4></td><td><pre>    <span class="token function">MyString</span><span class="token punctuation">(</span>MyString<span class="token operator">&amp;&amp;</span> other<span class="token punctuation">)</span> <span class="token keyword">noexcept</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=5></td><td><pre>        <span class="token comment">// 移动构造函数的实现</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token comment">// 其他成员函数...</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>委托构造函数(Delegating Constructor)</strong> - 一个构造函数调用另一个构造函数来完成初始化，从而减少代码的重复。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Rectangle</span> </pre></td></tr><tr><td data-num=2></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=4></td><td><pre>    <span class="token function">Rectangle</span><span class="token punctuation">(</span><span class="token keyword">int</span> width<span class="token punctuation">,</span> <span class="token keyword">int</span> height<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">width</span><span class="token punctuation">(</span>width<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">height</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=5></td><td><pre>        <span class="token comment">// 构造函数的实现</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=7></td><td><pre></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token function">Rectangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Rectangle</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=9></td><td><pre>        <span class="token comment">// 委托构造函数，调用上面的构造函数</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=11></td><td><pre>    <span class="token comment">// 其他成员函数...</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=13></td><td><pre>    <span class="token keyword">int</span> width<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token keyword">int</span> height<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure></div></details><details class=info><summary>什么情况下会调用拷贝构造函数？</summary><div><p><strong>通过值传递参数</strong> - 当一个函数以值传递的方式调用时，参数的拷贝构造函数会被调用。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">void</span> <span class="token function">myFunction</span><span class="token punctuation">(</span>MyClass obj<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=2></td><td><pre>    <span class="token comment">// 在函数调用时，调用拷贝构造函数</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=4></td><td><pre></pre></td></tr><tr><td data-num=5></td><td><pre>MyClass myObj<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token function">myFunction</span><span class="token punctuation">(</span>myObj<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>以值返回对象</strong> - 当一个函数返回一个对象时，返回值的拷贝构造函数会被调用。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre>MyClass <span class="token function">createObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=2></td><td><pre>    <span class="token comment">// 在返回时，调用拷贝构造函数</span></pre></td></tr><tr><td data-num=3></td><td><pre>    <span class="token keyword">return</span> <span class="token function">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><strong>通过显式调用</strong> - 可以显式调用拷贝构造函数来创建一个对象的副本。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre>MyClass obj1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=2></td><td><pre>MyClass <span class="token function">obj2</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 显式调用拷贝构造函数</span></pre></td></tr></table></figure><p><strong>在初始化列表中初始化对象</strong> - 在类的构造函数中，通过初始化列表方式初始化一个成员对象时，拷贝构造函数会被调用。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">class</span> <span class="token class-name">AnotherClass</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=3></td><td><pre>    <span class="token function">AnotherClass</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">data</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=4></td><td><pre>        <span class="token comment">// 在初始化列表中调用拷贝构造函数</span></pre></td></tr><tr><td data-num=5></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=6></td><td><pre></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">int</span> data<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure></div></details><details class=info><summary>析构函数的作用是什么？是如何起作用的？</summary><div><p>析构函数是类中的特殊函数，用于在对象生命周期结束时进行资源的释放和清理工作。</p><ul><li><strong>释放资源</strong> - 主要用于释放对象在生命周期内申请的资源，如堆上分配的内存、打开的文件、建立的网络连接等。这是确保程序不会发生内存泄漏和资源泄漏的重要手段</li><li><strong>执行清理操作</strong> - 在对象即将销毁时，可以执行一些清理操作，例如关闭文件、释放锁定的资源、通知其他对象等。这有助于确保程序的正确性和可维护性</li><li><strong>处理继承关系</strong> - 如果类是继承关系中的基类，析构函数应该声明为虚函数。这允许在派生类对象被销毁时调用正确的析构函数，确保释放派生类所占用的资源</li><li><strong>确保对象生命周期结束时的一致性</strong> - 析构函数的执行顺序是根据对象创建时构造函数的执行顺序相反的。这有助于确保对象在生命周期结束时，其成员和所占用的资源都得到了正确的释放和清理</li></ul></div></details><details class=info><summary>构造函数和析构函数的执行顺序是什么？</summary><div><p><strong>构造函数的执行顺序</strong></p><ul><li><strong>基类构造函数</strong> - 如果类是继承关系中的派生类，先调用基类的构造函数。构造函数的调用顺序是根据继承关系中基类的顺序，按照声明的顺序进行</li><li><strong>成员变量构造函数</strong> - 接着调用类的成员变量的构造函数，构造函数的调用顺序是根据它们在类中声明的顺序进行</li><li><strong>派生类构造函数</strong> - 最后调用派生类自己的构造函数</li></ul><p><strong>析构函数的执行顺序</strong></p><ul><li><strong>派生类析构函数</strong> - 如果类是继承关系中的派生类，先调用派生类自己的析构函数</li><li><strong>成员变量析构函数</strong> - 接着调用类的成员变量的析构函数，析构函数的调用顺序是根据它们在类中声明的逆序进行</li><li><strong>基类析构函数</strong> - 最后调用基类的析构函数。析构函数的调用顺序是根据继承关系中基类的逆序，按照声明的逆序进行</li></ul></div></details><details class=info><summary>构造函数和析构函数能抛出异常吗？</summary><div><ul><li>从语法的角度来说，构造函数可以抛出异常，但从逻辑和风险控制的角度来说，尽量不要抛出异常，否则可能导致内存泄漏</li><li>析构函数不可以抛出异常，如果析构函数抛出异常，则异常点之后的程序，比如释放内存等操作，就不会被执行，从而造成内存泄露的问题；而且当异常发生时，<code>C++</code>通常会调用对象的析构函数来释放资源，如果此时析构函数也抛出异常，即前一个异常未处理又出现了新的异常，从而造成程序崩溃的问题</li></ul></div></details><details class=info><summary>为什么拷贝构造函数必须是引用？</summary><div><p>拷贝构造函数的参数通常是按引用传递而不是按值传递的主要原因是避免无限递归调用拷贝构造函数。</p><p>如果拷贝构造函数的参数是按值传递的话，调用拷贝构造函数时会创建一个实参的副本，而创建这个副本的过程又需要调用拷贝构造函数。这就导致了无限递归的情况，最终可能导致栈溢出或其他问题。</p><p>通过使用引用作为参数，实际上是传递了对象的引用，而不是对象的副本。这样做可以防止无限递归，因为在递归调用中，只是传递了引用，而不会创建新的副本。</p></div></details><h4 id=浅拷贝shallow-copy与深拷贝deep-copy><a class=anchor href=#浅拷贝shallow-copy与深拷贝deep-copy>#</a> 浅拷贝(Shallow Copy)与深拷贝(Deep Copy)</h4><p><strong>浅拷贝</strong> - 简单的赋值拷贝操作，即同一块申请内存空间被多个不同成员的共享。</p><ul><li>倘若有对象A的<code>a_ptr</code>指针类型成员，对象B的<code>b_ptr</code>指针类型成员</li><li><code>a_ptr</code>与<code>b_ptr</code>都指向堆中的同一块内存地址</li><li>当它们其中一个修改了内存数据，另一个类中的成员也会受到影响</li><li>当它们其中一个成员所属的类被销毁了，另一个类中的成员就变成了野指针</li></ul><p><strong>深拷贝</strong> - 在堆区重新申请空间，进行拷贝操作。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">int</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">int</span><span class="token operator">*</span> height<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> _age<span class="token punctuation">,</span><span class="token keyword">int</span> _height<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=11></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=12></td><td><pre>        <span class="token keyword">int</span> age <span class="token operator">=</span> _age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre>        hieght <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span>_height<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=15></td><td><pre>    </pre></td></tr><tr><td data-num=16></td><td><pre>    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">const</span> Person<span class="token operator">&amp;</span> p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=17></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=18></td><td><pre>        age <span class="token operator">=</span> p<span class="token punctuation">.</span>age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre>        <span class="token comment">//height = p.height;// 浅拷贝，会造成内存重复释放</span></pre></td></tr><tr><td data-num=20></td><td><pre>        height <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 深拷贝</span></pre></td></tr><tr><td data-num=21></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=22></td><td><pre>    </pre></td></tr><tr><td data-num=23></td><td><pre>    <span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=24></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=25></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">!=</span> height<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=26></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=27></td><td><pre>            <span class="token keyword">delete</span> height<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=28></td><td><pre>            height <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=29></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=30></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><details class=info><summary>深拷贝与浅拷贝的区别(举例说明深拷贝的安全性)？</summary><div><p>深拷贝和浅拷贝是在对象复制时两种不同的策略。它们的区别在于是否复制对象所包含的子对象。</p><p><strong>浅拷贝</strong></p><ul><li><p>浅拷贝只复制对象本身，而不复制对象所包含的子对象。这意味着原始对象和拷贝对象共享相同的子对象</p></li><li><p>浅拷贝通常只涉及对对象的值进行简单的位复制或引用复制</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">class</span> <span class="token class-name">ShallowCopyExample</span> </pre></td></tr><tr><td data-num=4></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token keyword">int</span><span class="token operator">*</span> data<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token function">ShallowCopyExample</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=9></td><td><pre>        data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=11></td><td><pre></pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token operator">~</span><span class="token function">ShallowCopyExample</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=13></td><td><pre>        <span class="token keyword">delete</span> data<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=18></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=19></td><td><pre>    ShallowCopyExample <span class="token function">original</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=20></td><td><pre></pre></td></tr><tr><td data-num=21></td><td><pre>    <span class="token comment">// 浅拷贝</span></pre></td></tr><tr><td data-num=22></td><td><pre>    ShallowCopyExample shallowCopy <span class="token operator">=</span> original<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=23></td><td><pre></pre></td></tr><tr><td data-num=24></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Original data: "</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>original<span class="token punctuation">.</span>data <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=25></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Shallow copy data: "</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>shallowCopy<span class="token punctuation">.</span>data <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=26></td><td><pre></pre></td></tr><tr><td data-num=27></td><td><pre>    <span class="token comment">// 修改拷贝对象的数据</span></pre></td></tr><tr><td data-num=28></td><td><pre>    <span class="token operator">*</span>shallowCopy<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=29></td><td><pre></pre></td></tr><tr><td data-num=30></td><td><pre>    <span class="token comment">// 因为浅拷贝，原始对象和拷贝对象共享相同的data指针，修改一个会影响另一个</span></pre></td></tr><tr><td data-num=31></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Original data after modification: "</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>original<span class="token punctuation">.</span>data <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=32></td><td><pre></pre></td></tr><tr><td data-num=33></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=34></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token comment">/**</span></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token comment"> * 浅拷贝导致original和shallowCopy共享相同的data指针，</span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token comment"> * 修改一个对象的data会影响另一个对象的data。</span></pre></td></tr><tr><td data-num=38></td><td><pre><span class="token comment">**/</span></pre></td></tr></table></figure></li></ul><p><strong>深拷贝</strong></p><ul><li><p>深拷贝复制对象及其所有嵌套的子对象，确保原始对象和拷贝对象是完全独立的</p></li><li><p>深拷贝通常涉及递归地复制对象的所有成员</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">class</span> <span class="token class-name">DeepCopyExample</span> </pre></td></tr><tr><td data-num=4></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token keyword">int</span><span class="token operator">*</span> data<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token function">DeepCopyExample</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=9></td><td><pre>        data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=11></td><td><pre></pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token function">DeepCopyExample</span><span class="token punctuation">(</span><span class="token keyword">const</span> DeepCopyExample<span class="token operator">&amp;</span> other<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=13></td><td><pre>        data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token operator">*</span>other<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 深拷贝</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=15></td><td><pre></pre></td></tr><tr><td data-num=16></td><td><pre>    <span class="token operator">~</span><span class="token function">DeepCopyExample</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=17></td><td><pre>        <span class="token keyword">delete</span> data<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=18></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=20></td><td><pre></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=22></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=23></td><td><pre>    DeepCopyExample <span class="token function">original</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre></pre></td></tr><tr><td data-num=25></td><td><pre>    <span class="token comment">// 深拷贝</span></pre></td></tr><tr><td data-num=26></td><td><pre>    DeepCopyExample deepCopy <span class="token operator">=</span> original<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=27></td><td><pre></pre></td></tr><tr><td data-num=28></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Original data: "</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>original<span class="token punctuation">.</span>data <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=29></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Deep copy data: "</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>deepCopy<span class="token punctuation">.</span>data <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=30></td><td><pre></pre></td></tr><tr><td data-num=31></td><td><pre>    <span class="token comment">// 修改拷贝对象的数据</span></pre></td></tr><tr><td data-num=32></td><td><pre>    <span class="token operator">*</span>deepCopy<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=33></td><td><pre></pre></td></tr><tr><td data-num=34></td><td><pre>    <span class="token comment">// 深拷贝保证原始对象和拷贝对象各自拥有独立的data指针，修改一个不会影响另一个</span></pre></td></tr><tr><td data-num=35></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Original data after modification: "</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>original<span class="token punctuation">.</span>data <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=36></td><td><pre></pre></td></tr><tr><td data-num=37></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=38></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=39></td><td><pre><span class="token comment">/**</span></pre></td></tr><tr><td data-num=40></td><td><pre><span class="token comment"> * 深拷贝通过递归地复制data指针指向的值，</span></pre></td></tr><tr><td data-num=41></td><td><pre><span class="token comment"> * 确保original和deepCopy对象有独立的data指针，</span></pre></td></tr><tr><td data-num=42></td><td><pre><span class="token comment"> * 修改一个对象的data不会影响另一个对象的data。</span></pre></td></tr><tr><td data-num=43></td><td><pre><span class="token comment">**/</span></pre></td></tr></table></figure></li></ul></div></details><h4 id=初始化列表><a class=anchor href=#初始化列表>#</a> 初始化列表</h4><p>成员初始化列表是在构造函数的定义中使用的一种语法，用于初始化类的成员变量。成员初始化列表出现在构造函数的冒号后面，构造函数体之前。它允许在对象被创建时为成员变量提供初始值，而不是在构造函数体中通过赋值语句进行初始化。</p><p>语法 - <code>构造函数名(): 成员1(表达式1)，成员2(表达式2)...&#123;&#125;</code></p><p>类的成员变量可以不出现在初始化列表中。</p><p>语法末尾没有<code>;</code>号，因为是函数，函数代码块内依然能够填写语句。</p><p>如果成员已在初始化列表中并且构造函数中也有该成员时，调用构造函数时值会被覆盖，即初始化列表先初始化了，之后代码块内又将变量赋值了。</p><p>如果成员是常量和引用，必须使用初始化列表；如果成员是没有默认构造函数的类，必须使用初始化列表。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">int</span> a<span class="token punctuation">,</span>b<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">a</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">b</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token comment">// 结构体中也可使用初始化列表</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">struct</span> <span class="token class-name">newstruct</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=16></td><td><pre>    <span class="token keyword">int</span> a<span class="token punctuation">,</span>b<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=17></td><td><pre>    <span class="token keyword">int</span><span class="token operator">*</span> next<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=18></td><td><pre>    <span class="token function">newstruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=19></td><td><pre>    <span class="token function">newstruct</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">a</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">b</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=21></td><td><pre></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=24></td><td><pre>    Person <span class="token function">p</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">170</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=25></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><details class=info><summary>C++成员变量的初始化顺序问题？</summary><div><p>成员变量在使用初始化列表初始化时，只与定义成员变量的顺序有关，与构造函数中初始化成员列表的顺序无关。因为成员变量的初始化次序是根据变量在内存中次序有关，而内存中的排列顺序早在编译期就根据变量的定义次序决定了。</p><p>如果不使用初始化列表初始化，在构造函数内初始化时，此时与成员变量在构造函数中的位置有关。</p><p>类成员在定义时，是不能初始化的</p><p>类中const成员常量必须在构造函数初始化列表中初始化。</p><p>类中static成员变量，必须在类外初始化。</p><p><strong>变量的初始化顺序</strong></p><ul><li>初始化基类中的静态成员变量和静态代码块，按照在程序中出现的顺序初始化</li><li>初始化派生类中的静态成员变量和静态代码块，按照在程序中出现的顺序初始化</li><li>初始化基类的普通成员变量和代码块，再执行父类的构造方法</li><li>初始化派生的普通成员变量和代码块，在执行子类的构造方法</li></ul></div></details><details class=info><summary>为什么用成员初始化列表会快一些？</summary><div><p><strong>避免默认构造和赋值操作</strong> - 当成员初始化列表用于初始化成员变量时，对象的构造函数直接调用相应的构造函数，而不是先调用默认构造函数，然后再通过赋值操作进行初始化。这可以避免不必要的默认构造和赋值操作，提高效率。</p><p><strong>避免不必要的临时对象</strong> - 在构造函数体内对成员变量进行初始化可能会导致创建临时对象，然后再通过拷贝或移动操作将其值传递给成员变量。使用成员初始化列表可以直接在构造函数参数中传递初始值，避免了不必要的临时对象的创建和拷贝操作。</p></div></details><details class=info><summary>类中初始化数据成员与对数据成员赋值有什么区别？</summary><div><p>构造函数执行有两个阶段，首先是初始化阶段，这个阶段所有类中的成员都会被初始化，即使成员没有出现在初始化列表中。第二个阶段是计算阶段，一般是执行构造函数体内部的赋值操作。</p><p><strong>时机不同</strong></p><ul><li><strong>初始化数据成员：</strong> 成员初始化列表在对象构造的时候就会执行，它在进入构造函数的函数体之前执行。因此，初始化数据成员的值在构造函数体内的任何代码执行之前就已经确定</li><li><strong>对数据成员赋值：</strong> 赋值语句则在构造函数体内执行，即在进入构造函数的函数体时才会执行。赋值操作是在对象构造的过程中的某个阶段执行的</li></ul><p><strong>适用情况</strong></p><ul><li><strong>初始化数据成员：</strong> 适用于对 const 成员变量、引用成员变量和类类型的成员变量进行初始化，因为这些成员可能不能在构造函数体内进行赋值</li><li><strong>对数据成员赋值：</strong> 适用于一般的数据成员初始化，包括对非const变量的赋值</li></ul><p><strong>效率</strong></p><ul><li><strong>初始化数据成员：</strong> 在某些情况下可能更高效，因为它直接调用了成员变量的构造函数，避免了默认构造和拷贝操作</li><li><strong>对数据成员赋值：</strong> 可能会涉及到默认构造函数、拷贝构造函数和赋值操作，可能会引入额外的开销</li></ul></div></details><h4 id=类作类的成员><a class=anchor href=#类作类的成员>#</a> 类作类的成员</h4><p>其他类作本类的成员，创建时，先构造其他类再构造本类。</p><p>其他类作本类的成员，销毁时，先析构本类再析构其他类。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=4></td><td><pre></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Phone</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=8></td><td><pre>    string name<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token function">Phone</span><span class="token punctuation">(</span>string _name<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">name</span><span class="token punctuation">(</span>_name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=16></td><td><pre>    string name</pre></td></tr><tr><td data-num=17></td><td><pre>    Phone pname<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=19></td><td><pre>    <span class="token function">Person</span><span class="token punctuation">(</span>string x<span class="token punctuation">,</span>string y<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">name</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">p_name</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=21></td><td><pre></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=24></td><td><pre>    Person <span class="token function">p</span><span class="token punctuation">(</span><span class="token string">"xxx"</span><span class="token punctuation">,</span><span class="token string">"iphxxx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=25></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h4 id=static静态成员><a class=anchor href=#static静态成员>#</a> static静态成员</h4><p><strong>静态成员变量</strong></p><ul><li>不属于某个对象，所有对象都共享同一份数据，即不需要创建实例即可使用</li><li>在编译阶段分配内存(程序未运行前)</li><li>需类内声明，类外实现</li></ul><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">static</span> <span class="token keyword">int</span> b<span class="token punctuation">;</span><span class="token comment">// 类内声明静态成员</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token keyword">static</span> <span class="token keyword">int</span> a<span class="token punctuation">;</span><span class="token comment">// 类内声明静态成员</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=11></td><td><pre></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token comment">// 类外实现，(Person::)为表明作用域</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">int</span> Person<span class="token double-colon punctuation">::</span>a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">int</span> Person<span class="token double-colon punctuation">::</span>b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=18></td><td><pre>    <span class="token comment">// 通过对象访问</span></pre></td></tr><tr><td data-num=19></td><td><pre>    Person p<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=20></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span>a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=21></td><td><pre>    </pre></td></tr><tr><td data-num=22></td><td><pre>    Person p1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=23></td><td><pre>    p1<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> p1<span class="token punctuation">.</span>a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=25></td><td><pre>    </pre></td></tr><tr><td data-num=26></td><td><pre>    <span class="token comment">// 通过类名访问</span></pre></td></tr><tr><td data-num=27></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> Person<span class="token double-colon punctuation">::</span>a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=28></td><td><pre>    <span class="token comment">//cout &lt;&lt; Person::b &lt;&lt; endl;// 无法访问私有权限的成员</span></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=30></td><td><pre></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=32></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=33></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> Person<span class="token double-colon punctuation">::</span>a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">// 静态成员变量不属于某个对象</span></pre></td></tr><tr><td data-num=34></td><td><pre>    <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=35></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><strong>静态成员函数</strong></p><ul><li>不属于某个对象，所有对象都共享同一个函数，即不需要创建实例即可使用</li><li>只能访问静态成员变量(因为不属于某个对象，无法区分哪个类在调用，故无法访问非静态成员变量)</li><li>没有<code>this</code>指针</li></ul><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">static</span> <span class="token keyword">int</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre>    </pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=11></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=12></td><td><pre>        a <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre>        <span class="token comment">//b = 10;// 不能访问非静态成员变量</span></pre></td></tr><tr><td data-num=14></td><td><pre>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"静态成员函数"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=17></td><td><pre></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">int</span> Person<span class="token double-colon punctuation">::</span>a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=22></td><td><pre>    <span class="token comment">// 通过对象访问</span></pre></td></tr><tr><td data-num=23></td><td><pre>    Person p<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre>    p<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=25></td><td><pre>    </pre></td></tr><tr><td data-num=26></td><td><pre>    <span class="token comment">// 通过类名访问</span></pre></td></tr><tr><td data-num=27></td><td><pre>    <span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=29></td><td><pre></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=32></td><td><pre>    <span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 静态成员函数不属于某个对象</span></pre></td></tr><tr><td data-num=33></td><td><pre>    <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=34></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><details class=info><summary>C++中局部静态(static)变量的理解？静态局部变量的构造和析构是怎样的？</summary><div><p>局部静态变量是在函数内部定义的静态变量，它与普通的局部变量有一些重要的区别。局部静态变量在第一次进入声明它的函数时被初始化，之后在函数调用结束时并不被销毁，而是保留其值直到程序结束。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">static</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>静态局部变量在第一次执行到它的声明处时会被<strong>构造</strong>，构造的时机是在程序运行到声明语句时。在构造时，静态局部变量的内存空间会被分配，然后调用该类型的构造函数。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MyClass</span> </pre></td></tr><tr><td data-num=4></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token function">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=7></td><td><pre>        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Constructor called\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">void</span> <span class="token function">exampleFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=13></td><td><pre>    <span class="token keyword">static</span> MyClass staticObj<span class="token punctuation">;</span><span class="token comment">// 静态局部变量</span></pre></td></tr><tr><td data-num=14></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Inside exampleFunction\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=16></td><td><pre></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=18></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=19></td><td><pre>    <span class="token function">exampleFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 第一次调用exampleFunction，静态局部变量被构造</span></pre></td></tr><tr><td data-num=20></td><td><pre>    <span class="token function">exampleFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 再次调用exampleFunction，静态局部变量已经构造过，不再构造</span></pre></td></tr><tr><td data-num=21></td><td><pre></pre></td></tr><tr><td data-num=22></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>在这个例子中，<code>staticObj</code>是一个静态局部变量，它在<code>exampleFunction</code>第一次被调用时构造。构造函数输出 <code>&quot;Constructor called&quot;</code>。在第二次调用<code>exampleFunction</code>时，<code>staticObj</code>已经被构造过，因此不再调用构造函数。</p><p>静态局部变量的<strong>析构</strong>发生在程序结束时，而不是函数退出时。这与普通局部变量不同，普通局部变量的析构发生在离开其作用域时。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MyClass</span> </pre></td></tr><tr><td data-num=4></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token function">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=7></td><td><pre>        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Constructor called\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=9></td><td><pre></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token operator">~</span><span class="token function">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=11></td><td><pre>        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Destructor called\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token keyword">void</span> <span class="token function">exampleFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=16></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=17></td><td><pre>    <span class="token keyword">static</span> MyClass staticObj<span class="token punctuation">;</span><span class="token comment">// 静态局部变量</span></pre></td></tr><tr><td data-num=18></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Inside exampleFunction\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=20></td><td><pre></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=22></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=23></td><td><pre>    <span class="token function">exampleFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 第一次调用exampleFunction，静态局部变量被构造</span></pre></td></tr><tr><td data-num=24></td><td><pre>    <span class="token function">exampleFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 再次调用exampleFunction，静态局部变量已经构造过，不再构造</span></pre></td></tr><tr><td data-num=25></td><td><pre></pre></td></tr><tr><td data-num=26></td><td><pre>    <span class="token comment">// 主函数结束，程序结束，静态局部变量被析构</span></pre></td></tr><tr><td data-num=27></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>在这个例子中，<code>staticObj</code>在程序结束时析构，析构函数输出<code>&quot;Destructor called&quot;</code>。由于静态局部变量的析构发生在程序结束时，因此在主函数结束时才会调用析构函数。</p></div></details><h4 id=成员变量与函数的分开存储><a class=anchor href=#成员变量与函数的分开存储>#</a> 成员变量与函数的分开存储</h4><ul><li><p>编译器会给每个空对象分配1个字节，原因是为了区分空对象占内存的位置</p></li><li><p>静态成员变量和静态成员函数都不属于某个对象，其字节大小不算到类上</p></li><li><p>成员函数其字节大小也不算到类上</p></li></ul><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person1</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person2</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=11></td><td><pre>    <span class="token keyword">int</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person3</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=17></td><td><pre>    <span class="token keyword">int</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=18></td><td><pre>    <span class="token keyword">static</span> <span class="token keyword">int</span> b<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token keyword">int</span> Person3<span class="token double-colon punctuation">::</span>b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=21></td><td><pre></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person4</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=25></td><td><pre>    <span class="token keyword">int</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=26></td><td><pre>    <span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=28></td><td><pre></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person5</span></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=32></td><td><pre>    <span class="token keyword">int</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=33></td><td><pre>    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=34></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=35></td><td><pre></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=38></td><td><pre>    Person1 p1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=39></td><td><pre>    <span class="token comment">// 字节为1，编译器会给每个空对象分配1个字节，</span></pre></td></tr><tr><td data-num=40></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=41></td><td><pre>    </pre></td></tr><tr><td data-num=42></td><td><pre>    Person2 p2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=43></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> end<span class="token punctuation">;</span><span class="token comment">// 字节为4</span></pre></td></tr><tr><td data-num=44></td><td><pre>    </pre></td></tr><tr><td data-num=45></td><td><pre>    Person3 p3<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=46></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> end<span class="token punctuation">;</span><span class="token comment">// 字节为4，静态成员变量字节大小不算到类上</span></pre></td></tr><tr><td data-num=47></td><td><pre>    </pre></td></tr><tr><td data-num=48></td><td><pre>    Person4 p4<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=49></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>p4<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> end<span class="token punctuation">;</span><span class="token comment">// 字节为4，成员函数字节大小不算到类上</span></pre></td></tr><tr><td data-num=50></td><td><pre>    </pre></td></tr><tr><td data-num=51></td><td><pre>    Person5 p5<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=52></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>p5<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> end<span class="token punctuation">;</span><span class="token comment">// 字节为4，静态成员函数不属于某个对象</span></pre></td></tr><tr><td data-num=53></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=54></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h4 id=this指针><a class=anchor href=#this指针>#</a> this指针</h4><p><code>this</code>指针是一个指向当前对象的指针。它是类的成员函数中的一个隐式参数，用于指示成员函数所操作的对象。当调用一个对象的成员函数时，编译器会将该对象的地址作为<code>this</code>指针传递给函数。</p><p><code>this</code>指针使得在成员函数中能够访问到对象的成员变量和其他成员函数。它允许在类的成员函数中引用当前对象，解决了成员函数中局部变量与成员变量同名时的歧义问题。</p><p>在成员函数中，对成员变量和成员函数的访问默认会使用<code>this</code>指针，因此在大多数情况下可以省略<code>this-&gt;</code>，直接使用成员变量名或成员函数名。但在一些特殊情况下，比如成员函数参数和局部变量与成员变量同名时，使用<code>this-&gt;</code>可以明确指出成员变量。</p><ul><li>如果类的成员函数有多个实例化对象，这种情况下需要使用this指针</li><li>this指针存放了实例化对象的<strong>地址</strong>，被作为<strong>隐藏参数</strong>传递给成员函数，指向调用成员函数的对象</li><li><code>*this</code>表示解引用并取得该地址内存中的对象实例</li></ul><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">int</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=10></td><td><pre>        <span class="token comment">// this指向被调用成员函数所属的对象，实质为Person* const this;</span></pre></td></tr><tr><td data-num=11></td><td><pre>        <span class="token keyword">this</span><span class="token operator">-></span>age <span class="token operator">=</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=13></td><td><pre>    </pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token comment">// 引用作返回值</span></pre></td></tr><tr><td data-num=15></td><td><pre>    Person<span class="token operator">&amp;</span> <span class="token function">ageadd</span><span class="token punctuation">(</span>Person<span class="token operator">&amp;</span> p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=16></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=17></td><td><pre>        <span class="token keyword">this</span><span class="token operator">-></span>age <span class="token operator">+=</span> p<span class="token punctuation">.</span>age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=18></td><td><pre>        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token comment">// this为指针，*this返回对象本身</span></pre></td></tr><tr><td data-num=19></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=20></td><td><pre>    <span class="token comment">/*</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token comment">    // 非引用作返回值，返回值会返回一个新的对象</span></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token comment">    Person ageadd(Person&amp; p)</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token comment">    &#123;</span></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token comment">        this->age += p.age;</span></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token comment">        // this为指针，*this返回对象本身，会调用拷贝构造函数</span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token comment">        return *this;</span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token comment">    &#125;</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token comment">    */</span></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=30></td><td><pre></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=32></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=33></td><td><pre>    Person <span class="token function">p1</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=34></td><td><pre>    Person <span class="token function">p2</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=35></td><td><pre>    Person p3<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=36></td><td><pre>    p3<span class="token punctuation">.</span><span class="token function">ageadd</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ageadd</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ageadd</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=37></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=38></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><details class=info><summary>this指针是什么时候创建的？</summary><div><p>this在成员函数的开始执行前构造，在成员的执行结束后清除。</p><p>但是如果class里面没有方法的话，它们是没有构造函数的，只能当做C的struct使用。采用TYPE xx的方式定义的话，在栈里分配内存，这时候this指针的值就是这块内存的地址。采用new的方式创建对象的话，在堆里分配内存，new操作符通过eax(累加寄存器)返回分配的地址，然后设置给指针变量。之后去调用构造函数(如果有构造函数的话)，这时将这个内存块的地址传给ecx。</p></div></details><details class=info><summary>this指针存放在何处？堆、栈、全局变量，还是其他？</summary><div><p>this指针会因编译器不同而有不同的放置位置。可能是栈，也可能是寄存器，甚至全局变量。在汇编级别里面，一个值只会以3种形式出现：立即数、寄存器值和内存变量值。不是存放在寄存器就是存放在内存中，它们并不是和高级语言变量对应的。</p></div></details><details class=info><summary>如果知道一个对象this指针的位置，可以直接使用吗？</summary><div><p>this指针只有在类的成员函数中才有定义。因此，在获得一个对象后不能直接通过对象使用this指针。在成员函数中，this指针是隐式传递的，它指向当前调用该成员函数的对象。虽然无法直接获取this指针的地址(使用&amp;this是不允许的)，但在成员函数内部，可以直接使用this指针来访问对象的成员变量和调用其他成员函数。</p></div></details><details class=info><summary>在成员函数中调用delete this会出现什么问题？</summary><div><p>当调用delete this时，类对象的内存空间被释放。在delete this之后进行的其他任何函数调用，只要不涉及到this指针的内容，都能够正常运行。一旦涉及到this指针，如操作数据成员，调用虚函数等，就会出现不可预期的问题。</p></div></details><details class=info><summary>如果在类的析构函数中调用delete this，会发生什么？</summary><div><p>会导致堆栈溢出。原因很简单，delete的本质是：为将被释放的内存调用一个或多个析构函数，然后，释放内存。显然，delete this会去调用本对象的析构函数，而析构函数中又调用delete this，形成无限递归，造成堆栈溢出，系统崩溃。</p></div></details><h4 id=空指针调用成员函数><a class=anchor href=#空指针调用成员函数>#</a> 空指针调用成员函数</h4><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">int</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"仅调用"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=9></td><td><pre>    </pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token keyword">void</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=11></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=12></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre>        <span class="token comment">// age默认为this->age，传入为空，没有实例化对象，不能调用</span></pre></td></tr><tr><td data-num=14></td><td><pre>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"成员变量调用"</span> <span class="token operator">&lt;&lt;</span> age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=17></td><td><pre></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=20></td><td><pre>    Person<span class="token operator">*</span> p <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=21></td><td><pre>    p<span class="token operator">-></span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 可调用</span></pre></td></tr><tr><td data-num=22></td><td><pre>    p<span class="token operator">-></span><span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 不可调用，由于p为未实例化对象，成员变量age还不存在</span></pre></td></tr><tr><td data-num=23></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h4 id=const修饰成员函数><a class=anchor href=#const修饰成员函数>#</a> const修饰成员函数</h4><ul><li>const修饰的成员函数称为成员<strong>常函数</strong>，定义处也要有const修饰</li><li>常成员函数能使用成员变量，但不能更新类的成员变量的值，只能更新mutable修饰的变量的值</li><li>常成员函数可以被其他成员函数调用</li><li>常成员函数不能主动调用该类中没有用const修饰的成员函数，只能调用常成员函数</li></ul><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=9></td><td><pre>        <span class="token comment">//this->a = 10;// 常函数内不可修饰成员变量</span></pre></td></tr><tr><td data-num=10></td><td><pre>        <span class="token keyword">this</span><span class="token operator">-></span>b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">// mutable修饰的变量可修改</span></pre></td></tr><tr><td data-num=11></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token keyword">int</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre>    <span class="token keyword">mutable</span> <span class="token keyword">int</span> b<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=18></td><td><pre>    Person p<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre>    p<span class="token punctuation">.</span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=20></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><strong>修饰类对象</strong></p><ul><li>有const修饰的声明对象称为常对象</li><li>常对象只能调用成员常函数</li></ul><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">void</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=10></td><td><pre>        <span class="token comment">// this->a = 10;// 常函数内不可修饰成员属性</span></pre></td></tr><tr><td data-num=11></td><td><pre>        <span class="token comment">// mutable修饰的变量可修改</span></pre></td></tr><tr><td data-num=12></td><td><pre>        <span class="token keyword">this</span><span class="token operator">-></span>b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token keyword">int</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre>    <span class="token keyword">mutable</span> <span class="token keyword">int</span> b<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=17></td><td><pre></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=20></td><td><pre>    <span class="token keyword">const</span> Person p<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=21></td><td><pre>    <span class="token comment">//p.a = 10;// Err </span></pre></td></tr><tr><td data-num=22></td><td><pre>    <span class="token comment">//p.func2();// Err，常对象只能调用常函数</span></pre></td></tr><tr><td data-num=23></td><td><pre>    p<span class="token punctuation">.</span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><details class=info><summary>mutable关键字有什么用？</summary><div><p><code>mutable</code>关键字用于修饰类的成员变量(数据成员)，表示即使在一个被声明为<code>const</code>的成员函数内，被修饰的变量仍然可以被修改。这允许在<code>const</code>成员函数中修改某些状态而不违反常量性。</p><p>具体来说，<code>mutable</code>的主要用途是解决类成员函数中需要修改某些状态，但同时需要保持常量性(被声明为 <code>const</code>)的情况。在这种情况下，被修饰为<code>mutable</code>的变量可以在<code>const</code>成员函数内被修改。</p></div></details><details class=info><summary>类里面static和const可以同时修饰成员函数吗？</summary><div><p>不能，<code>C++</code>编译器在实现const的成员函数的时候为了确保该函数不能修改类的中参数的值，会在函数中添加一个隐式的参数<code>const this*</code>。但当一个成员为static的时候，该函数是没有this指针的。也就是说此时const的用法和static是冲突的。</p></div></details><h4 id=友元><a class=anchor href=#友元>#</a> 友元</h4><ul><li><p>友元关键字 - <code>friend</code></p></li><li><p>授权其他类或函数访问其私有成员和受保护成员</p></li><li><p>类内不可以访问友元</p></li></ul><figure class="highlight cpp"><figcaption data-lang=C++><span>全局函数作友元</span></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Building</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token keyword">friend</span> <span class="token keyword">void</span> <span class="token function">getin</span><span class="token punctuation">(</span>Building<span class="token operator">*</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 全局函数作友元</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">void</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"private模式"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"public模式"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">void</span> <span class="token function">getin</span><span class="token punctuation">(</span>Building<span class="token operator">*</span> b<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=15></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> b<span class="token operator">-></span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">// 公共权限访问</span></pre></td></tr><tr><td data-num=16></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> b<span class="token operator">-></span><span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">// 通过友元访问私有权限</span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=18></td><td><pre></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=21></td><td><pre>    Building b<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=22></td><td><pre>    <span class="token function">getin</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=23></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight cpp"><figcaption data-lang=C++><span>类作友元</span></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=4></td><td><pre></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Building</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Owner</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token function">Owner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 类内构造函数声明</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token keyword">void</span> <span class="token function">visit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 类内成员函数声明</span></pre></td></tr><tr><td data-num=11></td><td><pre>    </pre></td></tr><tr><td data-num=12></td><td><pre>    Building<span class="token operator">*</span> bu<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Building</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=17></td><td><pre>    <span class="token keyword">friend</span> <span class="token keyword">class</span> <span class="token class-name">Owner</span><span class="token punctuation">;</span><span class="token comment">// 类作友元</span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=19></td><td><pre>    string bedroom<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=21></td><td><pre>    <span class="token function">Building</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 类内声明构造函数</span></pre></td></tr><tr><td data-num=22></td><td><pre>    string sittingroom<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token comment">// 类外实现构造函数</span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token class-name">Building</span><span class="token double-colon punctuation">::</span><span class="token function">Building</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=28></td><td><pre>    sittingroom <span class="token operator">=</span> <span class="token string">"客厅"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=29></td><td><pre>    bedroom <span class="token operator">=</span> <span class="token string">"卧室"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=31></td><td><pre></pre></td></tr><tr><td data-num=32></td><td><pre><span class="token comment">// 类外实现构造函数</span></pre></td></tr><tr><td data-num=33></td><td><pre><span class="token class-name">Owner</span><span class="token double-colon punctuation">::</span><span class="token function">Owner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> bu <span class="token operator">=</span> <span class="token keyword">new</span> Building<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=34></td><td><pre></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token comment">// 类外实现成员函数</span></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token keyword">void</span> <span class="token class-name">Owner</span><span class="token double-colon punctuation">::</span><span class="token function">vist</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=38></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"访问"</span> <span class="token operator">&lt;&lt;</span> bu<span class="token operator">-></span>sittingroom <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">// 访问公共权限</span></pre></td></tr><tr><td data-num=39></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"访问"</span> <span class="token operator">&lt;&lt;</span> bu<span class="token operator">-></span>bedroom <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">// 通过友元访问私有权限</span></pre></td></tr><tr><td data-num=40></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=41></td><td><pre></pre></td></tr><tr><td data-num=42></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=43></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=44></td><td><pre>    Owner ow<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=45></td><td><pre>    ow<span class="token punctuation">.</span><span class="token function">vist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=46></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=47></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight cpp"><figcaption data-lang=C++><span>成员函数作友元</span></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=4></td><td><pre></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Building</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Owner</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token function">Owner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 类内声明构造函数</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token keyword">void</span> <span class="token function">visit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 类内声明成员函数</span></pre></td></tr><tr><td data-num=11></td><td><pre>    <span class="token keyword">void</span> <span class="token function">forbidvisit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 类内声明成员函数</span></pre></td></tr><tr><td data-num=12></td><td><pre>    Building<span class="token operator">*</span> bu<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Building</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=17></td><td><pre>    <span class="token keyword">friend</span> <span class="token keyword">void</span> <span class="token class-name">Owner</span><span class="token double-colon punctuation">::</span><span class="token function">visit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 成员函数作友元</span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=19></td><td><pre>    string bedroom<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=21></td><td><pre>    <span class="token function">Building</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 类内声明构造函数</span></pre></td></tr><tr><td data-num=22></td><td><pre>    string sittingroom<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token comment">// 类外实现构造函数</span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token class-name">Building</span><span class="token double-colon punctuation">::</span><span class="token function">Building</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=28></td><td><pre>    sittingroom <span class="token operator">=</span> <span class="token string">"客厅"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=29></td><td><pre>    bedroom <span class="token operator">=</span> <span class="token string">"卧室"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=31></td><td><pre></pre></td></tr><tr><td data-num=32></td><td><pre><span class="token comment">// 类外实现构造函数</span></pre></td></tr><tr><td data-num=33></td><td><pre><span class="token class-name">Owner</span><span class="token double-colon punctuation">::</span><span class="token function">Owner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> bu <span class="token operator">=</span> <span class="token keyword">new</span> Building<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=34></td><td><pre></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token comment">// 类外实现成员函数</span></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token keyword">void</span> <span class="token class-name">Owner</span><span class="token double-colon punctuation">::</span><span class="token function">vist</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=38></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"vist访问"</span> <span class="token operator">&lt;&lt;</span> bu<span class="token operator">-></span>sittingroom <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">// 访问公共权限</span></pre></td></tr><tr><td data-num=39></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"vist访问"</span> <span class="token operator">&lt;&lt;</span> bu<span class="token operator">-></span>bedroom <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">// 通过友元访问私有权限</span></pre></td></tr><tr><td data-num=40></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=41></td><td><pre></pre></td></tr><tr><td data-num=42></td><td><pre><span class="token comment">// 类外实现成员函数</span></pre></td></tr><tr><td data-num=43></td><td><pre><span class="token keyword">void</span> <span class="token class-name">Owner</span><span class="token double-colon punctuation">::</span><span class="token function">forbidvist</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=44></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=45></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"forbidvist访问"</span> <span class="token operator">&lt;&lt;</span> bu<span class="token operator">-></span>sittingroom <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">// 访问公共权限</span></pre></td></tr><tr><td data-num=46></td><td><pre>    <span class="token comment">//cout &lt;&lt; "forbidvist访问" &lt;&lt; bu->bedroom &lt;&lt; endl;// Err，不可访问私有权限</span></pre></td></tr><tr><td data-num=47></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=48></td><td><pre></pre></td></tr><tr><td data-num=49></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=50></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=51></td><td><pre>    Owner ow<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=52></td><td><pre>    ow<span class="token punctuation">.</span><span class="token function">vist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=53></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=54></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h4 id=运算符重载><a class=anchor href=#运算符重载>#</a> 运算符重载</h4><p>运输符重载也可以发生函数重载。</p><figure class="highlight cpp"><figcaption data-lang=C++><span>算数运算符重载</span></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">int</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token comment">// 成员函数重载+号</span></pre></td></tr><tr><td data-num=9></td><td><pre>    Person <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span>Person<span class="token operator">&amp;</span> p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=11></td><td><pre>        Person temp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre>        temp<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token keyword">this</span><span class="token operator">-></span>age <span class="token operator">+</span> p<span class="token punctuation">.</span>age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre>        <span class="token keyword">return</span> temp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token comment">// 全局函数重载+号</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token comment">Person operator+(Person&amp; p1,Person&amp; p2)</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token comment">&#123;</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token comment">    Person temp;</span></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token comment">    temp.age = p1.age + p2.age;</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token comment">    return tmep;</span></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token comment">&#125;</span></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token comment"></span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token comment">// 全局函数重载+号的函数重载</span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token comment">Person operator+(Person&amp; p1,int a)</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token comment">&#123;</span></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token comment">    Person temp;</span></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token comment">    temp.age = p1.age + a;</span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token comment">    return tmep;</span></pre></td></tr><tr><td data-num=32></td><td><pre><span class="token comment">&#125;</span></pre></td></tr><tr><td data-num=33></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=34></td><td><pre></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=37></td><td><pre>    Person p1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=38></td><td><pre>    p1<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=39></td><td><pre>    </pre></td></tr><tr><td data-num=40></td><td><pre>    Person p2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=41></td><td><pre>    p2<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=42></td><td><pre>    <span class="token comment">// 成员函数重载+号调用，实质为Person p3 = p1.operator+(p2);</span></pre></td></tr><tr><td data-num=43></td><td><pre>    Person p3 <span class="token operator">=</span> p1 <span class="token operator">+</span> p2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=44></td><td><pre>    </pre></td></tr><tr><td data-num=45></td><td><pre>    <span class="token comment">/*</span></pre></td></tr><tr><td data-num=46></td><td><pre><span class="token comment">    // 全局函数重载+号调用，也可以写为Person p4 = p1 + p2;</span></pre></td></tr><tr><td data-num=47></td><td><pre><span class="token comment">    Person p4 = operator+(p1,p2);</span></pre></td></tr><tr><td data-num=48></td><td><pre><span class="token comment">    // 全局函数重载+号的函数重载函数调用</span></pre></td></tr><tr><td data-num=49></td><td><pre><span class="token comment">    Person p5 = p1 + 100;</span></pre></td></tr><tr><td data-num=50></td><td><pre><span class="token comment">    */</span></pre></td></tr><tr><td data-num=51></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=52></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight cpp"><figcaption data-lang=C++><span>移位运算符重载</span></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token keyword">friend</span> ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> cout<span class="token punctuation">,</span>Person<span class="token operator">&amp;</span> p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">int</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token keyword">int</span> height<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token comment">//void operator&lt;&lt;() &#123;&#125;;// 无法利用成员函数重载左移运算符</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">age</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">height</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token comment">// 只能用全局函数重载左移运算符</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token comment">// 返回引用是为了可多次调用，返回值则会返回一个新的操作对象</span></pre></td></tr><tr><td data-num=17></td><td><pre>ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> cout<span class="token punctuation">,</span>Person<span class="token operator">&amp;</span> p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=19></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"age: "</span> <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span>age <span class="token operator">&lt;&lt;</span> <span class="token string">"heihgt: "</span> <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span>height<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=21></td><td><pre></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=24></td><td><pre>    Person <span class="token function">p</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">170</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=25></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> p <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=26></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight cpp"><figcaption data-lang=C++><span>自增/自减运算符重载</span></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">int</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">age</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token comment">// 成员函数重载前置++运算符，返回引用</span></pre></td></tr><tr><td data-num=11></td><td><pre>    Person<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=13></td><td><pre>        <span class="token operator">++</span>age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre>        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=16></td><td><pre>    <span class="token comment">// 成员函数重载后置++运算符，返回值</span></pre></td></tr><tr><td data-num=17></td><td><pre>    <span class="token comment">// int类型充当占位符，用于区分前置++与后置++</span></pre></td></tr><tr><td data-num=18></td><td><pre>    Person <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=19></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=20></td><td><pre>        Person temp <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=21></td><td><pre>        <span class="token operator">++</span>age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=22></td><td><pre>        <span class="token keyword">return</span> temp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=23></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=25></td><td><pre></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=28></td><td><pre>    Person <span class="token function">p</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=29></td><td><pre>    <span class="token operator">++</span><span class="token punctuation">(</span><span class="token operator">++</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=30></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight cpp"><figcaption data-lang=C++><span>赋值运算符重载</span></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">int</span><span class="token operator">*</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> age <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=10></td><td><pre>    </pre></td></tr><tr><td data-num=11></td><td><pre>    <span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=13></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">!=</span> age<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=14></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=15></td><td><pre>            <span class="token keyword">delete</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre>            age <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=17></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=18></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=19></td><td><pre>    </pre></td></tr><tr><td data-num=20></td><td><pre>    Person<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>Person<span class="token operator">&amp;</span> p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=21></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=22></td><td><pre>        <span class="token comment">//age = p.age;// 编译器提供的拷贝构造函数写法</span></pre></td></tr><tr><td data-num=23></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">!=</span> age<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=24></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=25></td><td><pre>            <span class="token keyword">delete</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=26></td><td><pre>            age <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=27></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=28></td><td><pre>        age <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=29></td><td><pre>        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=30></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=31></td><td><pre>    </pre></td></tr><tr><td data-num=32></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=33></td><td><pre></pre></td></tr><tr><td data-num=34></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=36></td><td><pre>    Person <span class="token function">p1</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=37></td><td><pre>    Person <span class="token function">p2</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=38></td><td><pre>    Person <span class="token function">p3</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=39></td><td><pre>    <span class="token comment">// 浅拷贝会由于对象析构函数而导致复制的内存消失，故引起非法内存</span></pre></td></tr><tr><td data-num=40></td><td><pre>    p3 <span class="token operator">=</span> p2 <span class="token operator">=</span> p1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=41></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=42></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight cpp"><figcaption data-lang=C++><span>关系运算符重载</span></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=4></td><td><pre></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=8></td><td><pre>    string name<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token keyword">int</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=11></td><td><pre>    <span class="token function">Person</span><span class="token punctuation">(</span>string x<span class="token punctuation">,</span><span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">name</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">age</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=12></td><td><pre>    </pre></td></tr><tr><td data-num=13></td><td><pre>    <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span>Person<span class="token operator">&amp;</span> p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=15></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-></span>name <span class="token operator">==</span> p<span class="token punctuation">.</span>name <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token operator">-></span>age <span class="token operator">==</span> p<span class="token punctuation">.</span>age<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=16></td><td><pre>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=17></td><td><pre>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=18></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=19></td><td><pre>    </pre></td></tr><tr><td data-num=20></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=21></td><td><pre></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=24></td><td><pre>    Person <span class="token function">p1</span><span class="token punctuation">(</span><span class="token string">"xxx"</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=25></td><td><pre>    Person <span class="token function">p2</span><span class="token punctuation">(</span><span class="token string">"xx"</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=26></td><td><pre>    </pre></td></tr><tr><td data-num=27></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>p1 <span class="token operator">==</span> p2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=28></td><td><pre>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"true"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=29></td><td><pre>    <span class="token keyword">else</span></pre></td></tr><tr><td data-num=30></td><td><pre>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"false"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=31></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=32></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight cpp"><figcaption data-lang=C++><span>函数调用运算符重载(仿函数)</span></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=4></td><td><pre></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MyPrint</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">void</span> <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>string msg<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>cout <span class="token operator">&lt;&lt;</span> msg <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MyAdd</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token keyword">int</span> <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span> n1<span class="token punctuation">,</span><span class="token keyword">int</span> n2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> n1 <span class="token operator">+</span> n2<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=19></td><td><pre>    MyPrint mp<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=20></td><td><pre>    <span class="token function">mp</span><span class="token punctuation">(</span><span class="token string">"hello world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 仿函数</span></pre></td></tr><tr><td data-num=21></td><td><pre>    </pre></td></tr><tr><td data-num=22></td><td><pre>    MyAdd ma<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=23></td><td><pre>    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token function">ma</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token function">MyAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">// 匿名函数对象调用</span></pre></td></tr><tr><td data-num=25></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight cpp"><figcaption data-lang=C++><span>内存管理运算符</span></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">unsigned</span> <span class="token expression"><span class="token keyword">long</span> <span class="token keyword">long</span> size_t</span></span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=9></td><td><pre>    string name<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token keyword">int</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token function">Person</span><span class="token punctuation">(</span>string x<span class="token punctuation">,</span><span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">name</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">age</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=13></td><td><pre>    </pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token comment">// 类中对内存管理运算符重载函数默认为静态成员函数</span></pre></td></tr><tr><td data-num=15></td><td><pre>    <span class="token keyword">void</span><span class="token operator">*</span> <span class="token keyword">operator</span> <span class="token keyword">new</span><span class="token punctuation">(</span>size_t size<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=16></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=17></td><td><pre>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"类new"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=18></td><td><pre>        <span class="token keyword">void</span><span class="token operator">*</span> ptr <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=20></td><td><pre></pre></td></tr><tr><td data-num=21></td><td><pre>    <span class="token keyword">void</span> <span class="token keyword">operator</span> <span class="token keyword">delete</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span> ptr<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=22></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=23></td><td><pre>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"类delete"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> ptr<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=25></td><td><pre>        <span class="token function">free</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=26></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=27></td><td><pre>    </pre></td></tr><tr><td data-num=28></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=29></td><td><pre></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token keyword">void</span><span class="token operator">*</span> <span class="token keyword">operator</span> <span class="token keyword">new</span><span class="token punctuation">(</span>size_t size<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=32></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"全局new"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=33></td><td><pre>    <span class="token keyword">void</span><span class="token operator">*</span> ptr <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=34></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=35></td><td><pre></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token keyword">void</span> <span class="token keyword">operator</span> <span class="token keyword">delete</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span> ptr<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=38></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"全局delete"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=39></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> ptr<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=40></td><td><pre>    <span class="token function">free</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=41></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=42></td><td><pre></pre></td></tr><tr><td data-num=43></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=44></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=45></td><td><pre>    <span class="token keyword">int</span><span class="token operator">*</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 调用全局</span></pre></td></tr><tr><td data-num=46></td><td><pre>    <span class="token keyword">delete</span> p1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=47></td><td><pre></pre></td></tr><tr><td data-num=48></td><td><pre>    Person<span class="token operator">*</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token string">"xxx"</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 类会优先调用类中的重载</span></pre></td></tr><tr><td data-num=49></td><td><pre>    <span class="token keyword">delete</span> p<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=50></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=51></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><details class=info><summary>内存池是什么？</summary><div><p>通过预先分配一块较大的内存区域，然后将其切分为多个固定大小的块(或称为内存块或内存页)。</p><p>在程序初始化或运行时，一次性申请一块大内存(称为池)，然后将这块内存分割成多个大小相等的块。</p><p>当需要分配内存时，直接从这些预先切分好的内存块中分配，而不需要再通过系统的动态内存分配函数(如malloc或new)来申请内存。</p><p>当释放内存时，将内存块归还给内存池，而不是通过系统的动态内存释放函数(如free或delete)来释放内存。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=4></td><td><pre></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">int</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre>    string name<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token keyword">static</span> <span class="token keyword">char</span><span class="token operator">*</span> pool<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span>string y<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">age</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">name</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=13></td><td><pre>    <span class="token keyword">static</span> <span class="token keyword">bool</span> <span class="token function">poolinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=15></td><td><pre>        pool <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> pool<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=17></td><td><pre>        <span class="token function">memset</span><span class="token punctuation">(</span>pool<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=18></td><td><pre>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"pool head: "</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token punctuation">)</span>pool <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=20></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=21></td><td><pre>    </pre></td></tr><tr><td data-num=22></td><td><pre>    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">poolfree</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=23></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=24></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> pool<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=25></td><td><pre>        <span class="token function">free</span><span class="token punctuation">(</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=26></td><td><pre>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"pool have free"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=27></td><td><pre>    <span class="token punctuation">&#125;</span>   </pre></td></tr><tr><td data-num=28></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token keyword">char</span><span class="token operator">*</span> Person<span class="token double-colon punctuation">::</span>pool <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=30></td><td><pre></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token keyword">void</span><span class="token operator">*</span> <span class="token keyword">operator</span> <span class="token keyword">new</span><span class="token punctuation">(</span>size_t size<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=32></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=33></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"全局new"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=34></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> pool<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=35></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=36></td><td><pre>        pool<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=37></td><td><pre>        <span class="token keyword">return</span> pool <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=38></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=39></td><td><pre>    </pre></td></tr><tr><td data-num=40></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> pool<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=41></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=42></td><td><pre>        pool<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=43></td><td><pre>        <span class="token keyword">return</span> pool <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=44></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=45></td><td><pre>    <span class="token keyword">void</span><span class="token operator">*</span> ptr <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=46></td><td><pre>    <span class="token keyword">return</span> ptr<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=47></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=48></td><td><pre></pre></td></tr><tr><td data-num=49></td><td><pre><span class="token keyword">void</span> <span class="token keyword">operator</span> <span class="token keyword">delete</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span> ptr<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=50></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=51></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"全局delete"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=52></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> ptr<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=53></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>ptr <span class="token operator">==</span> pool <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=54></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=55></td><td><pre>        pool<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=56></td><td><pre>        <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=57></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=58></td><td><pre>    </pre></td></tr><tr><td data-num=59></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>ptr <span class="token operator">==</span> pool <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=60></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=61></td><td><pre>        pool<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=62></td><td><pre>        <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=63></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=64></td><td><pre>    <span class="token function">free</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=65></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=66></td><td><pre></pre></td></tr><tr><td data-num=67></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=68></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=69></td><td><pre>    <span class="token comment">// 初始化内存池</span></pre></td></tr><tr><td data-num=70></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token boolean">false</span> <span class="token operator">==</span> <span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token function">poolinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=71></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=72></td><td><pre>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Err init"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=73></td><td><pre>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=74></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=75></td><td><pre></pre></td></tr><tr><td data-num=76></td><td><pre>    Person<span class="token operator">*</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token string">"xxx1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 使用内存池第一个位置</span></pre></td></tr><tr><td data-num=77></td><td><pre>    Person<span class="token operator">*</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token string">"xxx2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 使用内存池第二个位置</span></pre></td></tr><tr><td data-num=78></td><td><pre>    Person<span class="token operator">*</span> p3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token string">"xxx3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 使用系统内存</span></pre></td></tr><tr><td data-num=79></td><td><pre>    </pre></td></tr><tr><td data-num=80></td><td><pre>    <span class="token comment">// 将内存块归还</span></pre></td></tr><tr><td data-num=81></td><td><pre>    <span class="token keyword">delete</span> p1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=82></td><td><pre>    <span class="token keyword">delete</span> p2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=83></td><td><pre>    <span class="token keyword">delete</span> p3<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=84></td><td><pre>    </pre></td></tr><tr><td data-num=85></td><td><pre>    <span class="token comment">// 释放内存池</span></pre></td></tr><tr><td data-num=86></td><td><pre>    <span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token function">poolfree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=87></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=88></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></div></details><h3 id=继承inheritance><a class=anchor href=#继承inheritance>#</a> 继承(Inheritance)</h3><p>继承可以使用现有类的所有功能，并且无需重新编写原来的类即可对功能进行拓展。</p><h4 id=继承方式><a class=anchor href=#继承方式>#</a> 继承方式</h4><p>继承的语法 - <code>class 子类：继承方式 父类名</code>，继承方式有</p><ul><li>公共继承</li><li>保护继承</li><li>私有继承</li></ul><p height=75% width=75%><img data-src=https://jd.reversesacle.com/gh/ReverseSacle/Gallery@latest/programming/c++/basic/1.webp alt=""></p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">A</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">protected</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=11></td><td><pre>    <span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=13></td><td><pre></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token comment">// A中的私有权限无法访问</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token keyword">class</span> <span class="token class-name">B</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">A</span></span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=18></td><td><pre>    <span class="token keyword">using</span> A<span class="token double-colon punctuation">::</span>b<span class="token punctuation">;</span><span class="token comment">// 把A中b的访问权限修改为公有</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=20></td><td><pre>    <span class="token keyword">using</span> A<span class="token double-colon punctuation">::</span>a<span class="token punctuation">;</span><span class="token comment">// 把A中a的访问权限修改为私有</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><details class=info><summary>c++默认是什么继承？</summary><div><p>类中默认是私有继承。</p><p>结构体中默认是public继承。</p></div></details><details class=info><summary>什么不能被继承？</summary><div><ul><li><strong>私有成员</strong> - 私有成员(私有属性和私有方法)不能被继承。它们只能在声明它们的类中访问，无法被派生类直接访问</li><li><strong>构造函数和析构函数</strong> - 构造函数和析构函数不能被继承。派生类会调用基类的构造函数和析构函数，但并不继承它们</li><li><strong>友元函数</strong> - 如果某个函数是类的友元函数，它不能被继承到派生类中</li><li><strong>友元类</strong> - 如果一个类被声明为另一个类的友元类，那么这个友元关系不会被继承到派生类</li><li><strong>静态成员</strong> - 静态成员(包括静态数据成员和静态成员函数)属于类而不是类的对象，因此它们不会被继承到派生类中。静态成员通过类名访问，而不是通过对象。</li><li><strong>重载的运算符</strong> - 如果基类中有一个重载的运算符，例如<code>operator+</code>，则派生类并不会继承这个运算符的重载版本。需要在派生类中重新定义或重载运算符</li></ul></div></details><h4 id=继承的对象模型><a class=anchor href=#继承的对象模型>#</a> 继承的对象模型</h4><p>继承的构造顺序是先构造父类再构造子类。</p><p>继承的析构顺序是先析构子类再析构父类。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Base</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">int</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token keyword">int</span> b<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">protected</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=11></td><td><pre>    <span class="token keyword">int</span> c<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Son</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=17></td><td><pre>    <span class="token keyword">int</span> d<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=22></td><td><pre>    Son s<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=23></td><td><pre>    </pre></td></tr><tr><td data-num=24></td><td><pre>    <span class="token comment">/**</span></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token comment">     * 父类中所有非静态成员属性都会被子类继承，</span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token comment">     * 父类的私有成员被编译器隐藏了，访问不到。</span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token comment">     * 16个字节</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token comment">    **/</span></pre></td></tr><tr><td data-num=29></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=30></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h4 id=同名成员的处理方式><a class=anchor href=#同名成员的处理方式>#</a> 同名成员的处理方式</h4><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Base</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">int</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">protected</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token keyword">int</span> c<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=11></td><td><pre>    <span class="token keyword">int</span> b<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">c</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Base初始化列表"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=13></td><td><pre>    <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Base的func"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Son</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=19></td><td><pre>    <span class="token keyword">int</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=20></td><td><pre>    <span class="token function">Son</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Son初始化列表"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=21></td><td><pre>    <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"son的func"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=23></td><td><pre></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=26></td><td><pre>    Son s<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=27></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Son下的a"</span> <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span>a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=28></td><td><pre>    <span class="token comment">// Base::表示作用域，通过作用域可访问</span></pre></td></tr><tr><td data-num=29></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Son下Base下的a"</span> <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span>Base<span class="token double-colon punctuation">::</span>a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=30></td><td><pre>    </pre></td></tr><tr><td data-num=31></td><td><pre>    s<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 子类会屏蔽父类所有同名的成员函数</span></pre></td></tr><tr><td data-num=32></td><td><pre>    s<span class="token punctuation">.</span><span class="token class-name">Base</span><span class="token double-colon punctuation">::</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Base::表示作用域，通过作用域可访问</span></pre></td></tr><tr><td data-num=33></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=34></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h4 id=同名静态成员的处理方式><a class=anchor href=#同名静态成员的处理方式>#</a> 同名静态成员的处理方式</h4><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Base</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">static</span> <span class="token keyword">int</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Base func"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">int</span> Base<span class="token double-colon punctuation">::</span>a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=11></td><td><pre></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Son</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=15></td><td><pre>    <span class="token keyword">static</span> <span class="token keyword">int</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre>    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Son func"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=18></td><td><pre></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token keyword">int</span> Son<span class="token double-colon punctuation">::</span>a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=20></td><td><pre></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=23></td><td><pre>    Son s<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre>    <span class="token comment">// 静态变量</span></pre></td></tr><tr><td data-num=25></td><td><pre>    <span class="token comment">// 1.通过对象访问</span></pre></td></tr><tr><td data-num=26></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Son下的a"</span> <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span>a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=27></td><td><pre>    <span class="token comment">// Base::表示作用域，通过作用域可访问</span></pre></td></tr><tr><td data-num=28></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Son下Base下的a"</span> <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span>Base<span class="token double-colon punctuation">::</span>a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=29></td><td><pre>    </pre></td></tr><tr><td data-num=30></td><td><pre>    <span class="token comment">// 2.通过类名访问</span></pre></td></tr><tr><td data-num=31></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Son下的a"</span> <span class="token operator">&lt;&lt;</span> Son<span class="token double-colon punctuation">::</span>a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=32></td><td><pre>    <span class="token comment">// Base::表示作用域，通过作用域可访问</span></pre></td></tr><tr><td data-num=33></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Son下Base下的a"</span> <span class="token operator">&lt;&lt;</span> Son<span class="token double-colon punctuation">::</span>Base<span class="token double-colon punctuation">::</span>a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=34></td><td><pre>    </pre></td></tr><tr><td data-num=35></td><td><pre>    <span class="token comment">// 静态函数</span></pre></td></tr><tr><td data-num=36></td><td><pre>    <span class="token comment">// 1.通过对象访问</span></pre></td></tr><tr><td data-num=37></td><td><pre>    s<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 子类会屏蔽父类所有同名的成员函数</span></pre></td></tr><tr><td data-num=38></td><td><pre>    s<span class="token punctuation">.</span><span class="token class-name">Base</span><span class="token double-colon punctuation">::</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Base::表示作用域，通过作用域可访问</span></pre></td></tr><tr><td data-num=39></td><td><pre>    </pre></td></tr><tr><td data-num=40></td><td><pre>    <span class="token comment">// 2.通过类名访问</span></pre></td></tr><tr><td data-num=41></td><td><pre>    <span class="token class-name">Son</span><span class="token double-colon punctuation">::</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=42></td><td><pre>    Son<span class="token double-colon punctuation">::</span><span class="token class-name">Base</span><span class="token double-colon punctuation">::</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=43></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=44></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h4 id=多继承语法><a class=anchor href=#多继承语法>#</a> 多继承语法</h4><p>实际开发不建议使用。</p><p>语法 - <code>class 子类：继承方式 父类1，继承方式 父类2...</code></p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Base1</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">int</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token function">Base1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Base2</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token keyword">int</span> b<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre>    <span class="token function">Base2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=17></td><td><pre></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Son</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base1</span><span class="token punctuation">,</span><span class="token keyword">public</span> <span class="token class-name">Base2</span></span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=21></td><td><pre>    <span class="token keyword">int</span> a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=22></td><td><pre>    <span class="token function">Son</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=27></td><td><pre>    Son s<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=28></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">// 12字节</span></pre></td></tr><tr><td data-num=29></td><td><pre>    </pre></td></tr><tr><td data-num=30></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span>a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">// 调用子类的a</span></pre></td></tr><tr><td data-num=31></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span>Base1<span class="token double-colon punctuation">::</span>a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">// 调用Base1的a</span></pre></td></tr><tr><td data-num=32></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span>Base2<span class="token double-colon punctuation">::</span>b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">// 调用Base2的a</span></pre></td></tr><tr><td data-num=33></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=34></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h4 id=菱形钻石继承diamond-problem与虚继承><a class=anchor href=#菱形钻石继承diamond-problem与虚继承>#</a> 菱形/钻石继承(Diamond Problem)与虚继承</h4><p>两个子类继承同一个基类，某个子类继承之前的两个子类。</p><p>菱形继承会使子类继承两份相同的数据，导致资源浪费。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Animal</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">int</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token comment">// 在继承之前加上virtual关键字变为虚继承</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token comment">// Animal类称为虚基类</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Sheep</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">virtual</span> <span class="token keyword">public</span> <span class="token class-name">Animal</span></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Tuo</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">virtual</span> <span class="token keyword">public</span> <span class="token class-name">Animal</span></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">class</span> <span class="token class-name">SheepTuo</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">sheep</span><span class="token punctuation">,</span><span class="token keyword">public</span> <span class="token class-name">Tuo</span></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=18></td><td><pre></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=21></td><td><pre>    SheepTuo st<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=22></td><td><pre>    st<span class="token punctuation">.</span>Sheep<span class="token double-colon punctuation">::</span>age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=23></td><td><pre>    st<span class="token punctuation">.</span>Tuo<span class="token double-colon punctuation">::</span>age <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre>    </pre></td></tr><tr><td data-num=25></td><td><pre>    <span class="token comment">// 菱形继承会导致有两份age，通过虚继承解决</span></pre></td></tr><tr><td data-num=26></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> st<span class="token punctuation">.</span>Sheep<span class="token double-colon punctuation">::</span>age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=27></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> st<span class="token punctuation">.</span>Tuo<span class="token double-colon punctuation">::</span>age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=28></td><td><pre>    </pre></td></tr><tr><td data-num=29></td><td><pre>    <span class="token comment">// 由于虚继承，使age数据共享并且只有一份</span></pre></td></tr><tr><td data-num=30></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> st<span class="token punctuation">.</span>age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=31></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=32></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><details class=info><summary>为什么需要虚继承？</summary><div><p>虚继承是多重继承中特有的概念。虚基类是一个带有<code>virtual</code>关键字的基类，是用于解决多继承中的菱形继承问题。 如，类D继承自类B1、B2，而类B1、B2都继承自类A，其中类D继承了两次类A中的变量和函数。为了节省内存空间，可以将B1、B2对A的继承定义为虚继承，而A就成了虚基类。</p><p>虚继承在一般的应用中很少用到，在<code>C++</code>中，多重继承是不推荐的，也并不常用。虚继承一旦离开了多重继承，就会完全失去存在的必要，因为这样只会降低效率和占用更多的空间。</p><p>虚继承的特点是，在任何派生类中，虚基类总用同一个(共享)对象表示。</p></div></details><details class=info><summary>virtual关键字有什么用？</summary><div><p><code>virtual</code>关键字用于声明虚函数(virtual function)。虚函数是一种在面向对象编程中实现多态性的机制。多态性允许通过基类类型的指针或引用调用派生类对象的成员函数。主要用途包括</p><ul><li><p><strong>实现运行时多态性</strong> - <code>virtual</code>允许在运行时确定调用的是哪个类的函数，从而实现动态绑定(dynamic binding)或运行时多态性。这使得通过基类指针或引用调用派生类的虚函数时，能够根据实际对象类型来调用正确的函数</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Base</span> </pre></td></tr><tr><td data-num=2></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=4></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=5></td><td><pre>        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Base class\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Derived</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span> </pre></td></tr><tr><td data-num=10></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=13></td><td><pre>        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Derived class\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=18></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=19></td><td><pre>    Base<span class="token operator">*</span> ptr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Derived</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=20></td><td><pre>    ptr<span class="token operator">-></span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出 "Derived class"</span></pre></td></tr><tr><td data-num=21></td><td><pre>    <span class="token keyword">delete</span> ptr<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=22></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li><li><p><strong>允许在派生类中覆盖基类函数</strong> - 当在派生类中使用<code>virtual</code>关键字覆盖(override)基类中的虚函数时，这种覆盖关系可以传递到派生类的派生类中</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Base</span> </pre></td></tr><tr><td data-num=2></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=4></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=5></td><td><pre>        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Base class\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Derived</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span> </pre></td></tr><tr><td data-num=10></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=13></td><td><pre>        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Derived class\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">class</span> <span class="token class-name">FurtherDerived</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Derived</span></span> </pre></td></tr><tr><td data-num=18></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=20></td><td><pre>    <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=21></td><td><pre>        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"FurtherDerived class\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=22></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=26></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=27></td><td><pre>    Base<span class="token operator">*</span> ptr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">FurtherDerived</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=28></td><td><pre>    ptr<span class="token operator">-></span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出 "FurtherDerived class"</span></pre></td></tr><tr><td data-num=29></td><td><pre>    <span class="token keyword">delete</span> ptr<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=30></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li></ul><hr><details class=info><summary>引入虚继承和直接继承会有什么区别呢？</summary><div><p>在<strong>直接继承</strong>(Non-virtual Inheritance)中，基类的实例会直接嵌入到派生类的对象中。每个派生类都包含基类的一个完整实例。这意味着，如果一个类被多次直接继承，每个基类的实例都会在派生类的对象中存在一份。</p><p>在<strong>虚继承</strong>(Virtual Inheritance)中，基类的实例不会直接嵌入到派生类的对象中。相反，由编译器维护一个共享的基类子对象，被所有的虚继承类共享。这意味着无论基类在继承体系中出现多少次，其实例都只有一份。</p></div></details></div></details><h3 id=多态polymorphism><a class=anchor href=#多态polymorphism>#</a> 多态(Polymorphism)</h3><p>一个类实例的相同方法在不同情形下有不同的表现形式，使不同内部结构的对象可以共享相同的外部接口。</p><p><strong>分类</strong></p><ul><li><p>静态多态(编译期多态/静态联编) - <strong>函数重载</strong>和<strong>运算符重载</strong>，复用函数名</p><ul><li>重载多态(Ad-hoc Polymorphism) - 函数重载、运算符重载</li><li>参数多态性(Parametric Polymorphism) - 类模板、函数模板</li></ul></li><li><p>动态多态(运行期多态/动态联编) - 派生类和虚函数实现运行时多态</p><ul><li>子类型多态(Subtype Polymorphism) - 虚函数</li><li>强制多态(Coercion Polymorphism，编译期/运行期) - 基本类型转换、自定义类型转换</li></ul></li></ul><p><strong>区别</strong></p><ul><li>静态多态的函数地址在<strong>编译阶段</strong>被确定，称<strong>早绑定</strong></li><li>动态多态的函数地址在<strong>运行阶段</strong>被确定，称<strong>晚绑定</strong></li></ul><details class=info><summary>C++编译期多态与运行期多态是什么？</summary><div><p><strong>编译期多态</strong>是通过函数重载和运算符重载来实现的。这种多态性在编译时就能确定，因此也称为静态多态性。在编译期多态中，编译器根据函数或运算符的参数类型、个数和返回类型来选择正确的函数或运算符的实现。</p><p><strong>运行期多态</strong>是通过虚函数和继承来实现的。这种多态性在运行时确定，因此也称为动态多态性。在运行期多态中，程序在执行时根据实际对象的类型来调用相应的函数，实现了基类指针或引用调用派生类对象的成员函数。</p></div></details><details class=info><summary>动态联编(Dynamic Binding)和静态联编(Static Binding)是什么？</summary><div><p><strong>动态联编</strong></p><ul><li>动态联编是在程序运行时(运行时多态)确定方法的具体实现的过程</li><li>运行时多态性通过虚函数(使用<code>virtual</code>关键字定义)和运行时类型识别(RTTI)来实现</li><li>主要应用于面向对象编程，通过基类的指针或引用调用派生类的方法时，实际调用的是派生类的实现</li><li>动态联编使得程序能够在运行时适应对象的实际类型，提供了灵活性和可扩展性</li></ul><p><strong>静态联编</strong></p><ul><li>静态联编是在编译时(编译时多态)确定方法的具体实现的过程</li><li>编译器在编译阶段就能够确定调用的函数，而不需要等到运行时</li><li>静态联编主要涉及到函数重载和模板的使用。对于非虚函数，编译器可以根据函数的参数类型和数量，在编译时确定调用的具体函数</li></ul><p>动态联编提供了更大的灵活性，但由于运行时开销可能更大。静态联编则在编译时确定调用，性能可能更高，但缺乏一些灵活性。</p></div></details><details class=info><summary>运行期多态与编译期多态优缺点分析？</summary><div><p><strong>运行期多态(动态多态)</strong></p><p><strong>优点</strong></p><ul><li><strong>灵活性</strong> - 运行期多态使得程序更加灵活，能够在运行时根据实际对象的类型来选择调用相应的函数，支持更动态的行为</li><li><strong>可扩展性</strong> - 允许在不修改现有代码的情况下，通过添加新的派生类来扩展程序的功能</li></ul><p><strong>缺点</strong></p><ul><li><strong>性能开销</strong> - 运行期多态通常会引入一定的性能开销，因为在运行时需要进行虚函数的查找和调用，而这一过程是相对于编译期多态更为复杂的</li><li><strong>运行时错误</strong> - 由于函数调用是在运行时确定的，因此在编译期无法捕捉一些错误，例如调用不存在的虚函数</li></ul><p><strong>编译期多态(静态多态)</strong></p><p><strong>优点</strong></p><ul><li><strong>性能优势</strong> - 编译期多态的函数调用是通过编译时确定的，无需在运行时进行额外的查找，因此具有更高的执行效率</li><li><strong>编译时错误检查</strong> - 在编译期能够进行更严格的类型检查，可以在编译时捕捉一些错误，提高代码的可靠性</li></ul><p><strong>缺点</strong></p><ul><li><strong>相对固定</strong> - 编译期多态需要在编译时确定函数调用，因此在运行时无法根据实际对象类型动态选择函数的实现，缺乏一定的灵活性</li><li><strong>不支持动态扩展</strong> - 对于新增加的功能，可能需要修改现有代码，不够灵活</li></ul></div></details><h4 id=动态多态虚函数><a class=anchor href=#动态多态虚函数>#</a> 动态多态(虚函数)</h4><p>虚函数是一种用于实现多态的机制，它允许在派生类中重新定义基类中已经定义的函数。虚函数通过在基类中使用<code>virtual</code>关键字声明，并在派生类中进行覆盖。</p><p><strong>动态多态的作用</strong></p><p>隐藏实现细节，使代码模块化，提高代码的可复用性。</p><p>接口重用，使派生类的功能可以被基类的指针/引用所调用，即向后兼容，提高代码的可扩充性和可维护性。</p><p>当调用一个虚函数时，被执行的代码必须和调用函数的对象的动态类型相一致。</p><ul><li>不同编译器实现细节也不相同，大多数编译器通过<strong>虚函数表/虚表</strong>(virtual table - vtbl)和<strong>虚函数表指针/虚表指针</strong>(virtual table pointer - vptr)来实现。</li><li>继承类通常被称为派生类(Derived Class)，派生类是通过继承一个或多个基类(父类)而得到的新类，它继承了基类的成员和方法。</li><li>当一个类声明了虚函数或继承了虚函数，这个类就会有自己的虚表，即每个含有虚函数的类都有一个对应的虚函数表。虚表实际上就是一个函数指针数组(有的编译器用的是链表)。虚表中的每一个元素对应一个函数指针指向该类的一个虚函数，同时该类的每一个对象都会包含一个虚表指针，虚表指针指向该虚表的地址。</li><li>虚函数表通常存储在程序的全局数据区或在某些编译器中，可能会存储在只读数据段中，它是静态的，不随对象的创建或销毁而变化。虚函数表指针存储在对象的内存中。</li><li>当一个类继承自另一个类时，它会继承基类的虚函数表，并可能添加或覆盖其中的函数。如果子类覆盖了父类的虚函数，将被放到了虚表中原来父类虚函数的位置。在多继承的情况下，该类有每个父类各自的虚表，子类的成员函数被放到了第一个父类的表中。</li></ul><p><strong>动态多态的必要条件</strong></p><ul><li><p>有继承关系。</p></li><li><p>需要有基类指针/引用指向子类对象。</p></li><li><p>子类要重写父类的虚函数。</p></li></ul><p><strong>应用场景</strong> - 用于派生，一个基类派生多个子类，子类与基类有相同的行为</p><figure class="highlight cpp"><figcaption data-lang=C++><span>虚函数</span><span class=exturl data-url="aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWV0NDExYjczWi8/cD0xMzYmc3BtX2lkX2Zyb209cGFnZURyaXZlciZ2ZF9zb3VyY2U9MTg0NWFmNThkZTJkN2VlOWY4OGZkMmEzZWFmMjhkNGI=">解析</span></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Animal</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token comment">// 虚函数，父类一定要加virtual关键字，子类可不写。</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Animal Speak"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Cat</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Animal</span></span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token comment">// 重写父类的虚函数，返回值类型/函数名/参数要完全一样</span></pre></td></tr><tr><td data-num=15></td><td><pre>    <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Cat Speak"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=17></td><td><pre></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Dog</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Animal</span></span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=21></td><td><pre>    <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Dog Speak"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=23></td><td><pre></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token keyword">void</span> <span class="token function">dospeak</span><span class="token punctuation">(</span>Animal<span class="token operator">&amp;</span> animal<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=26></td><td><pre>    <span class="token comment">/**</span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token comment">     * 没有使用虚函数时，speak函数地址会在编译时被确定</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token comment">     * 使用虚函数后，执行时speak函数地址才会被确定</span></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token comment">    **/</span></pre></td></tr><tr><td data-num=30></td><td><pre>    animal<span class="token punctuation">.</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=31></td><td><pre>    Animal an<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=32></td><td><pre>    </pre></td></tr><tr><td data-num=33></td><td><pre>    <span class="token comment">/**</span></pre></td></tr><tr><td data-num=34></td><td><pre><span class="token comment">     * 字节为4</span></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token comment">     * 没有添加关键字之前，成员函数不会占用空间，类占一个字节；</span></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token comment">     * 添加virtual关键字后，类内会多出一个指针</span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token comment">    **/</span></pre></td></tr><tr><td data-num=38></td><td><pre>    cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>an<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=39></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=40></td><td><pre></pre></td></tr><tr><td data-num=41></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=42></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=43></td><td><pre>    Animal<span class="token operator">*</span> cat <span class="token operator">=</span> <span class="token keyword">new</span> Cat<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=44></td><td><pre>    <span class="token function">dospeak</span><span class="token punctuation">(</span>cat<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=45></td><td><pre>    <span class="token keyword">delete</span> cat<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=46></td><td><pre>    </pre></td></tr><tr><td data-num=47></td><td><pre>    Animal<span class="token operator">*</span> dog <span class="token operator">=</span> <span class="token keyword">new</span> Dog<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=48></td><td><pre>    <span class="token function">dospeak</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=49></td><td><pre>    <span class="token keyword">delete</span> dog<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=50></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=51></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><details class=info><summary>C++里访问虚函数会比访问普通函数慢吗？</summary><div><p>单继承时性能差不多，多继承的时候会慢。</p></div></details><details class=info><summary>为什么基类的构造函数不能定义为虚函数？(构造函数为什么⼀般不定义为虚函数？/构造函数能否是虚函数？)</summary><div><p>虚函数的调用依赖于虚函数表，而指向虚函数表的虚表指针需要在构造函数中进行初始化，所以无法调用定义为虚函数的构造函数。而且，在构造函数中调用虚函数，实际执行的是父类的对应函数，因为自己还没有构造好, 所以此时是无法进行多态的。</p><ul><li><p><strong>虚函数机制在构造函数中的限制</strong> - 在对象构造的过程中，虚函数机制的实现是在构造函数中受到限制的。因为在构造函数执行过程中，对象可能尚未完全构造完成，其派生类部分可能还没有被初始化。因此，虚函数表和虚函数指针在构造函数执行期间可能还没有被正确设置。</p></li><li><p><strong>对象的动态类型尚未确定</strong> - 在构造函数中，对象的动态类型(即运行时类型)尚未确定，因为构造函数正在初始化对象的基类部分。虚函数的多态性依赖于对象的动态类型，而在构造函数中，这个类型尚未完全确定。</p></li><li><p><strong>虚函数调用的问题</strong> - 如果构造函数是虚函数，那么在构造对象时，调用的虚函数会被解析到当前类的虚函数表。这可能导致在派生类构造函数中调用的虚函数仍然是基类版本，而不是派生类版本，因为派生类的虚函数表可能还没有被设置。这可能导致意外行为和错误。</p></li><li><p><strong>构造函数的初始化顺序</strong> - 虚函数的调用涉及到虚函数表的设置，而虚函数表的设置又受到对象成员初始化顺序的影响。构造函数的执行顺序是按照类中声明的成员的顺序进行的，而不是按照初始化列表中的顺序。这可能导致虚函数表尚未设置完成就被调用。</p></li></ul></div></details><details class=info><summary>虚函数可以是内联函数吗？</summary><div><p>虚函数可以是内联函数，内联是可以修饰虚函数的，但是当虚函数表现多态性的时候不能内联。 理由如下：内联是在发生在编译期间，编译器会自主选择内联，而虚函数的多态性在运行期，编译器无法知道运行期调用哪个代码，因此虚函数表现为多态性时(运行期)不可以内联。</p></div></details><details class=info><summary>编译器是如何处理虚函数表的？(虚函数工作原理？)</summary><div><ul><li><p><strong>虚函数声明</strong> - 当一个类中声明了虚函数时，编译器会在该类的类型信息中生成一个指向虚函数表的指针。这个指针通常被命名为<code>vptr</code>，它是每个类实例的一部分，被用来指向该类的虚函数表</p></li><li><p><strong>虚函数表的构建</strong> - 对于每个包含虚函数的类，编译器会在编译时生成一个虚函数表。虚函数表是一个数组，其中每个元素都是指向相应虚函数的指针</p></li><li><p><strong>vptr的初始化</strong> - 在类的构造函数中，编译器会在对象的内存布局中添加一个虚函数表指针(vptr)。在对象被创建时，vptr会被初始化为指向正确的虚函数表</p></li><li><p><strong>虚函数调用过程</strong> - 当调用一个虚函数时，实际上是通过对象的vptr找到相应的虚函数表，再通过表中的指针找到对应的函数进行调用。这个过程是在运行时动态完成的</p></li><li><p><strong>派生类的虚函数表</strong> - 如果派生类重写了基类的虚函数，它会有自己的虚函数表，并且vptr指向派生类的虚函数表。如果派生类没有重写某个虚函数，它会继续使用基类的虚函数</p></li><li><p><strong>虚函数表的多层继承</strong> - 对于多层继承，每个类都有自己的虚函数表。当调用虚函数时，编译器会通过vptr链依次查找最终实现的函数</p></li></ul></div></details><details class=info><summary>动态绑定是如何实现的？</summary><div><p>当编译器发现类中有虚函数时，会创建一张虚函数表，把虚函数的函数入口地址放到虚函数表中，并且在对象中增加一个虚表指针，用于指向类的虚函数表。当派生类覆盖基类的虚函数时，会将虚函数表中对应的指针进行替换，从而调用派生类中覆盖后的虚函数，从而实现动态绑定。</p></div></details><details class=info><summary>虚函数表是针对类还是针对对象？同一个类的两个对象的虚函数表是怎么维护的？</summary><div><p>虚函数表是针对类的，类的所有对象共享这个类的虚函数表，因为每个对象内部都保存一个指向该类虚函数表的虚表指针，每个对象的虚表指针的存放地址都不同，但都指向同一虚函数表。</p></div></details><details class=info><summary>继承情况下的虚函数表是怎样的？</summary><div><p><img data-src=https://jd.reversesacle.com/gh/ReverseSacle/Gallery@latest/programming/c++/basic/2.webp alt=""></p></div></details><details class=info><summary>虚函数表是共享还是独有的？</summary><div><p>每个类都有其自己的虚函数表(vtable)。虚函数表是用于实现虚函数机制的一种数据结构，存储了类中虚函数的地址。每个类的对象都包含一个指向其类的虚函数表的指针，称为虚指针(vptr)。</p><p>在继承关系中，派生类的虚函数表通常包含了基类的虚函数表。派生类可能会在自己的虚函数表中添加新的虚函数或者覆盖基类的虚函数。</p><p>所以，虚函数表是独立于每个类的，不是共享的。不同类的虚函数表在内存中是不同的，它们通过对象的虚指针(vptr)来访问。</p></div></details><details class=info><summary>哪些函数不能是虚函数？</summary><div><p><strong>构造函数和析构函数</strong> - 构造函数和析构函数不能被声明为虚函数。虚函数的工作原理依赖于对象的类型信息，而在对象构造或析构的过程中，类型信息可能尚未完全建立或已经销毁。</p><p><strong>静态成员函数</strong> - 静态成员函数是与类关联而不是与类的对象关联的，因此不能被声明为虚函数。</p><p><strong>友元函数</strong> - 友元函数是独立于类的，它不是类的成员，因此不能被声明为虚函数。</p></div></details><details class=info><summary>虚函数表和虚函数指针的位置，在堆上，栈上还是其他地方？</summary><div><p>既不在堆上，也不在栈上。虚函数表(vtable)的表项在编译期已经确定，就是一组常量函数指针。跟代码一样，在程序编译好的时候就保存在<strong>可执行文件里面</strong>，程序运行前会直接加载到内存中。而堆和栈的内存是在运行时分配的。而跟虚函数表对应的虚函数表指针(vptr)，会作为对象的一个(隐藏)成员，总是跟对象的其他成员一起。如果对象分配在堆上，vptr也跟着在堆上；如果对象分配在栈上，vptr也在栈上。</p></div></details><details class=info><summary>调用虚函数和非虚函数(普通函数)的区别？</summary><div><p><strong>非虚函数</strong>(普通函数)的调用在编译时就已经确定了。编译器根据调用函数的对象类型来决定调用哪个函数，由于在编译时就已经确定了函数调用，所以非虚函数通常有更好的性能。在继承中，如果子类重写了父类的非虚函数，那么哪个函数被调用将取决于对象的静态类型。即使通过父类指针调用，也会调用父类的函数。</p><p><strong>虚函数</strong>的调用不是在编译时决定的，而是在运行时决定的。这允许通过基类指针或引用调用派生类的函数，这是多态的基础。<code>C++</code>使用虚表来支持动态绑定。每个有虚函数的类都有一个虚表，表中存储了虚函数的地址。对象通过虚表来调用正确的函数。动态绑定会带来一定的性能开销，因为需要在运行时查找正确的函数来调用。如果子类重写了父类的虚函数，那么通过父类指针或引用调用该函数时，实际上会调用子类的版本。</p></div></details><details class=info><summary>构造函数中可以调用虚函数吗？</summary><div><p>在<code>C++</code>中，构造函数中是可以调用虚函数的，但需要注意以下问题：当一个派生类对象正在被创建时，对象的构造是从基类开始的。如果在基类的构造函数中调用了虚函数，而这个虚函数在派生类中被重写了，此时调用的仍然是基类版本的虚函数。这是因为派生类部分还没有被构造完成，无法调用派生类的成员函数。</p><p><strong>至于为什么会这样</strong>：主要是原因在于<code>C++</code>中的虚函数是通过虚函数表机制来实现动态绑定的。每个包含虚函数的类都有一个与之关联的虚表，其中包含了指向该类的虚函数的指针。当一个对象被创建时，它的构造函数会先调用其基类的构造函数，然后按照声明顺序初始化其成员，并最后执行其自身的构造函数代码。当在一个构造函数中调用虚函数时，由于此时正在构造的对象尚未完成构造，其类型被视为当前正在执行的构造函数所在的类，而不是最终派生类。因此，如果在基类的构造函数中调用虚函数，将使用基类的虚表，从而调用基类的虚函数，而不是派生类的虚函数。</p><p><strong>至于为什么不是最终派生类</strong>：虚函数表只会被创建一份，但是具体在什么地方创建，这个取决于编译器，但是其虚函数表指针一般会放在对象头部，也就是说，每个类只有一个虚函数表，但是每个对象都有自己的虚函数表指针。这意味着，同一类型的所有对象都共享同一个虚函数表的内容，但是各自的虚函数表指针可能指向不同的虚函数表(如果它们是不同类型的对象)。这也是为什么派生类可以覆盖基类的虚函数的原因，因为派生类的虚函数表中，对应的函数指针会被更新以指向派生类的。</p><p>而现在这个情况，由于派生类并未构造完成，所以派生类的的构造函数调用的虚函数只能参考基类而不是派生类，从而导致出现错误。</p><p>总的来说，虽然技术上允许在构造函数中调用虚函数，但是实际操作中却应该避免。一般来说，构造函数应该尽量简单，只做必要的初始化工作，而将复杂的逻辑放入其他成员函数中。</p></div></details><details class=info><summary>构造函数或析构函数中调用虚函数会怎样？</summary><div><p>不应该在构造函数和析构函数中调用虚函数。</p><p><strong>构造函数中调用虚函数</strong></p><ul><li>在基类构造函数中调用虚函数时，由于派生类的构造函数尚未执行，对象的类型仍然是基类，因此基类的虚函数将被调用，而不是派生类中的虚函数</li><li>这可能导致不符合预期的行为，因为派生类的成员尚未初始化</li></ul><p><strong>析构函数中调用虚函数</strong></p><ul><li>在基类析构函数中调用虚函数时，与构造函数类似，派生类的析构函数尚未执行，对象的类型仍然是基类，因此基类的虚函数将被调用</li><li>同样，这可能导致不符合预期的行为，因为派生类的成员可能已经被销毁</li></ul><p>假如有一个动物基类，这个基类定义了一个虚函数来表示动物的行为，叫做action。们在基类的构造函数中调用这个虚函数。然后有一个派生类重写了该虚函数。当创建一个派生类对象的时候，首先会执行基类部分，因此执行基类的构造函数，然后才会执行子类的构造函数。编译器在执行基类构造函数中的虚函数时，会认为这是一个基类的对象，因为派生类还并没有构造出来。因此达不到动态绑定的效果，父类构造函数中调用的仍然是父类版本的函数，子类中调用的仍然是子类版本的函数。</p></div></details><details class=info><summary>虚函数可以是静态的吗？</summary><div><p>不能是静态的。</p><p><strong>虚函数</strong>是用来支持运行时多态的。当通过基类的指针或引用调用一个虚函数时，<code>C++</code>运行时会根据对象的实际类型来确定应该调用哪个函数。这意味着虚函数是与对象的实例相关的，因为它们依赖于对象的实际类型。</p><p><strong>静态函数</strong>则是与类相关联的，而不是与类的某个特定实例相关联。静态成员函数可以在没有类的实例的情况下调用，它们不依赖于对象的实例。因此，静态成员函数不具有与任何对象实例相关的上下文，也就没有办法进行动态绑定。</p></div></details><details class=info><summary>虚函数调用性能方面怎样？</summary><div><ul><li><p>当调用虚函数时，通过对象的虚表指针找到类的虚表。这是一个简单的操作，因为编译器知道在对象内的哪个地方能找到虚表指针(毕竟是由编译器放置的)</p><ul><li>这步的代价只是一个偏移调整(以得到虚表指针)和一个指针的间接寻址(以得到虚表)</li></ul></li><li><p>找到对应虚表内的指向被调用函数的指针。这也是一个简单的操作，因为编译器为每个虚函数在虚表内分配了一个唯一的索引</p><ul><li>这步的代价只是一个虚表数组内的偏移调整</li></ul></li><li><p>调用在虚表内找到的函数指针所指向的函数</p><ul><li>在单继承的情况下，调用虚函数所需的代价基本上和非虚函数效率一样，在大多数计算机上它执行很少的指令(有很多人一概而论说虚函数性能不行是不太科学的)。在多继承的情况下，由于会根据多个父类生成多个虚表指针，在对象里为寻找虚表指针而进行的偏移量计算会变得复杂一些，但这些并不是虚函数的性能瓶颈</li></ul></li><li><p>虚函数运行时所需的代价主要是虚函数不能是内联函数。这是因为内联函数是指在编译期间用被调用的函数体本身来代替函数调用的指令，但是虚函数的<code>虚</code>是指<strong>直到运行时才能知道要调用的是哪一个函数</strong>。但虚函数的运行时多态特性就是要在运行时才知道具体调用哪个虚函数，所以没法在编译时进行内联函数展开。当然如果通过对象直接调用虚函数它是可以被内联，但是大多数虚函数是通过对象的指针或引用来被调用的，这种调用是不能被内联的。因为这种调用是标准的调用方式，所以虚函数实际上是不能被内联的</p></li></ul></div></details><details class=info><summary>虚函数占用空间方面怎样？</summary><div><p>为了实现运行时多态机制，编译器会给每一个包含虚函数或继承了虚函数的类自动建立一个虚函数表，所以虚函数的一个代价就是会增加类的体积。在虚函数接口较少的类中，这个代价并不明显，虚函数表的体积相当于几个函数指针的体积，如果有大量的类或者在每个类中有大量的虚函数，虚函数表会占用大量的地址空间。</p><p>但这并不是最主要的代价，主要的代价是发生在类的继承过程中，在上面的分析中，可以看到，当子类继承父类的虚函数时，子类会有自己的虚函数表，如果子类只覆盖父类的一两个虚函数接口，子类虚函数表的其余部分内容会与父类重复。假如在，存在大量的子类继承，且重写父类的虚函数接口只占总数的一小部分的情况下，会造成大量地址空间浪费。在一些GUI库上这种大量子类继承自同一父类且只覆盖其中一两个虚函数的情况是经常有的，这样就导致GUI库的占用内存明显变大。</p><p>由于虚函数表指针的存在，虚函数也会增加该类的每个对象的体积。在单继承或没有继承的情况下，类的每个对象会多一个虚函数指针的体积，也就是4个字节；在多继承的情况下，类的每个对象会多N个(N＝包含虚函数的父类个数)虚函数表指针的体积，也就是4N个字节。当一个类的对象体积较大时，这个代价不是很明显，但当一个类的对象很轻量的时候，如成员变量只有4个字节，那么再加上4(或4N)个字节的虚函数表指针，对象的体积相当于翻了1(或N)倍，这个代价是非常大的。</p></div></details><details class=info><summary>函数重载(override)和函数覆盖(overload)的区别？</summary><div><p><strong>函数重载(Overload)</strong></p><p>当一个作用域内有两个或更多个函数名相同但参数列表不同的函数时，就可以说这些函数构成了重载。参数列表不同，可以是参数数量不同，也可以是参数类型不同。函数重载使得可以使用一样的函数名来完成类似的操作，提高代码的可读性和易用性。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token keyword">double</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>函数覆盖(Override)</strong></p><p>当一个派生类声明了一个与基类中虚函数完全相同(函数名、参数类型和个数、常量属性、返回值类型)的函数时，就可以说派生类的这个函数覆盖了基类的虚函数。这使得可以通过基类指针或引用来调用派生类的函数，实现多态。</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Base</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=3></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Derived</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span> <span class="token keyword">override</span><span class="token punctuation">;</span><span class="token comment">// 覆盖基类的虚函数foo</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure></div></details><h4 id=纯虚函数与抽象类><a class=anchor href=#纯虚函数与抽象类>#</a> 纯虚函数与抽象类</h4><p>抽象基类是一种包含纯虚函数的类。纯虚函数是在基类中声明的虚函数，但没有提供实际的实现。这样的类无法被实例化，而只能被用作其他类的基类，用于派生出具体的子类，子类需要提供纯虚函数的具体实现。</p><p>纯虚函数语法 - <code>virtual 返回类型 函数名(参数列表) = 0;</code></p><p>当类中有了纯虚函数，这个类就被称为抽象类。定义纯虚函数是为了实现一个接口，起到规范的作用，想要继承这个类就必须覆盖该函数。</p><p><strong>抽象类的特点</strong></p><ul><li>无法实例化</li><li>子类必须重写抽象类的纯虚函数，否则也是抽象类</li></ul><p>接口类 - 仅含有纯虚函数的抽象类。</p><p>聚合类 - 用户可以直接访问其成员，并且具有特殊的初始化语法形式。满足如下特点</p><ul><li>所有成员都是public</li><li>没有定义任何构造函数</li><li>没有类内初始化</li><li>没有基类，也没有virtual函数</li></ul><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">inlcude</span><span class="token expression"><span class="token operator">&lt;</span>iostream<span class="token operator">></span></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">AbDrink</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">boil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">brew</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">pour</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">putsome</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=11></td><td><pre>    </pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token keyword">void</span> <span class="token function">makedrink</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=13></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=14></td><td><pre>        <span class="token function">boil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre>        <span class="token function">brew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre>        <span class="token function">pour</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=17></td><td><pre>        <span class="token function">putsome</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=18></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=20></td><td><pre></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Coffe</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">AbDrink</span></span></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=24></td><td><pre>    <span class="token keyword">void</span> <span class="token function">boil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"加水"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=25></td><td><pre>    <span class="token keyword">void</span> <span class="token function">brew</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"冲泡coffe"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=26></td><td><pre>    <span class="token keyword">void</span> <span class="token function">pour</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"倒入杯中"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=27></td><td><pre>    <span class="token keyword">void</span> <span class="token function">putsome</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"加糖"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=29></td><td><pre></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Tea</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">AbDDrink</span></span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=32></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=33></td><td><pre>    <span class="token keyword">void</span> <span class="token function">boil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"加水"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=34></td><td><pre>    <span class="token keyword">void</span> <span class="token function">brew</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"冲泡Tea"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=35></td><td><pre>    <span class="token keyword">void</span> <span class="token function">pour</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"倒入杯中"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=36></td><td><pre>    <span class="token keyword">void</span> <span class="token function">putsome</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"加枸杞"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=38></td><td><pre></pre></td></tr><tr><td data-num=39></td><td><pre><span class="token keyword">void</span> <span class="token function">dowork</span><span class="token punctuation">(</span>AbDrink<span class="token operator">*</span> abdrink<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=40></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=41></td><td><pre>    abdrink<span class="token operator">-></span>makedrink<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=42></td><td><pre>    <span class="token keyword">delete</span> abdrink<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=43></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=44></td><td><pre></pre></td></tr><tr><td data-num=45></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=46></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=47></td><td><pre>    <span class="token function">dowork</span><span class="token punctuation">(</span><span class="token keyword">new</span> Coffe<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=48></td><td><pre>    <span class="token function">dowork</span><span class="token punctuation">(</span><span class="token keyword">new</span> Tea<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=49></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=50></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><details class=info><summary>为什么需要纯虚函数？</summary><div><p>为了方便使用多态特性，常常需要在基类中定义虚拟函数。在很多情况下，基类本身生成对象是不合情理的。例如，动物作为一个基类可以派生出老虎、孔雀等子类，但动物本身生成对象明显不合常理。</p><p>为了解决上述问题，引入了纯虚函数的概念，即将函数定义为纯虚函数。编译器要求在派生类中必须重写纯虚函数以实现多态性。同时含有纯虚拟函数的类称为抽象类，它不能生成对象。这样就很好地解决了上述两个问题。声明了纯虚函数的类是一个抽象类，不能创建抽象类的实例，只能创建它的派生类的实例。</p><p>定义纯虚函数的目的在于，使派生类仅仅只是继承函数的接口。纯虚函数的意义在于，让所有的类对象(主要是派生类对象)都可以执行纯虚函数的动作，但类无法为纯虚函数提供一个合理的缺省实现。所以类的纯虚函数的声明就是在告诉子类的设计者：必须提供一个纯虚函数的实现，但不知道会怎样实现它。</p></div></details><details class=info><summary>C++如何阻止类被实例化？</summary><div><p><strong>将构造函数声明为私有</strong></p><ul><li>将类的构造函数声明为私有，这样外部代码就无法创建该类的实例</li><li>在类的实现文件中实现私有构造函数，使得只有类的成员函数和友元函数能够调用构造函数</li></ul><p><strong>将类定义为抽象类</strong></p><ul><li>可以通过声明一个或多个纯虚函数来定义抽象类，这样的类不能被实例化</li><li>当一个类包含至少一个纯虚函数时，它就变成了抽象类</li></ul></div></details><details class=info><summary>抽象类为什么不能被实例化？</summary><div><p>抽象类在<code>C++</code>中不能被实例化，这是由其设计和目的所决定的，即规定好的。抽象类通常用于定义一个框架，让其他类继承并提供具体实现。目的是为派生类提供一个通用的形式，而不是直接用来创建对象。</p></div></details><details class=info><summary>纯虚函数 (如何应用于接口继承和实现继承)？</summary><div><p><strong>应用于接口继承</strong></p><ul><li><p><strong>定义抽象类(接口)</strong> - 将基类中的函数声明为纯虚函数，例如</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">class</span> <span class="token class-name">AbstractShape</span> </pre></td></tr><tr><td data-num=2></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=4></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// 纯虚函数</span></pre></td></tr><tr><td data-num=5></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">double</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// 纯虚函数</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token comment">// 其他成员函数和数据成员...</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li><li><p><strong>派生类实现接口</strong> - 派生类继承自抽象类，并提供纯虚函数的具体实现</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Circle</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">AbstractShape</span></span> </pre></td></tr><tr><td data-num=2></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=4></td><td><pre>    <span class="token keyword">void</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token keyword">override</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=5></td><td><pre>        <span class="token comment">// 具体的绘制圆的实现...</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=7></td><td><pre></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">double</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token keyword">override</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=9></td><td><pre>        <span class="token comment">// 具体的计算圆的面积的实现...</span></pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=11></td><td><pre>    <span class="token comment">// 其他成员函数和数据成员...</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li></ul><p><strong>应用于实现继承</strong></p><ul><li><p><strong>定义带有默认实现的虚函数</strong> - 可以在抽象类中定义一些带有默认实现的虚函数，这些虚函数不是纯虚函数</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">class</span> <span class="token class-name">AbstractShape</span> </pre></td></tr><tr><td data-num=2></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=4></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=5></td><td><pre>        <span class="token comment">// 默认的绘制实现...</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=7></td><td><pre></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">double</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// 纯虚函数</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token comment">// 其他成员函数和数据成员...</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li><li><p><strong>派生类选择性重写虚函数</strong> - 派生类可以选择性地重写虚函数，也可以使用基类提供的默认实现</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Circle</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">AbstractShape</span></span> </pre></td></tr><tr><td data-num=2></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=4></td><td><pre>    <span class="token comment">// draw 函数使用基类提供的默认实现</span></pre></td></tr><tr><td data-num=5></td><td><pre>    <span class="token keyword">double</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token keyword">override</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre>        <span class="token comment">// 具体的计算圆的面积的实现...</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token comment">// 其他成员函数和数据成员...</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li></ul></div></details><h4 id=虚析构与纯虚析构><a class=anchor href=#虚析构与纯虚析构>#</a> 虚析构与纯虚析构</h4><p>虚析构函数是一个在基类中声明为虚函数的析构函数。使用虚析构函数的主要目的是在继承关系中确保正确的对象清理和释放。当基类的指针指向派生类对象时，通过虚析构函数，可以确保调用正确的析构函数，从而正确释放资源。</p><p>虚析构语法 - <code>virtual ~类名() &#123;&#125;</code></p><p>纯虚析构语法</p><ul><li>声明 - <code>virtual ~类名() = 0;</code></li><li>实现 - <code>类名::~类名() &#123;&#125;</code></li></ul><p>有了纯虚析构后，该类也称为抽象类，无法被实例化。</p><p>虚析构与纯虚析构都用来解决通过父类指针释放子类对象的问题，如果子类没有堆区数据，可以不写虚析构或纯虚析构。</p><figure class="highlight cpp"><figcaption data-lang=C++><span>虚析构与纯虚析构</span><span class=exturl data-url="aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWV0NDExYjczWi8/cD0xNDEmc3BtX2lkX2Zyb209cGFnZURyaXZlciZ2ZF9zb3VyY2U9MTg0NWFmNThkZTJkN2VlOWY4OGZkMmEzZWFmMjhkNGI=">案例</span></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string></span></span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=4></td><td><pre></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Animal</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Animal构造"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=9></td><td><pre>    </pre></td></tr><tr><td data-num=10></td><td><pre>    <span class="token comment">// 利用虚析构，可以使父类走子类的析构，使父类指针释放子类对象</span></pre></td></tr><tr><td data-num=11></td><td><pre>    <span class="token comment">// virtual ~Animal() &#123; cout &lt;&lt; "Animal析构" &lt;&lt; endl; &#125;</span></pre></td></tr><tr><td data-num=12></td><td><pre></pre></td></tr><tr><td data-num=13></td><td><pre>    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// 纯虚析构声明</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Animal Speak"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token comment">// 纯虚析构需要声明，也需要实现</span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token class-name">Animal</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Animal纯虚析构"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=19></td><td><pre></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Cat</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Animal</span></span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=23></td><td><pre>    string name<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre>    <span class="token function">Cat</span><span class="token punctuation">(</span>string x<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=25></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=26></td><td><pre>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Cat 构造"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=27></td><td><pre>        name <span class="token operator">=</span> x<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=28></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=29></td><td><pre>    <span class="token operator">~</span><span class="token function">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=30></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=31></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">!=</span> name<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=32></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=33></td><td><pre>            <span class="token keyword">delete</span> name<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=34></td><td><pre>            name <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=35></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=36></td><td><pre>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Cat 析构"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=37></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=38></td><td><pre>    </pre></td></tr><tr><td data-num=39></td><td><pre>    <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> cout <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> <span class="token string">"Cat Speak"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=40></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=41></td><td><pre></pre></td></tr><tr><td data-num=42></td><td><pre><span class="token keyword">void</span> <span class="token function">dospeak</span><span class="token punctuation">(</span>Animal<span class="token operator">&amp;</span> animal<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> animal<span class="token punctuation">.</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=43></td><td><pre></pre></td></tr><tr><td data-num=44></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=45></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=46></td><td><pre>    Animal<span class="token operator">*</span> cat <span class="token operator">=</span> <span class="token keyword">new</span> Cat<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=47></td><td><pre>    <span class="token function">dospeak</span><span class="token punctuation">(</span>cat<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=48></td><td><pre>    </pre></td></tr><tr><td data-num=49></td><td><pre>    <span class="token comment">// 父类指针在析构时，不会调用子类的析构函数</span></pre></td></tr><tr><td data-num=50></td><td><pre>    <span class="token keyword">delete</span> cat<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=51></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=52></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><details class=info><summary>为什么基类的析构函数需要定义为虚函数？</summary><div><p>为了实现动态绑定，基类指针指向派生类对象，如果析构函数不是虚函数，那么在对象销毁时，就会调用基类的析构函数，只能销毁派生类对象中的部分数据，所以必须将析构函数定义为虚函数，从而在对象销毁时，调用派生类的析构函数，从而销毁派生类对象中的所有数据。</p></div></details><details class=info><summary>为什么需要虚析构函数，什么时候不需要？(析构函数⼀般写成虚函数的原因？)</summary><div><p>一般情况下类的析构函数里面都是释放内存资源的操作，如果不调用析构函数的话就会造成内存泄漏。这样做是为了，当用一个基类的指针删除一个派生类的对象时，派生类的析构函数会被调用。当然，并不是要把所有类的析构函数都写成虚函数。因为当类里面有虚函数的时候，编译器会给类添加一个虚函数表，里面存放着虚函数表指针，这样会增加类的存储空间。所以，只有当一个类被用作基类的时候，才把析构函数写成虚函数。</p></div></details><details class=info><summary>内联函数，静态成员函数可以是虚函数吗？</summary><div><p>有<code>inline</code>, <code>static</code>, <code>constructor</code>这三种修饰的函数都不能带有virtual关键字。</p><ul><li>inline是编译时展开，必须有实体</li><li>static属于class自己的，也必须有实体</li><li>virtual函数基于虚函数表(内存空间)，constructor函数如果是virtual的，调用时也需要根据虚函数表来寻找，但是constructor是virtual的情况下是找不到的，因为constructor自己本身都不存在了，创建不到class的实例，没有实例，class的成员(除了public static/protected static for friend class/functions，其余无论是否virtual)都不能被访问了</li></ul><p>虚函数实际上是不能被内联的，虚函数运行时所需的代价主要是虚函数不能是内联函数。这是因为内联函数是指在编译期间用被调用的函数体本身来代替函数调用的指令，但是虚函数的<code>虚</code>是指<strong>直到运行时才能知道要调用的是哪一个函数</strong>。但虚函数的运行时多态特性就是要在运行时才知道具体调用哪个虚函数，所以没法在编译时进行内联函数展开。当然如果通过对象直接调用虚函数它是可以被内联，但是大多数虚函数是通过对象的指针或引用来被调用的，这种调用是不能被内联的。因为这种调用是标准的调用方式，所以虚函数实际上是不能被内联的</p><p>静态成员是属于整个类的，不是对某一个对象而言，同时静态函数的指针存放也不同于一般的成员函数，其无法成为一个对象的虚函数的指针以实现由此带来的动态机制。</p></div></details><details class=info><summary>如何实现一个string类？</summary><div><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">class</span> <span class="token class-name">String</span> </pre></td></tr><tr><td data-num=2></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=4></td><td><pre>	<span class="token keyword">char</span> <span class="token operator">*</span>m_data<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>str <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword">const</span> String <span class="token operator">&amp;</span>other<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token operator">~</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre>    String<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> String <span class="token operator">&amp;</span>other<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=11></td><td><pre></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token class-name">String</span><span class="token double-colon punctuation">::</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=13></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=15></td><td><pre>        m_data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token char">'\0'</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre>    <span class="token keyword">else</span> </pre></td></tr><tr><td data-num=17></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=18></td><td><pre>        <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre>        m_data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>length<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=20></td><td><pre>        <span class="token function">strcpy</span><span class="token punctuation">(</span>m_data<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=21></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=23></td><td><pre></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token class-name">String</span><span class="token double-colon punctuation">::</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword">const</span> String <span class="token operator">&amp;</span>other<span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=25></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=26></td><td><pre>    <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>m_data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=27></td><td><pre>    m_data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>length<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=28></td><td><pre>    <span class="token comment">// 此处可以访问private成员，是因为此处还算是在类内，只要是在类内就可以访问类成员</span></pre></td></tr><tr><td data-num=29></td><td><pre>    <span class="token function">strcpy</span><span class="token punctuation">(</span>m_data<span class="token punctuation">,</span> other<span class="token punctuation">.</span>m_data<span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num=30></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=31></td><td><pre></pre></td></tr><tr><td data-num=32></td><td><pre><span class="token class-name">String</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=33></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=34></td><td><pre>    <span class="token keyword">delete</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> m_data<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=36></td><td><pre></pre></td></tr><tr><td data-num=37></td><td><pre>String <span class="token operator">&amp;</span> String<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span> <span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> String <span class="token operator">&amp;</span>other<span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=38></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=39></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> <span class="token operator">&amp;</span>other<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span><span class="token comment">// 检查自赋值</span></pre></td></tr><tr><td data-num=40></td><td><pre>    <span class="token keyword">delete</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> m_data<span class="token punctuation">;</span><span class="token comment">// 释放原来的内存</span></pre></td></tr><tr><td data-num=41></td><td><pre>    <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>m_data<span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num=42></td><td><pre>    m_data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span>length<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=43></td><td><pre>    <span class="token function">strcpy</span><span class="token punctuation">(</span>m_data<span class="token punctuation">,</span> other<span class="token punctuation">.</span>m_data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=44></td><td><pre>    </pre></td></tr><tr><td data-num=45></td><td><pre>    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=46></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></div></details><details class=info><summary>如何构造一个类，使得只能在堆上或只能在栈上分配内存？</summary><div><ul><li><p>只能在堆上分配内存 - 将析构函数声明设为<code>private</code>。</p><ul><li><code>C++</code>是静态绑定语言，编译器管理栈上对象的生命周期，编译器在为类对象分配栈空间时，会先检查类的析构函数的访问性。若析构函数不可访问，则不能在栈上创建对象</li></ul></li><li><p>只能在栈上生成对象 - 将<code>new</code>和<code>delete</code>重载设为<code>private</code></p><ul><li>在堆上生成对象，使用new关键词操作，其过程分为两阶段。第一阶段，使用new在堆上寻找可用内存，分配给对象；第二阶段，调用构造函数生成对象。将new操作设置为私有，那么第一阶段就无法完成，就不能够在堆上生成对象</li></ul></li></ul></div></details><h4 id=运行时类型信息rtti><a class=anchor href=#运行时类型信息rtti>#</a> 运行时类型信息(RTTI)</h4><p><strong>dynamic_cast</strong></p><ul><li>语法 - <code>派生类指针 = dynamic_cast&lt;派生类类型 *&gt;(基类指针)</code></li><li>可以将派生类指针转换为基类指针</li><li>可用于判断是否可以安全地将对象的地址赋值给特定类型的指针</li><li>转换失败返回空指针</li></ul><p><strong>typeid运算符</strong></p><ul><li><code>typeid</code>运算符语法 - <code>typeid(数据类型或变量名或表达式)</code></li><li><code>typeid</code>运算符可以用于多态的场景</li><li><code>typeid</code>运算符返回<code>type_info</code>类(在头文件<code>&lt;typeinfo&gt;</code>中定义)的对象的引用</li></ul><p><strong>type_info类</strong></p><ul><li><p>需包含头文件<code>#include&lt;typeinfo&gt;</code></p></li><li><p><code>type_info</code>类描述编译器在程序中生成的类型信息。 此类的对象可以有效存储指向类型的名称的指针</p></li><li><p><code>type_info</code>类还可存储适合比较两个类型是否相等或比较其排列顺序的编码值。 类型的编码规则和排列顺序是未指定的，并且可能因程序而异</p></li><li><p><code>type_info</code>重载了==和!=运算符，用于对类型进行比较</p></li></ul><details class=info><summary>C++的RTTI机制是什么?</summary><div><p><code>C++</code>中的RTTI(Run-Time Type Information)是一种允许在运行时查询对象类型信息的机制。RTTI提供了两个主要的操作符<code>typeid</code>和<code>dynamic_cast</code>，这些操作符允许程序在运行时获取有关对象类型的信息，并在需要时进行类型安全的转换。</p><ul><li><p><code>typeid</code>运算符 - 用于获取表达式的类型信息。它返回一个 <code>std::type_info</code> 对象，这个对象包含有关表达式类型的信息</p><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;typeinfo></span></span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Base</span> </pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Derived</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=11></td><td><pre></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=13></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=14></td><td><pre>    Base<span class="token operator">*</span> basePtr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Derived</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre></pre></td></tr><tr><td data-num=16></td><td><pre>    <span class="token comment">// typeid for polymorphic types</span></pre></td></tr><tr><td data-num=17></td><td><pre>    <span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>type_info<span class="token operator">&amp;</span> typeInfo <span class="token operator">=</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span><span class="token operator">*</span>basePtr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=18></td><td><pre></pre></td></tr><tr><td data-num=19></td><td><pre>    <span class="token comment">// Compare type information</span></pre></td></tr><tr><td data-num=20></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>typeInfo <span class="token operator">==</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>Base<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=21></td><td><pre>        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Object is of type Base"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=22></td><td><pre>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>typeInfo <span class="token operator">==</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>Derived<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=23></td><td><pre>        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Object is of type Derived"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=25></td><td><pre></pre></td></tr><tr><td data-num=26></td><td><pre>    <span class="token keyword">delete</span> basePtr<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=27></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li><li><p><code>dynamic_cast</code>运算符 - 用于在继承层次中进行安全的向下转型(downcasting)或在多态类之间进行安全的转换</p><ul><li><code>dynamic_cast</code>在运行时检查对象的类型信息，并在安全的情况下进行转换。如果转换失败，它返回 <code>nullptr</code>(对于指针类型)或抛出 <code>std::bad_cast</code> 异常(对于引用类型)</li></ul><figure class="highlight cpp"><figcaption data-lang=C++></figcaption><table><tr><td data-num=1></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span></pre></td></tr><tr><td data-num=2></td><td><pre></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Base</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num=5></td><td><pre>    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Derived</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num=11></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=12></td><td><pre>    Base<span class="token operator">*</span> basePtr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Derived</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token comment">// dynamic_cast for polymorphic types</span></pre></td></tr><tr><td data-num=15></td><td><pre>    Derived<span class="token operator">*</span> derivedPtr <span class="token operator">=</span> <span class="token generic-function"><span class="token function">dynamic_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>Derived<span class="token operator">*</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>basePtr<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre></pre></td></tr><tr><td data-num=17></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>derivedPtr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=18></td><td><pre>        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Dynamic cast successful"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num=20></td><td><pre>        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Dynamic cast failed"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=21></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num=22></td><td><pre></pre></td></tr><tr><td data-num=23></td><td><pre>    <span class="token keyword">delete</span> basePtr<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li></ul><p><code>typeid</code>和<code>dynamic_cast</code>只对包含虚函数的类进行有效。</p><p>对于<code>dynamic_cast</code>，源类型和目标类型至少有一个是多态类型(即包含虚函数)。</p><p><code>typeid</code>和<code>dynamic_cast</code>通常与多态(虚函数)结合使用，以在运行时进行类型安全的操作。</p><p>RTTI的使用应该被谨慎，因为过多地依赖RTTI可能表明设计上存在缺陷。在一些情况下，使用虚函数和面向对象的设计可能更好。</p></div></details><div class=tags><a href=/tags/programming-language/ rel=tag><i class="ic i-tag"></i> 编程语言</a></div></div><footer><div class=meta><span class=item><span class=icon><i class="ic i-calendar-check"></i></span> <span class=text>更新于</span> <time title="修改时间：2025-01-09 17:58:14" itemprop=dateModified datetime=2025-01-09T17:58:14+08:00>2025-01-09</time></span><span class=item data-path=/computer-science/programming/c-language/basis/c++/cpppart1/ title=阅读次数><span class=icon><i class="ic i-eye"></i></span> <span class=text>阅读次数</span><span class=waline-pageview-count></span> <span class=text>次</span></span></div><div id=copyright><ul><li class=author><strong>本文作者：</strong> ReverseSacle <i class="ic i-at"><em>@</em></i>逆转天平</li><li class=link><strong>本文链接：</strong> <a href=https://www.reversesacle.com/computer-science/programming/c-language/basis/c++/cpppart1/ title=C++基础知识-第一部分-C++98&#x2F;03标准>https://www.reversesacle.com/computer-science/programming/c-language/basis/c++/cpppart1/</a></li><li class=license><strong>版权声明：</strong> 本站所有文章除特别声明外，均采用 <span class=exturl data-url=aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class=post-nav><div class="item left"><a href=/computer-science/programming/c-language/basis/c/cpart3/ itemprop=url rel=prev data-background-image=https:&#x2F;&#x2F;resa-imgs.oss-accelerate.aliyuncs.com&#x2F;img&#x2F;acg18.webp title=C语言基础-第三部分-C99标准><span class=type>上一篇</span><span class=category><i class="ic i-flag"></i> C语言基础</span><h3>C语言基础-第三部分-C99标准</h3></a></div><div class="item right"><a href=/computer-science/programming/c-language/basis/c++/cpppart2/ itemprop=url rel=next data-background-image=https:&#x2F;&#x2F;resa-imgs.oss-accelerate.aliyuncs.com&#x2F;img&#x2F;acg21.webp title=C++基础知识-第二部分-C++98&#x2F;03标准><span class=type>下一篇</span><span class=category><i class="ic i-flag"></i> C++基础</span><h3>C++基础知识-第二部分-C++98/03标准</h3></a></div></div><div class=wrap id=comments><div id=waline-comment></div></div></div><div id=sidebar><div class=inner><div class=panels><div class=inner><div class="contents panel pjax" data-title=文章目录><ol class=toc><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%A6%82%E8%BF%B0><span class=toc-number>1.</span> <span class=toc-text>概述</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%88%9D%E5%A7%8B%E5%8C%96%E8%B5%8B%E5%80%BC><span class=toc-number>2.</span> <span class=toc-text>初始化赋值</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E7%9B%B8%E5%85%B3%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C><span class=toc-number>3.</span> <span class=toc-text>相关输入&#x2F;输出基本操作</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B><span class=toc-number>4.</span> <span class=toc-text>数据类型</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%87%BD%E6%95%B0><span class=toc-number>5.</span> <span class=toc-text>函数</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E9%BB%98%E8%AE%A4%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0><span class=toc-number>5.1.</span> <span class=toc-text>默认函数参数</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%8D%A0%E4%BD%8D%E5%8F%82%E6%95%B0><span class=toc-number>5.2.</span> <span class=toc-text>占位参数</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD><span class=toc-number>5.3.</span> <span class=toc-text>函数重载</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%93%8D%E4%BD%9C><span class=toc-number>6.</span> <span class=toc-text>内存管理操作</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%B7%A6%E5%80%BC%E5%BC%95%E7%94%A8%E5%88%AB%E5%90%8D><span class=toc-number>7.</span> <span class=toc-text>左值引用(别名)</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%88%9D%E5%A7%8B%E5%8C%96><span class=toc-number>7.1.</span> <span class=toc-text>初始化</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%BC%95%E7%94%A8%E4%BD%9C%E4%B8%BA%E5%8F%82%E6%95%B0><span class=toc-number>7.2.</span> <span class=toc-text>引用作为参数</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%BC%95%E7%94%A8%E4%BD%9C%E8%BF%94%E5%9B%9E%E5%80%BC><span class=toc-number>7.3.</span> <span class=toc-text>引用作返回值</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#const%E4%BF%AE%E9%A5%B0%E7%9A%84%E5%B8%B8%E9%87%8F%E5%BC%95%E7%94%A8><span class=toc-number>7.4.</span> <span class=toc-text>const修饰的常量引用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E7%B1%BB%E5%92%8C%E5%AF%B9%E8%B1%A1><span class=toc-number>8.</span> <span class=toc-text>类和对象</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%A6%82%E8%BF%B0-2><span class=toc-number>8.1.</span> <span class=toc-text>概述</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%B0%81%E8%A3%85encapsulation><span class=toc-number>8.2.</span> <span class=toc-text>封装(Encapsulation)</span></a><ol class=toc-child><li class="toc-item toc-level-4"><a class=toc-link href=#%E8%AE%BF%E9%97%AE%E6%9D%83%E9%99%90><span class=toc-number>8.2.1.</span> <span class=toc-text>访问权限</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E4%B8%8E%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0><span class=toc-number>8.2.2.</span> <span class=toc-text>构造函数与析构函数</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E6%B5%85%E6%8B%B7%E8%B4%9Dshallow-copy%E4%B8%8E%E6%B7%B1%E6%8B%B7%E8%B4%9Ddeep-copy><span class=toc-number>8.2.3.</span> <span class=toc-text>浅拷贝(Shallow Copy)与深拷贝(Deep Copy)</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E5%88%9D%E5%A7%8B%E5%8C%96%E5%88%97%E8%A1%A8><span class=toc-number>8.2.4.</span> <span class=toc-text>初始化列表</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E7%B1%BB%E4%BD%9C%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98><span class=toc-number>8.2.5.</span> <span class=toc-text>类作类的成员</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#static%E9%9D%99%E6%80%81%E6%88%90%E5%91%98><span class=toc-number>8.2.6.</span> <span class=toc-text>static静态成员</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F%E4%B8%8E%E5%87%BD%E6%95%B0%E7%9A%84%E5%88%86%E5%BC%80%E5%AD%98%E5%82%A8><span class=toc-number>8.2.7.</span> <span class=toc-text>成员变量与函数的分开存储</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#this%E6%8C%87%E9%92%88><span class=toc-number>8.2.8.</span> <span class=toc-text>this指针</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E7%A9%BA%E6%8C%87%E9%92%88%E8%B0%83%E7%94%A8%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0><span class=toc-number>8.2.9.</span> <span class=toc-text>空指针调用成员函数</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#const%E4%BF%AE%E9%A5%B0%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0><span class=toc-number>8.2.10.</span> <span class=toc-text>const修饰成员函数</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E5%8F%8B%E5%85%83><span class=toc-number>8.2.11.</span> <span class=toc-text>友元</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E8%BF%90%E7%AE%97%E7%AC%A6%E9%87%8D%E8%BD%BD><span class=toc-number>8.2.12.</span> <span class=toc-text>运算符重载</span></a></li></ol></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E7%BB%A7%E6%89%BFinheritance><span class=toc-number>8.3.</span> <span class=toc-text>继承(Inheritance)</span></a><ol class=toc-child><li class="toc-item toc-level-4"><a class=toc-link href=#%E7%BB%A7%E6%89%BF%E6%96%B9%E5%BC%8F><span class=toc-number>8.3.1.</span> <span class=toc-text>继承方式</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E7%BB%A7%E6%89%BF%E7%9A%84%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B><span class=toc-number>8.3.2.</span> <span class=toc-text>继承的对象模型</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E5%90%8C%E5%90%8D%E6%88%90%E5%91%98%E7%9A%84%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F><span class=toc-number>8.3.3.</span> <span class=toc-text>同名成员的处理方式</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E5%90%8C%E5%90%8D%E9%9D%99%E6%80%81%E6%88%90%E5%91%98%E7%9A%84%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F><span class=toc-number>8.3.4.</span> <span class=toc-text>同名静态成员的处理方式</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E5%A4%9A%E7%BB%A7%E6%89%BF%E8%AF%AD%E6%B3%95><span class=toc-number>8.3.5.</span> <span class=toc-text>多继承语法</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E8%8F%B1%E5%BD%A2%E9%92%BB%E7%9F%B3%E7%BB%A7%E6%89%BFdiamond-problem%E4%B8%8E%E8%99%9A%E7%BB%A7%E6%89%BF><span class=toc-number>8.3.6.</span> <span class=toc-text>菱形&#x2F;钻石继承(Diamond Problem)与虚继承</span></a></li></ol></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%A4%9A%E6%80%81polymorphism><span class=toc-number>8.4.</span> <span class=toc-text>多态(Polymorphism)</span></a><ol class=toc-child><li class="toc-item toc-level-4"><a class=toc-link href=#%E5%8A%A8%E6%80%81%E5%A4%9A%E6%80%81%E8%99%9A%E5%87%BD%E6%95%B0><span class=toc-number>8.4.1.</span> <span class=toc-text>动态多态(虚函数)</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E7%BA%AF%E8%99%9A%E5%87%BD%E6%95%B0%E4%B8%8E%E6%8A%BD%E8%B1%A1%E7%B1%BB><span class=toc-number>8.4.2.</span> <span class=toc-text>纯虚函数与抽象类</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E8%99%9A%E6%9E%90%E6%9E%84%E4%B8%8E%E7%BA%AF%E8%99%9A%E6%9E%90%E6%9E%84><span class=toc-number>8.4.3.</span> <span class=toc-text>虚析构与纯虚析构</span></a></li><li class="toc-item toc-level-4"><a class=toc-link href=#%E8%BF%90%E8%A1%8C%E6%97%B6%E7%B1%BB%E5%9E%8B%E4%BF%A1%E6%81%AFrtti><span class=toc-number>8.4.4.</span> <span class=toc-text>运行时类型信息(RTTI)</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title=系列文章><ul><li class=active><a href=/computer-science/programming/c-language/basis/c++/cpppart1/ rel=bookmark title=C++基础知识-第一部分-C++98/03标准>C++基础知识-第一部分-C++98/03标准</a></li><li><a href=/computer-science/programming/c-language/basis/c++/cpppart2/ rel=bookmark title=C++基础知识-第二部分-C++98/03标准>C++基础知识-第二部分-C++98/03标准</a></li><li><a href=/computer-science/programming/c-language/basis/c++/cpppart3/ rel=bookmark title=C++基础知识-第三部分-C++11标准>C++基础知识-第三部分-C++11标准</a></li></ul></div><div class="overview panel" data-title=站点概览><div class=author itemprop=author itemscope itemtype=http://schema.org/Person><img class=image itemprop=image alt=ReverseSacle data-src=/images/avatar.webp><p class=name itemprop=name>ReverseSacle</p><div class=description itemprop=description>知识书库 & 学习点滴</div></div><nav class=state><div class="item posts"><a href=/archives/ ><span class=count>186</span> <span class=name>文章</span></a></div><div class="item categories"><a href=/categories/ ><span class=count>52</span> <span class=name>分类</span></a></div><div class="item tags"><a href=/tags/ ><span class=count>18</span> <span class=name>标签</span></a></div></nav><div class=social><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL1JldmVyc2VTYWNsZQ==" title=https:&#x2F;&#x2F;github.com&#x2F;ReverseSacle><i class="ic i-github"></i></span><span class="exturl item email" data-url="bWFpbHRvOnByaXZhdGVAcmV2ZXJzZXNhY2xlLmNvbQ==" title=mailto:private@reversesacle.com><i class="ic i-envelope"></i></span></div><ul class=menu><li class=item><a href=/ rel=section><i class="ic i-home"></i> 首页</a></li><li class="item dropdown"><a href=javascript:void(0);><i class="ic i-feather"></i> 文章</a><ul class=submenu><li class=item><a href=/archives/ rel=section><i class="ic i-list-alt"></i> 归档</a></li><li class=item><a href=/categories/ rel=section><i class="ic i-th"></i> 分类</a></li><li class=item><a href=/tags/ rel=section><i class="ic i-tags"></i> 标签</a></li></ul></li><li class=item><a href=/about/ rel=section><i class="ic i-user"></i> 关于</a></li><li class=item><a href=/friend-links/ rel=section><i class="ic i-heart"></i> 友链</a></li></ul></div></div></div><ul id=quick><li class="prev pjax"><a href=/computer-science/programming/c-language/basis/c/cpart3/ rel=prev title=上一篇><i class="ic i-chevron-left"></i></a></li><li class=up><i class="ic i-arrow-up"></i></li><li class=down><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href=/computer-science/programming/c-language/basis/c++/cpppart2/ rel=next title=下一篇><i class="ic i-chevron-right"></i></a></li><li class=percent></li></ul></div></div><div class=dimmer></div></div></main><footer id=footer><div class=inner><div class=widgets><div class="rpost pjax"><h2>随机文章</h2><ul><li class=item><div class=breadcrumb><a href=/categories/computer-science/ title="分类于 计算机科学">计算机科学</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/ title="分类于 编程">编程</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/c-language/ title="分类于 C语言">C语言</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/c-language/c-algorithm/ title="分类于 C版算法">C版算法</a></div><span><a href=/computer-science/programming/c-language/c-algorithm/dynamic-program/ title=动态规划&#x2F;状态转移>动态规划/状态转移</a></span></li><li class=item><div class=breadcrumb><a href=/categories/computer-science/ title="分类于 计算机科学">计算机科学</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/ title="分类于 编程">编程</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/database/ title="分类于 数据库">数据库</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/database/mysql/ title="分类于 MySQL">MySQL</a></div><span><a href=/computer-science/programming/database/mysql/mspart2/ title=MySQL数据库基础-第二部分>MySQL数据库基础-第二部分</a></span></li><li class=item><div class=breadcrumb><a href=/categories/computer-science/ title="分类于 计算机科学">计算机科学</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/ title="分类于 编程">编程</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/c-language/ title="分类于 C语言">C语言</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/c-language/stack/ title="分类于 栈">栈</a></div><span><a href=/computer-science/programming/c-language/c-algorithm/stack/trick/ title=栈基础技巧>栈基础技巧</a></span></li><li class=item><div class=breadcrumb><a href=/categories/computer-science/ title="分类于 计算机科学">计算机科学</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/ title="分类于 编程">编程</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/c-language/ title="分类于 C语言">C语言</a></div><span><a href=/computer-science/programming/c-language/c-data-structure/linear-structure/dynamic-seqstring/ title=C语言-字符动态结构存储>C语言-字符动态结构存储</a></span></li><li class=item><div class=breadcrumb><a href=/categories/computer-science/ title="分类于 计算机科学">计算机科学</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/ title="分类于 编程">编程</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/network-programming/ title="分类于 网络编程">网络编程</a></div><span><a href=/computer-science/programming/network-programming/gcc-compiler/ title=GCC编译器>GCC编译器</a></span></li><li class=item><div class=breadcrumb><a href=/categories/computer-science/ title="分类于 计算机科学">计算机科学</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/ title="分类于 编程">编程</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/python/ title="分类于 Python">Python</a></div><span><a href=/computer-science/programming/python/flask-basic/ title=Python后端框架Flask基础>Python后端框架Flask基础</a></span></li><li class=item><div class=breadcrumb><a href=/categories/computer-science/ title="分类于 计算机科学">计算机科学</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/ title="分类于 编程">编程</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/c-language/ title="分类于 C语言">C语言</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/c-language/binary-tree/ title="分类于 二叉树">二叉树</a></div><span><a href=/computer-science/programming/c-language/c-algorithm/binary-tree/traversal/ title=二叉树-遍历>二叉树-遍历</a></span></li><li class=item><div class=breadcrumb><a href=/categories/computer-science/ title="分类于 计算机科学">计算机科学</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/ title="分类于 编程">编程</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/rust/ title="分类于 Rust">Rust</a></div><span><a href=/computer-science/programming/rust/rust-data-structure/linear-structure/hash-table/ title=Rust-哈希表>Rust-哈希表</a></span></li><li class=item><div class=breadcrumb><a href=/categories/potpourri/ title="分类于 百味">百味</a><i class="ic i-angle-right"></i> <a href=/categories/potpourri/foreign-language/ title="分类于 外语">外语</a></div><span><a href=/potpourri/foreign-language/advanced-learning/ title=英语进阶学习材料>英语进阶学习材料</a></span></li><li class=item><div class=breadcrumb><a href=/categories/computer-science/ title="分类于 计算机科学">计算机科学</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/computer-basic/ title="分类于 计算机基础">计算机基础</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/computer-basic/computer-composition-principles/ title="分类于 计算机组成原理">计算机组成原理</a></div><span><a href=/computer-science/computer-basic/composition/ccppart1/ title=计算机组成原理-CSAPP-第一部分>计算机组成原理-CSAPP-第一部分</a></span></li></ul></div><div><h2>最新评论</h2><ul id=waline-recent></ul></div></div><div class=status><div class=copyright>&copy; 2021 – <span itemprop=copyrightYear>2025</span><span class=with-love><i class="ic i-sakura rotate"></i></span> <span class=author itemprop=copyrightHolder>ReverseSacle @ ReverseSacle-Blog</span></div><div class=count><i class="ic i-clock" aria-hidden=true></i> <span id=time align=center>载入时间中...<script defer>var now=new Date;function createtime(){var n=new Date("2021-11-16 22:30:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("time").innerHTML="已经过 "+dnum+" 天 "+hnum+" 小时 "+mnum+" 分 "+snum+" 秒 "}setInterval("createtime()",250)</script></span><span class=post-meta-item-icon>|&nbsp<i class="ic i-chart-area"></i></span> <span title=站点总字数>2.1m 字</span> <span class=post-meta-item-icon>|&nbsp<i class="ic i-coffee"></i></span> <span title=站点阅读时长>40:40</span></div></div></div></footer></div><script data-config>var LOCAL={path:"computer-science/programming/c-language/basis/c++/cpppart1/",favicon:{show:"ReverseSacle-Blog",hide:"ReverseSacle-Blog"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},waline:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src=https://polyfill.alicdn.com/v3/polyfill.min.js></script><script src=https://jd.reversesacle.com/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1.16.0/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js></script><script src=/js/app.js></script></body></html>