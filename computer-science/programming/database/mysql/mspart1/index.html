<!DOCTYPE html><html lang=zh-CN><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content=#222><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=icon type=image/ico sizes=48x48 href=/images/favicon.ico><link rel=alternate type=application/rss+xml title=逆转天平 href=https://www.reversesacle.com/rss.xml><link rel=alternate type=application/atom+xml title=逆转天平 href=https://www.reversesacle.com/atom.xml><link rel=alternate type=application/json title=逆转天平 href=https://www.reversesacle.com/feed.json><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel=stylesheet href=/css/app.css><meta name=description content=数据库><link rel=canonical href=https://www.reversesacle.com/computer-science/programming/database/mysql/mspart1/ ><title>MySQL数据库基础-第一部分 - MySQL - 数据库 - 编程 - 计算机科学 | ReverseSacle-Blog</title><meta name=generator content="Hexo 6.3.0"></head><body itemscope itemtype=http://schema.org/WebPage><div id=loading><div class=dotloader><div class=dot></div><div class=dot></div><div class=dot></div><div class=dot></div><div class=dot></div></div></div><div id=container><header id=header itemscope itemtype=http://schema.org/WPHeader><div class=inner><div id=brand><div class=pjax><h1 itemprop="name headline">MySQL数据库基础-第一部分</h1><div class=meta><span class=item title="创建时间：2023-08-18 15:45:12"><span class=icon><i class="ic i-calendar"></i></span> <span class=text>发表于</span> <time itemprop="dateCreated datePublished" datetime=2023-08-18T15:45:12+08:00>2023-08-18</time></span><span class=item title=本文字数><span class=icon><i class="ic i-pen"></i></span> <span class=text>本文字数</span> <span>69k</span> <span class=text>字</span></span><span class=item title=阅读时长><span class=icon><i class="ic i-clock"></i></span> <span class=text>阅读时长</span> <span>1:21</span></span></div></div></div><nav id=nav><div class=inner><div class=toggle><div class=lines role=navigation aria-label=切换导航栏><span class=line></span><span class=line></span><span class=line></span></div></div><ul class=menu><li class="item title"><a href=/ rel=start>ReverseSacle-Blog</a></li></ul><ul class=right><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id=imgs class=pjax><ul><li class=item data-background-image=https://resa-imgs.oss-accelerate.aliyuncs.com/img/acg21.webp></li><li class=item data-background-image=https://resa-imgs.oss-accelerate.aliyuncs.com/img/acg19.webp></li><li class=item data-background-image=https://resa-imgs.oss-accelerate.aliyuncs.com/img/acg16.webp></li><li class=item data-background-image=https://resa-imgs.oss-accelerate.aliyuncs.com/img/acg11.webp></li><li class=item data-background-image=https://resa-imgs.oss-accelerate.aliyuncs.com/img/acg15.webp></li><li class=item data-background-image=https://resa-imgs.oss-accelerate.aliyuncs.com/img/acg8.webp></li></ul></div></header><div id=waves><svg class=waves xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink viewBox="0 24 150 28" preserveAspectRatio=none shape-rendering=auto><defs><path id=gentle-wave d="M-160 44c30 0 58-18 88-18s58 18 88 18 58-18 88-18 58 18 88 18v44h-352z"/></defs><g class=parallax><use xlink:href=#gentle-wave x=48 y=0 /><use xlink:href=#gentle-wave x=48 y=3 /><use xlink:href=#gentle-wave x=48 y=5 /><use xlink:href=#gentle-wave x=48 y=7 /></g></svg></div><main><div class=inner><div id=main class=pjax><div class="article wrap"><div class=breadcrumb itemscope itemtype=https://schema.org/BreadcrumbList><i class="ic i-home"></i> <span><a href=/ >首页</a></span><i class="ic i-angle-right"></i> <span itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=/categories/computer-science/ itemprop=item rel=index title="分类于 计算机科学"><span itemprop=name>计算机科学</span></a><meta itemprop=position content=1></span><i class="ic i-angle-right"></i> <span itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=/categories/computer-science/programming/ itemprop=item rel=index title="分类于 编程"><span itemprop=name>编程</span></a><meta itemprop=position content=2></span><i class="ic i-angle-right"></i> <span itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=/categories/computer-science/programming/database/ itemprop=item rel=index title="分类于 数据库"><span itemprop=name>数据库</span></a><meta itemprop=position content=3></span><i class="ic i-angle-right"></i> <span class=current itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a href=/categories/computer-science/programming/database/mysql/ itemprop=item rel=index title="分类于 MySQL"><span itemprop=name>MySQL</span></a><meta itemprop=position content=4></span></div><article itemscope itemtype=http://schema.org/Article class="post block" lang=zh-CN><link itemprop=mainEntityOfPage href=https://www.reversesacle.com/computer-science/programming/database/mysql/mspart1/ ><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content=/images/avatar.webp><meta itemprop=name content=ReverseSacle><meta itemprop=description content="所见即所得，所思即所行, 知识书库 & 学习点滴"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content=逆转天平></span><div class="body md" itemprop=articleBody><h2 id=概述><a class=anchor href=#概述>#</a> !概述</h2><p>MySQL是一个<strong>开放源代码</strong>的关系型数据库管理系统，由瑞典MySQL AB(创始人Michael Widenius)公司1995年开发。2008被Sun收购，2009年Sun被Oracle收购，MariaDB应运而生。</p><p>MySQL6.x版本之后分为社区版和商业版。</p><p>MySQL是一种关联数据库管理系统，将数据保存在不同的表中，而不是将所有数据放在一个大仓库内，这样就增加了速度并提高了灵活性。</p><p>MySQL是可以定制的，采用了<code>GPL (GNU General Public License)</code>协议，可以修改源代码来开发自己的MySQL系统。</p><p>MySQL使用标准的SQL数据语言形式，支持大型的数据库，是可以处理拥有上千万条记录的大型数据库，支持5000万条记录的数据仓库，32位系统表文件最大可支持4GB，64位系统支持最大的表文件为8TB。</p><p>MySQL可以允许运行于多个系统上，并且支持多种语言。这些编程语言包括C, C++, Python, Java, Perl, PHP和Ruby等。</p><p>MySQL从5.7版本直接跳跃发布了8.0版本，对于MySQL8版本，开发者对MySQL的源代码进行了重构。</p><p>Oracle更适合大型跨国企业的使用，因为各企业对性能要求以及安全性有更高的要求。</p><p>MySQL其体积小，速度快，成本低，可以处理上前万条记录的大型数据库，并且开源。</p><p><strong>什么是MySQL？</strong></p><p>MySQL是一种关系型数据库，主要用于持久化存储我们的系统中的一些数据比如用户信息。</p><p>由于 MySQL 是开源免费并且比较成熟的数据库，因此，MySQL 被大量使用在各种系统中。任何人都可以在GPL(General Public License) 的许可下下载并根据个性化的需要对其进行修改。MySQL 的默认端口号是<strong>3306</strong>。</p><p><strong>MySQL有什么优点？</strong></p><ul><li><p>成熟稳定，功能完善</p></li><li><p>开源免费</p></li><li><p>文档丰富，既有详细的官方文档，又有非常多优质文章可供参考学习</p></li><li><p>开箱即用，操作简单，维护成本低</p></li><li><p>兼容性好，支持常见的操作系统，支持多种开发语言</p></li><li><p>社区活跃，生态完善</p></li><li><p>事务支持优秀， InnoDB 存储引擎默认使用 REPEATABLE-READ 并不会有任何性能损失，并且，InnoDB 实现的 REPEATABLE-READ 隔离级别其实是可以解决幻读问题发生的</p></li><li><p>支持分库分表、读写分离、高可用</p></li></ul><h2 id=关系型数据库relational-database-rdb><a class=anchor href=#关系型数据库relational-database-rdb>#</a> !关系型数据库(Relational Database - RDB)</h2><p>关系型数据库模型是把复杂的数据结构归结为简单的<code>二元关系</code>(二维表格形式)。</p><p>关系型数据库以<code>行(row)</code>和<code>列(column)</code>的形式存储数据，行和列被称为<code>表</code>，一组表组成了一个库(database)。</p><p>表与表之间的数据记录有关系(relationship)。现实世界中的各种实体以及实体之间的各种联系均用关系模型来表示。关系型数据库，就是建立在关系模式基础上的数据库。</p><p>SQL就是关系型数据库的查询语言。</p><p>关系型数据库可以用SQL语句方便的在一个表以及多个表之间做非常复杂的数据查询；可以使得对于安全性能很高的数据访问的要求得以实现。</p><p><strong>什么是关系型数据库？</strong></p><p>顾名思义，关系型数据库就是一种建立在关系模型的基础上的数据库。</p><p>关系模型表明了数据库中所存储的数据之间的联系(一对一、一对多、多对多)。</p><p>关系型数据库中，我们的数据都被存放在了各种表中(比如用户表)，表中的每一行就存放着一条数据(比如一个用户的信息)。</p><p><strong>有哪些常见的关系型数据库呢？</strong></p><p>MySQL、PostgreSQL、Oracle、SQL Server、SQLite(微信本地的聊天记录的存储就是用的SQLite)</p><h2 id=非关系型数据库非rdb><a class=anchor href=#非关系型数据库非rdb>#</a> 非关系型数据库(非RDB)</h2><p>非关系型数据库可以看成传统关系数据库的功能的阉割版本，基于键值对存储数据，不需要经过SQL层的解析，性能非常高。</p><p><strong>非关系型数据库有</strong></p><ul><li>键值型数据库</li><li>文档型数据库</li><li>搜索引擎数据库</li><li>列式数据库</li><li>图形数据库</li></ul><p><strong>关系型数据库设计规则</strong></p><p>关系型数据库的典型数据结构就是实际表，这些数据表的组成都是结构化的(Structured)。</p><p>将数据放到表中，表再放到库中。</p><p>一个数据库中可以有多个表，每个表都有一个名字，用来标识自己，表名具有唯一性。</p><p>表具有一些特性，这些特性定义了数据在表中如何存储，类似Java和Python中类的设计。</p><h2 id=表记录字段><a class=anchor href=#表记录字段>#</a> 表/记录/字段</h2><p>E-R(entity-relationship，实体-联系)模型中有三个主要概念是：实体集，属性，联系表。</p><p>一个实体集(class)对应于数据库中的一个表(table)，一个实体(instance)则对应于数据库表中的一行(row)，也称为一条记录(record)。一个属性(attribute)对应于数据库表中的一列(column)，也称为一个字段(field)。</p><figure class="highlight tex"><figcaption data-lang=TeX></figcaption><table><tr><td data-num=1></td><td><pre>ORM思想(Object Relational Mapping)</pre></td></tr><tr><td data-num=2></td><td><pre>数据库中的一个表 → Java或Python中的一个类</pre></td></tr><tr><td data-num=3></td><td><pre>表中的一条数据 → 类中的一个对象(或实体)</pre></td></tr><tr><td data-num=4></td><td><pre>表中的一个列 → 类中的一个字段，属性(field)</pre></td></tr></table></figure><p>表与表之间的数据记录有关系(relationship)。现实世界中的各种实体之间的各种联系均用关系模型来表示。</p><p>关联关系有一对一关联，一对多关系，多对多关联，自我引用。</p><h2 id=mysql的登录><a class=anchor href=#mysql的登录>#</a> MySQL的登录</h2><p><strong>服务的启动与停止</strong></p><p>MySQL安装完毕之后，需要启动服务器进程，不然客户端无法连接数据库。</p><p>当在前面的配置过程中，MySQL已作为windows服务并勾选了自启动和自停止。</p><p><strong>在命令行中启动</strong></p><figure class="highlight bash"><figcaption data-lang=bash></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">#启动MySQL服务命令</span></pre></td></tr><tr><td data-num=2></td><td><pre>net start MySQL服务名</pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token comment">#停止MySQL服务命令</span></pre></td></tr><tr><td data-num=5></td><td><pre>net stop MySQL服务名</pre></td></tr></table></figure><p><strong>在命令行中使用</strong></p><p>显示登录mysql数据库(不安全) - <code>mysql -uroot -p密码</code></p><p>隐式登录mysql数据库 - <code>mysql -uroot -p</code></p><p>通过端口号登录不同版本的mysql数据库 - <code>mysql -u root -P端口号 -p</code></p><p>登录服务器上的mysql数据库 - <code>mysql -u root -h主机地址 -p</code></p><p><strong>MySQL的使用演示</strong></p><p>查看当前存在的数据库 - <code>show databases</code></p><figure class="highlight tex"><figcaption data-lang=TeX></figcaption><table><tr><td data-num=1></td><td><pre>information_schema	→ 存储数据库服务的系统信息</pre></td></tr><tr><td data-num=2></td><td><pre>mysql → 存储数据库运行时需要的系统信息(数据库链接，字符集)</pre></td></tr><tr><td data-num=3></td><td><pre>performance_schema → 存储监控数据库的各指标</pre></td></tr><tr><td data-num=4></td><td><pre>sys → 存储系统指标，用于管理员或开发者监控数据库性能</pre></td></tr></table></figure><p>查看当前编码 - 默认为latin1</p><figure class="highlight bash"><figcaption data-lang=bash></figcaption><table><tr><td data-num=1></td><td><pre>show variables linke <span class="token string">'character_%'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=2></td><td><pre>show variables like <span class="token string">'collation_%'</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>修改当前默认编码</p><figure class="highlight tex"><figcaption data-lang=TeX></figcaption><table><tr><td data-num=1></td><td><pre>//修改文件: `./MySQL/MySQL Server x.x/my.ini`</pre></td></tr><tr><td data-num=2></td><td><pre></pre></td></tr><tr><td data-num=3></td><td><pre>//查找</pre></td></tr><tr><td data-num=4></td><td><pre><span class="token punctuation">[</span>mysql<span class="token punctuation">]</span></pre></td></tr><tr><td data-num=5></td><td><pre>....</pre></td></tr><tr><td data-num=6></td><td><pre>//在最后添加</pre></td></tr><tr><td data-num=7></td><td><pre>default-character-set=utf8</pre></td></tr><tr><td data-num=8></td><td><pre></pre></td></tr><tr><td data-num=9></td><td><pre>//查找</pre></td></tr><tr><td data-num=10></td><td><pre><span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span></pre></td></tr><tr><td data-num=11></td><td><pre>....</pre></td></tr><tr><td data-num=12></td><td><pre>//在最后添加</pre></td></tr><tr><td data-num=13></td><td><pre>default-set-server=utf8</pre></td></tr><tr><td data-num=14></td><td><pre>collation-server=utf8_general_ci</pre></td></tr></table></figure><figure class="highlight bash"><figcaption data-lang=bash></figcaption><table><tr><td data-num=1></td><td><pre>//修改文件以后，需要重启服务</pre></td></tr><tr><td data-num=2></td><td><pre>net stop mysql服务名<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre>net start mysql服务名<span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>MySQL图形化管理工具</strong></p><ul><li>Navicat</li><li>DBeaver</li></ul><h2 id=小结一><a class=anchor href=#小结一>#</a> 小结一</h2><p><strong>常见的数据库</strong></p><p>Oracle，MySQL，SQL Server，PGSQL；Redis，MongoDB等</p><p><strong>MySQL历史与特点</strong></p><p>历史</p><ul><li>由瑞典的MySQL AB公司创立，1995年开发出的MySQL</li><li>2008年，MySQL被SUN公司收购</li><li>2009年，Oracle收购SUN公司，进而Oracle获取了MySQL</li><li>2016年，MySQL8.0.0版本推出</li></ul><p>特点</p><ul><li>开源的，关系型的数据库</li><li>支持千万级别数据量的存储，大型的数据库</li></ul><p><strong>DB/DBMS/SQL的理解</strong></p><p>DB：database，看做是数据库文件。</p><p>DBMS：数据库管理系统。</p><p>MySQL数据库服务器中安装了MySQL DBMS，使用MySQL DBMS来管理和操作DB，使用的是SQL语言。</p><p><strong>有哪些非关系型数据库的类型</strong></p><p>键值型数据库：Redis</p><p>文档型数据库：MongoDB</p><p>列式数据库：HBase</p><p>图形数据库：InfoGrid</p><p><strong>表与表的记录之间存在哪些关联关系</strong></p><p>ORM思想。</p><p>表与表的记录之间的关系：一对一，一对多关系，多对多关系，自关联。</p><p><strong>MySQL在系统中的安装位置</strong></p><p>MySQL DBMS软件的安装位置：<code>./MySQL/MySQL Server x.x</code></p><p>MySQL 数据库文件的存放位置：<code>./MySQL/MySQL Server x.x/Data</code></p><p>MySQL DBMS的配置文件：<code>./MySQL/MySQL Server x.x/my.ini</code></p><p>MySQL的服务(要想通过客户端能够访问MySQL的服务器，必须保证服务是开启状态的)。</p><p>MySQL的path环境变量。</p><h2 id=sql分类><a class=anchor href=#sql分类>#</a> SQL分类</h2><p>SQL语言在功能上主要分为</p><p>DDL(DATA Definition Languages，数据定义语言)，这些语句定义了不同的数据库，表，视图，索引等数据库对象，还可以用来创建，删除，修改数据库和数据表的结构</p><ul><li>主要语句关键字包括<code>CREATE</code>，<code>DROP</code>，<code>ALTER</code>，<code>RENAME</code>，<code>TRUNCATE</code>等</li></ul><p>DML(Data Manipulaltion Language，数据操作语言)，用于添加，删除，更新和查询数据库记录，并检查数据完整性</p><ul><li>主要的语句关键字包括<code>INSERT</code>，<code>DELETE</code>，<code>UPDATE</code>，<code>SELECT</code>等</li><li>SELECT是SQL语言的基础</li></ul><p>DCL(Data Control Language，数据控制语言)，用于定义数据库，表，字段，用户的访问权限和安全级别</p><ul><li>主要的语句关键字包括<code>GRANT</code>，<code>REVOKE</code>，<code>COMMIT</code>，<code>ROLLBACK</code>，<code>SAVEPOINT</code></li></ul><p><code>SELECT</code> - DQL(数据查询语言)</p><p><code>COMMIT</code>与<code>ROLLBACK</code> - TCL(Transaction Control Language，事务控制语言)</p><h2 id=sql语言的规则与规范><a class=anchor href=#sql语言的规则与规范>#</a> SQL语言的规则与规范</h2><p><strong>基本规则</strong></p><p>SQL可以写在一行或者多行。为了提高可读性，各子句分行写，必要时使用缩进。</p><p>每条命令以分号<code>;</code>或<code>\g</code>或<code>\G</code>结束。</p><p>关键字不能被缩写也不能分行。</p><p>关于标点符号</p><ul><li>必须保证所有的<code>()</code>，单引号，双引号是成对结束的</li><li>必须使用英文状态下的半角输入方式</li><li>字符串型和日期时间类型的时间可以使用单引号表示</li><li>列的别名，尽量使用双引号，而且不建议省略<code>AS</code>关键字</li></ul><p><strong>规范(建议遵守)</strong></p><p>MySQL在Windows环境下是大小写不敏感的。</p><p>MySQL在Linjux环境下是大小写敏感的</p><ul><li>数据库名，表名，表的别名，变量名是严格区分大小写的</li><li>关键字，函数名，列名(或字段名)，列的别名(字段的别名)是忽略大小写的</li></ul><p>推荐采用的书写规范</p><ul><li>数据库名，表名，表别名，字段名，字段别名等都是小写</li><li>SQL关键字，函数名，绑定变量等都是大写</li></ul><p><strong>注释</strong></p><p>单行注释(MySQL特有) - <code>#注释内容</code></p><p>单行注释(<code>--</code>后面必须包含一个空格) - <code>-- 注释文字</code></p><p>多行注释 - <code>/* 注释内容 */</code></p><p><strong>命名规则</strong></p><p>数据库，表名不得超过30个字符，变量名限制为29个。</p><p>必须包含<code>A-Z</code>，<code>a-z</code>，<code>0-9</code>，<code>_</code>共63个字符。</p><p>数据库名，表名，字段名等对象名中间不要包含空格。</p><p>同一个MySQL软件中，数据库不能同名；同一个库中，表不能重名；同一个表中，字段不能重名。</p><p>必须保证字段没有和保留字，数据库系统或常用方法冲突。如果坚持使用，请在SQL语句中使用```(着重号)引起来。</p><p>保存字段名和类型的一致性，在命名字段并为其指定数据类型的时候一定要保持一致性。</p><p><strong>数据表导入</strong></p><p><code>source 文件的全路径名</code></p><h2 id=基本的select语句><a class=anchor href=#基本的select语句>#</a> 基本的SELECT语句</h2><p><code>SELECT 字段1,字段2,... FROM 表名</code></p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">SELECT</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span> <span class="token comment">/* dual: 伪表 */</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token comment">*表中的所有的字段(或列)</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name salary</pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=11></td><td><pre></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token comment">列的别名</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token comment">as 名字</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token comment">列的别名可以使用双引号引起来(尽量别用单引号)</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name <span class="token keyword">AS</span> lname</pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name <span class="token string">"lname"</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=22></td><td><pre></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name <span class="token keyword">AS</span> <span class="token string">"lname"</span></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=25></td><td><pre></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token comment">/* 去重 */</span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token comment">/* 正确写法 */</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> salary<span class="token punctuation">,</span>department_id</pre></td></tr><tr><td data-num=29></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=30></td><td><pre></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token comment">/* 错误写法 */</span></pre></td></tr><tr><td data-num=32></td><td><pre><span class="token keyword">SELECT</span> salary<span class="token punctuation">,</span><span class="token keyword">DISTINCT</span> department_id</pre></td></tr><tr><td data-num=33></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=34></td><td><pre></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token comment">空值参与运算</span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token comment">空值：NULL</span></pre></td></tr><tr><td data-num=38></td><td><pre><span class="token comment">NULL不等同于0，''，'NULL'</span></pre></td></tr><tr><td data-num=39></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=40></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>salary <span class="token string">"月工资"</span><span class="token punctuation">,</span>salary <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> commission_pct<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">12</span> <span class="token string">"年工资"</span><span class="token punctuation">,</span>commission_pct</pre></td></tr><tr><td data-num=41></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=42></td><td><pre><span class="token comment">/* 引入IFNULL */</span></pre></td></tr><tr><td data-num=43></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>salary <span class="token string">"月工作"</span><span class="token punctuation">,</span>salary <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> IFNULL<span class="token punctuation">(</span>commission_pct<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">"年工资"</span><span class="token punctuation">,</span>commission_pct</pre></td></tr><tr><td data-num=44></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=45></td><td><pre></pre></td></tr><tr><td data-num=46></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=47></td><td><pre><span class="token comment">着重号 `</span></pre></td></tr><tr><td data-num=48></td><td><pre><span class="token comment">当字段名或表名与关键字等重名时，需要添加</span></pre></td></tr><tr><td data-num=49></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=50></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span>  <span class="token identifier"><span class="token punctuation">`</span>order<span class="token punctuation">`</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=51></td><td><pre></pre></td></tr><tr><td data-num=52></td><td><pre><span class="token comment">/* 查询常数 */</span></pre></td></tr><tr><td data-num=53></td><td><pre><span class="token keyword">SELECT</span> <span class="token string">'xxx'</span><span class="token punctuation">,</span>employee_id<span class="token punctuation">,</span>last_name</pre></td></tr><tr><td data-num=54></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=55></td><td><pre></pre></td></tr><tr><td data-num=56></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=57></td><td><pre><span class="token comment">显示表结构</span></pre></td></tr><tr><td data-num=58></td><td><pre><span class="token comment">显示了表中字段的详细信息</span></pre></td></tr><tr><td data-num=59></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=60></td><td><pre><span class="token keyword">DESCRIBE</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=61></td><td><pre><span class="token keyword">DESC</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=62></td><td><pre></pre></td></tr><tr><td data-num=63></td><td><pre><span class="token comment">/* 过滤数据 */</span></pre></td></tr><tr><td data-num=64></td><td><pre><span class="token comment">/* 查询90号部门的员工 信息 */</span></pre></td></tr><tr><td data-num=65></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=66></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=67></td><td><pre><span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=68></td><td><pre></pre></td></tr><tr><td data-num=69></td><td><pre><span class="token comment">/* 查询last_name为`king`的员工信息 */</span></pre></td></tr><tr><td data-num=70></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=71></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=72></td><td><pre><span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> <span class="token string">'King'</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>基本练习题/案例</strong></p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 查询员工12个月的工资总和，并起别名为ANNUAL SALARY */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>salary <span class="token operator">*</span> <span class="token number">12</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> IFNULL<span class="token punctuation">(</span>commission_pct<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">"ANNUAL SALARY"</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=4></td><td><pre></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token comment">/* 查询employees表中去除重复的job_id以后的数据 */</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> job_id</pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token comment">/* 查询工资大于12000的员工姓名和工资 */</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">WHERE</span> salary <span class="token operator">></span> <span class="token number">12000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token comment">/* 查询员工号为176的员工的姓名和部门号 */</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_id</pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> <span class="token number">176</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=18></td><td><pre></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token comment">/* 显示表departments的结构，并查询其中的全部数据 */</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token keyword">DESCRIBE</span> departments<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=21></td><td><pre></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> departments<span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id=运算符><a class=anchor href=#运算符>#</a> 运算符</h2><h3 id=算术运算符><a class=anchor href=#算术运算符>#</a> 算术运算符</h3><p><code>+</code></p><p><code>-</code></p><p><code>*</code></p><p><code>/</code> → div</p><p><code>%</code> → mod</p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">SELECT</span> <span class="token number">100</span><span class="token punctuation">,</span><span class="token number">100</span> <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span> <span class="token operator">-</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span> <span class="token operator">+</span> <span class="token number">50</span> <span class="token operator">*</span> <span class="token number">30</span><span class="token punctuation">,</span><span class="token number">100</span> <span class="token operator">+</span> <span class="token number">35.3</span><span class="token punctuation">,</span><span class="token number">100</span> <span class="token operator">-</span><span class="token number">35.5</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token comment">/* 结果为1001 */</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">SELECT</span> <span class="token number">100</span> <span class="token operator">+</span> <span class="token string">'1'</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token comment">/* 此时将`a`看做0处理 */</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">SELECT</span> <span class="token number">100</span> <span class="token operator">+</span> <span class="token string">'a'</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=11></td><td><pre></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token comment">/* 结果为NULL */</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">SELECT</span> <span class="token number">100</span> <span class="token operator">+</span> <span class="token boolean">NULL</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id=比较运算符><a class=anchor href=#比较运算符>#</a> 比较运算符</h3><table><thead><tr><th>运算符</th><th>名称</th><th>作用</th></tr></thead><tbody><tr><td>=</td><td>等于运算符</td><td>判断两个字，字符串或表达式是否相等</td></tr><tr><td>&lt;=&gt;</td><td>安全等于运算符</td><td>安全地判断两个值，字符串或表达式是否相等</td></tr><tr><td>&lt;&gt;(!=)</td><td>不等于运算符</td><td>判断两个值，字符串或表达式是否不相等</td></tr><tr><td>&lt;</td><td>小于运算符</td><td>判断前面的值，字符串或表达式是否小于后面的值，字符串或表达式</td></tr><tr><td>&lt;=</td><td>小于等于运算符</td><td>判断前面的值，字符串或表达式是否小于等于后面的值，字符串或表达式</td></tr><tr><td>&gt;</td><td>大于运算符</td><td>判断前面的值，字符串或表达式是否大于后面的值，字符串或表达式</td></tr><tr><td>&gt;=</td><td>大于等于运算符</td><td>判断前面的值，字符串或表达式是否大于等于后面的值，字符串或表达式</td></tr></tbody></table><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 字符串存在隐式转换,如果转换数值不成功，则看作为0 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">SELECT</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span> <span class="token operator">=</span> <span class="token string">'1'</span><span class="token punctuation">,</span><span class="token number">1</span> <span class="token operator">=</span> <span class="token string">'a'</span><span class="token punctuation">,</span><span class="token number">0</span> <span class="token operator">=</span> <span class="token string">'a'</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=4></td><td><pre></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">SELECT</span> <span class="token string">'a'</span> <span class="token operator">=</span> <span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'ab'</span> <span class="token operator">=</span> <span class="token string">'ab'</span><span class="token punctuation">,</span><span class="token string">'a'</span> <span class="token operator">=</span> <span class="token string">'b'</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">SELECT</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token boolean">NULL</span> <span class="token operator">=</span> <span class="token boolean">NULL</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>salary<span class="token punctuation">,</span>commission_pct</pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">WHERE</span> commission_pct <span class="token operator">&lt;=></span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token comment">/* NULL\IS NOT NULL\ISNULL */</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token comment">/* 查询表中commission_pct为NULL的数据有哪些 */</span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>salary<span class="token punctuation">,</span>commission_pct</pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=19></td><td><pre><span class="token keyword">WHERE</span> commission_pct <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>安全等于运算符<code>&lt;=&gt;</code>与<code>=</code>的唯一区别是<code>&lt;=&gt;</code>可以用来对NULL进行判断。</p><table><thead><tr><th>运算符</th><th>名称</th><th>作用</th></tr></thead><tbody><tr><td>IS NULL</td><td>为空运算符</td><td>判断值，字符串或表达式是否为空</td></tr><tr><td>IS NOTNULL</td><td>不为空运算符</td><td>判断值，字符串或表达式是否不为空</td></tr><tr><td>LEAST</td><td>最小值运算符</td><td>在多个值中返回最小值</td></tr><tr><td>GREATEST</td><td>最大值运算符</td><td>在多个值中返回最大值</td></tr><tr><td>BETWEEN AND</td><td>两值之间的运算符</td><td>判断一个值是否在两个值之间</td></tr><tr><td>ISNULL</td><td>为空运算符</td><td>判断一个值，字符串或表达式是否为空</td></tr><tr><td>IN</td><td>属于运算符</td><td>判断一个值是否为列表中的任意一个值</td></tr><tr><td>NOT IN</td><td>不属于运算符</td><td>判断一个值是否不是一个列表中的任意一个值</td></tr><tr><td>LIKE</td><td>模糊匹配运算符</td><td>判断一个值是否符合模糊匹配规则</td></tr><tr><td>REGEXP</td><td>正则表达式运算符</td><td>判断一个值是否符合正则表达式的规则</td></tr><tr><td>RLIKE</td><td>正则表达式运算符</td><td>判断一个值是否符合正则表达式的规则</td></tr></tbody></table><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token comment">最小 LEAST()</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token comment">最大 GREATEST()</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token comment">长度 LENGTH()</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">SELECT</span> LEAST<span class="token punctuation">(</span><span class="token string">'g'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'t'</span><span class="token punctuation">,</span><span class="token string">'m'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>GREATEST<span class="token punctuation">(</span>LENGTH<span class="token punctuation">(</span>first_nmae<span class="token punctuation">)</span><span class="token punctuation">,</span>LENGTH<span class="token punctuation">(</span>last_name<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">SELECT</span> LEAST<span class="token punctuation">(</span>first_name<span class="token punctuation">,</span>last_name<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=11></td><td><pre></pre></td></tr><tr><td data-num=12></td><td><pre></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token comment">/*  BETWEEN...AND  */</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=15></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">WHERE</span> salary <span class="token operator">BETWEEN</span> <span class="token number">6000</span> <span class="token operator">AND</span> <span class="token number">8000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=17></td><td><pre></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token comment">/*  NOT BETWEEN...AND  */</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=20></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=21></td><td><pre><span class="token keyword">WHERE</span> salary <span class="token operator">NOT</span> <span class="token operator">BETWEEN</span> <span class="token number">6000</span> <span class="token operator">AND</span> <span class="token number">8000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=22></td><td><pre></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token comment">/*  IN (set) \ NOT IN (set)   */</span></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token comment">/*  查询部门为10,20,30部门的员工信息  */</span></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>salary<span class="token punctuation">,</span>department_id</pre></td></tr><tr><td data-num=26></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=27></td><td><pre><span class="token keyword">WHERE</span> department_id <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=28></td><td><pre></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token comment">/*  LIKE 模糊查询  */</span></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token comment">/* 查询last_name中包含字符`a`的员工信息 */</span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token keyword">SELECT</span> last_name</pre></td></tr><tr><td data-num=32></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=33></td><td><pre><span class="token keyword">WHERE</span> last_name <span class="token operator">LIKE</span> <span class="token string">'%a%'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=34></td><td><pre></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token comment">/*  _ 代表一个不确定的字符  */</span></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token keyword">SELECT</span> last_name</pre></td></tr><tr><td data-num=37></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=38></td><td><pre><span class="token keyword">WHERE</span> last_name <span class="token operator">LIKE</span> <span class="token string">'_a_'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=39></td><td><pre></pre></td></tr><tr><td data-num=40></td><td><pre><span class="token comment">/*  查询字符中包含_，使用'\'转义字符  */</span></pre></td></tr><tr><td data-num=41></td><td><pre><span class="token keyword">SELECT</span> last_name</pre></td></tr><tr><td data-num=42></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=43></td><td><pre><span class="token keyword">WHERE</span> last_name <span class="token operator">LIKE</span> <span class="token string">'_\_a%'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=44></td><td><pre></pre></td></tr><tr><td data-num=45></td><td><pre><span class="token comment">/* REGEXP/RLIKE 正则表达式 */</span></pre></td></tr><tr><td data-num=46></td><td><pre><span class="token keyword">SELECT</span> <span class="token string">'shkstart'</span> </pre></td></tr><tr><td data-num=47></td><td><pre><span class="token operator">REGEXP</span> <span class="token string">'^s'</span><span class="token punctuation">,</span><span class="token string">'shkstart'</span> <span class="token operator">REGEXP</span> <span class="token string">'t$'</span><span class="token punctuation">,</span> <span class="token string">'shkstart'</span> <span class="token operator">REGEXP</span> <span class="token string">'hk'</span></pre></td></tr><tr><td data-num=48></td><td><pre><span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=49></td><td><pre></pre></td></tr><tr><td data-num=50></td><td><pre><span class="token keyword">SELECT</span> <span class="token string">'atguigu'</span> <span class="token operator">REGEXP</span> <span class="token string">'gu.gu'</span><span class="token punctuation">,</span><span class="token string">'atguigu'</span> <span class="token operator">REGEXP</span> <span class="token string">'[ab]'</span></pre></td></tr><tr><td data-num=51></td><td><pre><span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id=逻辑运算符><a class=anchor href=#逻辑运算符>#</a> 逻辑运算符</h3><table><thead><tr><th>运算符</th><th>作用</th></tr></thead><tbody><tr><td>NOT 或 !</td><td>逻辑非</td></tr><tr><td>AND 或 &amp;&amp;</td><td>逻辑与</td></tr><tr><td>OR 或 ||</td><td>逻辑或</td></tr><tr><td>XOR</td><td>逻辑异或</td></tr></tbody></table><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment"># not</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>salary<span class="token punctuation">,</span>department_id</pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">50</span>  <span class="token operator">AND</span> salary <span class="token operator">></span> <span class="token number">6000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token comment"># xor</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>salary<span class="token punctuation">,</span>department_id</pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">50</span> <span class="token operator">XOR</span> salary <span class="token operator">></span> <span class="token number">6000</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>运算符的优先级</strong></p><table><thead><tr><th>优先级</th><th>运算符</th></tr></thead><tbody><tr><td>1</td><td>:=, =</td></tr><tr><td>2</td><td>||, OR, XOR</td></tr><tr><td>3</td><td>&amp;&amp;, AND</td></tr><tr><td>4</td><td>NOT</td></tr><tr><td>5</td><td>BETWEEN, CASE, WHEN, THEN 和 ELSE</td></tr><tr><td>6</td><td>(比较运算符)</td></tr><tr><td>7</td><td>|</td></tr><tr><td>8</td><td>&amp;</td></tr><tr><td>9</td><td>&lt;&lt;与&gt;&gt;</td></tr><tr><td>10</td><td>-和+</td></tr><tr><td>11</td><td>*, /, DIV, %和MOD</td></tr><tr><td>12</td><td>^</td></tr><tr><td>13</td><td>-(负号) 和 ~(按位取反)</td></tr><tr><td>14</td><td>!</td></tr><tr><td>15</td><td>()</td></tr></tbody></table><p>数字编号越大，优先级越高，优先级高的运算符先进行计算。可以看到，赋值运算符的优先级最低，使用<code>()</code>括起来的表达式的优先级最高。</p><h3 id=位运算符><a class=anchor href=#位运算符>#</a> 位运算符</h3><table><thead><tr><th>运算符</th><th>作用</th></tr></thead><tbody><tr><td>&amp;</td><td>按位与</td></tr><tr><td>|</td><td>按位或</td></tr><tr><td>……</td><td>按位异或</td></tr><tr><td>~</td><td>按位取反</td></tr><tr><td>&gt;&gt;</td><td>按位右移</td></tr><tr><td>&lt;&lt;</td><td>按位左移</td></tr></tbody></table><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">SELECT</span> <span class="token number">10</span> <span class="token operator">&amp;</span> <span class="token operator">~</span><span class="token number">1</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>运算符练习/案例</strong></p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 选择工资不在5000到12000的员工的姓名和工资 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">WHERE</span> salary <span class="token operator">&lt;</span> <span class="token number">5000</span> <span class="token operator">OR</span> salary <span class="token operator">></span> <span class="token number">12000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token comment">/* 选择在20或50号部门工作的员工姓名和部门号 */</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_id</pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">20</span> <span class="token operator">OR</span> department_id <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token comment">/* 选择公司有奖金的员工姓名，工资和奖金级别 */</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>job_id<span class="token punctuation">,</span>manager_id</pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">WHERE</span> manager_id <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>job_id<span class="token punctuation">,</span>manager_id</pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">WHERE</span> manager_id <span class="token operator">&lt;=></span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token comment">/* 选择员工姓名的第三个字母是a的员工姓名 */</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token keyword">SELECT</span> last_name</pre></td></tr><tr><td data-num=22></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=23></td><td><pre><span class="token keyword">WHERE</span> last_name <span class="token operator">LIKE</span> <span class="token string">'__a%'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token comment">/* 选择姓名中有字母a和k的员工姓名 */</span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token keyword">SELECT</span> last_name</pre></td></tr><tr><td data-num=27></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=28></td><td><pre><span class="token keyword">WHERE</span> last_name <span class="token operator">LIKE</span> <span class="token string">'%a%'</span> <span class="token operator">AND</span> last_name <span class="token operator">LIKE</span> <span class="token string">'%k%'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=29></td><td><pre></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token comment">/* 显示出表employees表中first_name以`e`结尾的员工信息 */</span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token keyword">SELECT</span> first_name<span class="token punctuation">,</span>last_name</pre></td></tr><tr><td data-num=32></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=33></td><td><pre><span class="token keyword">WHERE</span> first_name <span class="token operator">LIKE</span> <span class="token string">'%e'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=34></td><td><pre></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token keyword">SELECT</span> first_name<span class="token punctuation">,</span>last_name</pre></td></tr><tr><td data-num=36></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=37></td><td><pre><span class="token keyword">WHERE</span> first_name <span class="token operator">REGEXP</span> <span class="token string">'$'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=38></td><td><pre></pre></td></tr><tr><td data-num=39></td><td><pre><span class="token comment">/* 显示出表employees部门编号在80-100之间的姓名，工种 */</span></pre></td></tr><tr><td data-num=40></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>job_id</pre></td></tr><tr><td data-num=41></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=42></td><td><pre><span class="token keyword">WHERE</span> department_id <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=43></td><td><pre></pre></td></tr><tr><td data-num=44></td><td><pre><span class="token comment">/* 显示出表employees的manager_id是100,101,110的员工姓名，工资，管理者id */</span></pre></td></tr><tr><td data-num=45></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>salary_manager_id</pre></td></tr><tr><td data-num=46></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=47></td><td><pre><span class="token keyword">WHERE</span> manager_id <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id=排序与分页><a class=anchor href=#排序与分页>#</a> 排序与分页</h2><h3 id=排序><a class=anchor href=#排序>#</a> 排序</h3><p><strong>排序规则</strong></p><p>使用ORDER BY子句排序</p><ul><li>ASC(ascend)：升序</li><li>DESC(descend)：降序</li></ul><p>ORDER BY子句在SELECT语句的结尾。</p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token comment">如果没有使用排序操作，默认情况下查询返回的数据是按照添加数据的顺序显示的</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token comment">/* 按照salary从高到低的顺序显示员工信息 */</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> salary<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token comment">/* 列的别名只能在ORDER BY中使用，不能在WHERE中使用 */</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>salary<span class="token punctuation">,</span>salary <span class="token operator">*</span> <span class="token number">12</span> annual_sal</pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">WHERE</span> department_id <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">70</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> department_id <span class="token keyword">DESC</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token comment">/* 多级排序 */</span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token comment">/* 显示员工信息，按照department_id的降序排列，salary的升序排列 */</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>salary<span class="token punctuation">,</span>department_id</pre></td></tr><tr><td data-num=20></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=21></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> department_id <span class="token keyword">DESC</span><span class="token punctuation">,</span>salary <span class="token keyword">ASC</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id=分页><a class=anchor href=#分页>#</a> 分页</h3><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token comment">每页显示pageSize条记录，此时显示第pageNo页</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token comment">LIMIT(pageNo - 1) * pageSize</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token comment">/* 每页显示20条记录，此时显示第1页 */</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name</pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token comment">/* 每页显示20条记录，此时显示第2页 */</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name</pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">LIMIT</span> <span class="token number">20</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token comment">/* 每页显示20条记录，此时显示第3页 */</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name</pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">LIMIT</span> <span class="token number">40</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token comment">/* WHERE...ORDER BY...LIMIT */</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token comment">LIMIT的格式：严格来说：LIMIT位置偏移量，条目数</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token comment">结构`LIMIT 0,条目数`等价于`LIMIT 条目数`</span></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=26></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=27></td><td><pre><span class="token keyword">WHERE</span> salary <span class="token operator">></span> <span class="token number">6000</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> salary <span class="token keyword">DESC</span></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=30></td><td><pre></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token comment">/* 表里有107条数据，我们只要显示第32，33条数据怎么办？ */</span></pre></td></tr><tr><td data-num=32></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name</pre></td></tr><tr><td data-num=33></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=34></td><td><pre><span class="token keyword">LIMIT</span> <span class="token number">2</span> <span class="token keyword">OFFSET</span> <span class="token number">31</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=35></td><td><pre></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token comment">/* 查询员工表中工资最高的员工信息 */</span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token comment">/* LIMIT 1,告诉SELECT语句只需返回一条记录即可 */</span></pre></td></tr><tr><td data-num=38></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=39></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=40></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> salary <span class="token keyword">DESC</span></pre></td></tr><tr><td data-num=41></td><td><pre><span class="token keyword">LIMIT</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>排序与分页练习/案例</strong></p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 查询员工的姓名和部门号和年薪，按年薪降序，按姓名升序显示 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_id<span class="token punctuation">,</span>salary <span class="token operator">*</span> <span class="token number">12</span> annual_salary</pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> annual_salary <span class="token keyword">DESC</span><span class="token punctuation">,</span>last_name <span class="token keyword">ASC</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token comment">/* 选择工资不在8000到17000的员工的姓名和工资，按工资降序，显示第21到40位置的数据 */</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">WHERE</span> salary <span class="token operator">NOT</span> <span class="token operator">BETWEEN</span> <span class="token number">8000</span> <span class="token operator">AND</span> <span class="token number">17000</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> salary <span class="token keyword">DESC</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">LIMIT</span> <span class="token number">20</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token comment">/* 查询邮箱中包含e的员工信息，并先按邮箱的字节数降序，再按部门号升序 */</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>email<span class="token punctuation">.</span>department_id</pre></td></tr><tr><td data-num=15></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=16></td><td><pre><span class="token comment">/* WHERE email LIKE '%e%'; */</span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">WHERE</span> email <span class="token operator">REGEXP</span> <span class="token string">'[e]'</span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> email<span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id=多表查询><a class=anchor href=#多表查询>#</a> 多表查询</h2><p>多表查询，也称为关联查询，指两个或更多个表一起完成查询操作。</p><p>前提条件，这些一起查询的表之间是有关系的(一对一，一对多)，它们之间一定是有关联字段，这个关联字段可能建立了外键，也可能没有建立外键。</p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 多表查询 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">,</span>departments</pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">WHERE</span> employees<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token comment">/* 如果查询语句中出现了多个表中都存在的字段，则必须指明此字段所在的表 */</span></pre></td></tr><tr><td data-num=7></td><td><pre>SLECT employee_id<span class="token punctuation">,</span>department_name<span class="token punctuation">,</span>employees<span class="token punctuation">.</span>department_id</pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">,</span>departments</pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">WHERE</span> employees<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token comment">/* 建议从sql优化的角度，建议多表查询时，每个字段前都指明其所在的表 */</span></pre></td></tr><tr><td data-num=11></td><td><pre></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token comment">可以给表起别名，一旦在SELECT或WHERE中使用表名的话，</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token comment">则必须使用表的别名，而不能再使用表的原名</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">SELECT</span> emp<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>departments<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span>emp<span class="token punctuation">.</span>department_id</pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">FROM</span> employees emp<span class="token punctuation">,</span>departments dept</pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">WHERE</span> emp<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> dept<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token comment">如果有n个表实现多表的查询，则至少需要n - 1个连接条件</span></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token comment">查询员工的employee_id,last_name,department_name,city </span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=24></td><td><pre>SLECT e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span>l<span class="token punctuation">.</span>city<span class="token punctuation">,</span>e<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span>l<span class="token punctuation">.</span>location_id</pre></td></tr><tr><td data-num=25></td><td><pre><span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span>departments d<span class="token punctuation">,</span>locations l</pre></td></tr><tr><td data-num=26></td><td><pre><span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token operator">AND</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> l<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=28></td><td><pre></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token comment">/* 非等值连接的例子 */</span></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token keyword">FROM</span> job_grades<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=32></td><td><pre></pre></td></tr><tr><td data-num=33></td><td><pre><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>salary<span class="token punctuation">,</span>j<span class="token punctuation">.</span>grade_level</pre></td></tr><tr><td data-num=34></td><td><pre><span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span>job_grades j</pre></td></tr><tr><td data-num=35></td><td><pre><span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>salary<span class="token punctuation">`</span></span> <span class="token operator">BETWEEN</span> j<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>lowest_sal<span class="token punctuation">`</span></span> <span class="token operator">AND</span> j<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>highest_sal<span class="token punctuation">`</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=36></td><td><pre></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token comment">/* 自连接(自己链接自己) */</span></pre></td></tr><tr><td data-num=38></td><td><pre><span class="token comment">/* 查询员工id,员工姓名及其管理者的id和姓名 */</span></pre></td></tr><tr><td data-num=39></td><td><pre><span class="token keyword">SELECT</span> emp<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>emp<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>mgr<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>mgr<span class="token punctuation">.</span>last_name</pre></td></tr><tr><td data-num=40></td><td><pre><span class="token keyword">FROM</span> employees emp<span class="token punctuation">,</span>employees mgr</pre></td></tr><tr><td data-num=41></td><td><pre><span class="token keyword">WHERE</span> emp<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> mgr<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=42></td><td><pre></pre></td></tr><tr><td data-num=43></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=44></td><td><pre><span class="token comment">内连接 </span></pre></td></tr><tr><td data-num=45></td><td><pre><span class="token comment">合并具有同一列的两个以上的表的行，结果集中不包含一个表与另一个表不匹配的行</span></pre></td></tr><tr><td data-num=46></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=47></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=48></td><td><pre><span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span>departments d</pre></td></tr><tr><td data-num=49></td><td><pre><span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=50></td><td><pre></pre></td></tr><tr><td data-num=51></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=52></td><td><pre><span class="token comment">外连接</span></pre></td></tr><tr><td data-num=53></td><td><pre><span class="token comment">合并具有同一列的两个以上的表的行，</span></pre></td></tr><tr><td data-num=54></td><td><pre><span class="token comment">结果集中除了一个表与另一个表不匹配的行之外，还查询到了左表或右表中不匹配的行。</span></pre></td></tr><tr><td data-num=55></td><td><pre><span class="token comment">外连接的分类：左外连接，右外连接，满外连接</span></pre></td></tr><tr><td data-num=56></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=57></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=58></td><td><pre><span class="token comment">左外连接：两个表在连接过程中除了返回满足连接条件的行以外还返回左表中不满足条件的行</span></pre></td></tr><tr><td data-num=59></td><td><pre><span class="token comment">右外连接：两个表在连接过程中除了返回满足连接条件的行以外还返回右表中不满足条件的行</span></pre></td></tr><tr><td data-num=60></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=61></td><td><pre><span class="token comment">/* 查询所有的员工的last_name,department_name信息 */</span></pre></td></tr><tr><td data-num=62></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=63></td><td><pre><span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span>departments d</pre></td></tr><tr><td data-num=64></td><td><pre><span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=65></td><td><pre></pre></td></tr><tr><td data-num=66></td><td><pre><span class="token comment">/* 左外连接 */</span></pre></td></tr><tr><td data-num=67></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=68></td><td><pre><span class="token keyword">FROM</span> employees e LEET <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=69></td><td><pre><span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=70></td><td><pre></pre></td></tr><tr><td data-num=71></td><td><pre><span class="token comment">/* 右外连接 */</span></pre></td></tr><tr><td data-num=72></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=73></td><td><pre><span class="token keyword">FROM</span> employees e <span class="token keyword">RIGHT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=74></td><td><pre><span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d·<span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id=union的使用><a class=anchor href=#union的使用>#</a> UNION的使用</h2><p>合并查询结果</p><p>利用UNION关键字，可以给出多条SELECT语句，并将它们的结果组合成单个结果集。合并时，两个表对应的列数和数据类型必须相同，并且相互对应。各个SELECT语句之间使用UNION或UNION ALL关键字分隔。</p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">SELECT</span> <span class="token keyword">column</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">FROM</span> table1</pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">UNION</span> <span class="token punctuation">[</span><span class="token keyword">ALL</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">SELECT</span> <span class="token keyword">column</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">FROM</span> table2</pre></td></tr></table></figure><p><code>UNION</code>操作符返回两个查询的结果集的并集，去除重复记录。</p><p><code>UNION ALL</code>操作符返回两个查询的结果集的并集。对于两个结果集的重复部分，不去重。</p><figure class="highlight tex"><figcaption data-lang=TeX></figcaption><table><tr><td data-num=1></td><td><pre>执行UNION ALL语句时所需要的资源比UNION语句少。如果明确知道合并数据后的结果数据不存在重复数据，或者不需要去除重复的数据，则尽量使用UNION ALL语句，以提高数据查询的效率。</pre></td></tr></table></figure><p><strong>7种JOIN连接</strong></p><p><img data-src=https://cdn.jsdelivr.net/gh/ReverseSacle/Gallery@latest/programming/database/1.webp alt=""></p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 中图：内连接 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token comment">/* 左上图：内连接 */</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">ON</span>  e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token comment">/* 右上图：左外连接 */</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">FROM</span> employees e LEET <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token comment">/* 左中图 */</span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">FROM</span> employees e LEET <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=19></td><td><pre><span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=21></td><td><pre></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token comment">/* 右中图 */</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=24></td><td><pre><span class="token keyword">FROM</span> employees e <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=25></td><td><pre><span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=27></td><td><pre></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token comment">/* 左下图：满外连接 */</span></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token comment">/* 通过方式一：左上图UNION ALL右中图 */</span></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=31></td><td><pre><span class="token keyword">FROM</span> employees e LEET <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=32></td><td><pre><span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=33></td><td><pre><span class="token keyword">UNION</span> <span class="token keyword">ALL</span></pre></td></tr><tr><td data-num=34></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=35></td><td><pre><span class="token keyword">FROM</span> employees e <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=36></td><td><pre><span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=38></td><td><pre></pre></td></tr><tr><td data-num=39></td><td><pre><span class="token comment">/* 通过方式二：左中图 UNION ALL 右上图 */</span></pre></td></tr><tr><td data-num=40></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=41></td><td><pre><span class="token keyword">FROM</span> employees e LEET <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=42></td><td><pre><span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=43></td><td><pre><span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span></pre></td></tr><tr><td data-num=44></td><td><pre><span class="token keyword">UNION</span> <span class="token keyword">ALL</span></pre></td></tr><tr><td data-num=45></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=46></td><td><pre><span class="token keyword">FROM</span> employees e LEET <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=47></td><td><pre><span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id=自然连接与using连接sql99><a class=anchor href=#自然连接与using连接sql99>#</a> 自然连接与USING连接(SQL99)</h2><p><strong>自然连接</strong></p><p>SQL99在SQL92的基础上提供了一些特殊语法，比如NATURAL JOIN用来表示自然连接。可以把织染连接理解为SQL92中的等值连接。它会帮你自动查询两张连接表中所有相同的字段，然后进行等值连接。</p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 自然连接SQL92 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token operator">AND</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=6></td><td><pre></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token comment">/* 自然连接SQL99 */</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">FROM</span> employees e <span class="token keyword">NATURAL</span> <span class="token keyword">JOIN</span> departments d<span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>USING连接</strong></p><p>USING指定了具体的相同的字段名称，需要在USING的括号中填入要指定的同名字段。同时使用<code>JOIN...USING</code>可以简化JOIN ON的等值连接。</p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* SQL99语法的新特性2：USING */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">ON</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">USING</span> <span class="token punctuation">(</span>department_id<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token comment">/* 扩展 */</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>job_title<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">FROM</span> employees <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> departments <span class="token keyword">INNER</span> <span class="token keyword">Join</span> jobs</pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">ON</span> employees<span class="token punctuation">.</span>department_id <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id</pre></td></tr><tr><td data-num=14></td><td><pre><span class="token operator">AND</span> employees<span class="token punctuation">.</span>job_id <span class="token operator">=</span> jobs<span class="token punctuation">.</span>job_id<span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id=小结二><a class=anchor href=#小结二>#</a> 小结二</h2><p>表连接的约束条件有三种方式：<code>WHERE</code>，<code>ON</code>，<code>USING</code></p><ul><li>WHERE适用于所有关联查询</li><li>ON只能和JOIN一起使用，只能写关联条件。虽然关联条件可以并到WHERE中和其他条件一起写，但分开写可读性更好</li><li>USING只能和JOIN一起使用，而且要求两个关联字段在关联表中名称一致，而且只能表示关联字段值相等</li></ul><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 关联条件 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token comment">/* 把关联条件写在WHERE后面 */</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">,</span>departments</pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">WHERE</span> employees<span class="token punctuation">.</span>department_id <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span></pre></td></tr></table></figure><p>要控制连接表的数量。多表连接就相当于嵌套for循环一样，非常消耗资源，会让SQL查询性能下降得很严重，因此不要连接不必要得表。在许多DBMS中，也都会有最大连接表得限制。</p><p>强制条件，超过三个表禁止join。需要join得字段，数据类型保持绝对一致；多表关联查询时，保证被关联的字段需要有索引。</p><p><strong>章节练习/案例</strong></p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 显示所有员工的姓名，部门号和部门名称 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span>d<span class="token punctuation">.</span>department_name</pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">FROM</span> employees e <span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token comment">/* 查询90号部门员工的job_id和90号部门的location_id */</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>job_id<span class="token punctuation">,</span>d<span class="token punctuation">.</span>location_id</pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">DESC</span> departments<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token comment">/* 选择所有有奖金的员工的last_name, department_name, location_id, city */</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span>d<span class="token punctuation">.</span>location_id<span class="token punctuation">,</span>l<span class="token punctuation">.</span>city</pre></td></tr><tr><td data-num=15></td><td><pre><span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">JOIN</span> locations l</pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">ON</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> l<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>commission_pct<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=20></td><td><pre></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=23></td><td><pre><span class="token keyword">WHERE</span> commission_pct <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token comment">/* 选择city在Toronto工作的员工的last_name, job_id, department_id, department_name */</span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>job_id<span class="token punctuation">,</span>e<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span>d<span class="token punctuation">.</span>department_name</pre></td></tr><tr><td data-num=27></td><td><pre><span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=28></td><td><pre><span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token keyword">JOIN</span> locations l</pre></td></tr><tr><td data-num=30></td><td><pre><span class="token keyword">ON</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> l<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token keyword">WHERE</span> l<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>city<span class="token punctuation">`</span></span> <span class="token operator">=</span> <span class="token string">'Toronto'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=32></td><td><pre></pre></td></tr><tr><td data-num=33></td><td><pre></pre></td></tr><tr><td data-num=34></td><td><pre><span class="token comment">/* 查询员工所在的部门名称，部门地址，姓名，工作，工资，其中员工所在部门的部门名称为`Executive` */</span></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token keyword">SELECT</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span>l<span class="token punctuation">.</span>street_address<span class="token punctuation">,</span>e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>job_id<span class="token punctuation">,</span>e<span class="token punctuation">.</span>salary</pre></td></tr><tr><td data-num=36></td><td><pre><span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=37></td><td><pre><span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=38></td><td><pre><span class="token keyword">JOIN</span> locations l</pre></td></tr><tr><td data-num=39></td><td><pre><span class="token keyword">ON</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> l<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=40></td><td><pre><span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_name<span class="token punctuation">`</span></span> <span class="token operator">=</span> <span class="token string">'Executive'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=41></td><td><pre></pre></td></tr><tr><td data-num=42></td><td><pre><span class="token keyword">DESC</span> departments<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=43></td><td><pre><span class="token keyword">DESC</span> locations<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=44></td><td><pre></pre></td></tr><tr><td data-num=45></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=46></td><td><pre><span class="token comment">选择指定员工的姓名，员工号，以及它的管理者的姓名和员工号，结果类似于下面的格式</span></pre></td></tr><tr><td data-num=47></td><td><pre><span class="token comment">employees Emp# manager Mgr#</span></pre></td></tr><tr><td data-num=48></td><td><pre><span class="token comment">kochhar	  101  king    100</span></pre></td></tr><tr><td data-num=49></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=50></td><td><pre><span class="token keyword">SELECT</span> emp<span class="token punctuation">.</span>last_name <span class="token string">"employees"</span><span class="token punctuation">,</span>emp<span class="token punctuation">.</span>employee_id <span class="token string">"Emp#"</span><span class="token punctuation">,</span>mgr<span class="token punctuation">.</span>last_name <span class="token string">"manager"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=51></td><td><pre>mgr<span class="token punctuation">.</span>employee_id <span class="token string">"Mgr#"</span></pre></td></tr><tr><td data-num=52></td><td><pre><span class="token keyword">FROM</span> employees emp <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> employees mgr</pre></td></tr><tr><td data-num=53></td><td><pre><span class="token keyword">ON</span> emp<span class="token punctuation">.</span>manager_id <span class="token operator">=</span> mgr<span class="token punctuation">.</span>employee_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=54></td><td><pre></pre></td></tr><tr><td data-num=55></td><td><pre></pre></td></tr><tr><td data-num=56></td><td><pre><span class="token comment">/* 查询哪些部门没有员工 */</span></pre></td></tr><tr><td data-num=57></td><td><pre><span class="token keyword">SELECT</span> department_id</pre></td></tr><tr><td data-num=58></td><td><pre><span class="token keyword">FROM</span> departments d <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> employees e</pre></td></tr><tr><td data-num=59></td><td><pre><span class="token keyword">ON</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=60></td><td><pre><span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=61></td><td><pre></pre></td></tr><tr><td data-num=62></td><td><pre><span class="token comment">/* 查询哪个城市没有部门 */</span></pre></td></tr><tr><td data-num=63></td><td><pre><span class="token keyword">SELECT</span> l<span class="token punctuation">.</span>locaition_id<span class="token punctuation">,</span>l<span class="token punctuation">.</span>city</pre></td></tr><tr><td data-num=64></td><td><pre><span class="token keyword">FROM</span> locations l <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=65></td><td><pre><span class="token keyword">ON</span> l<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=66></td><td><pre><span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=67></td><td><pre></pre></td></tr><tr><td data-num=68></td><td><pre><span class="token keyword">SELECT</span> department_id</pre></td></tr><tr><td data-num=69></td><td><pre><span class="token keyword">FROM</span> departments</pre></td></tr><tr><td data-num=70></td><td><pre><span class="token keyword">WHERE</span> department_id <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">1100</span><span class="token punctuation">,</span><span class="token number">1200</span><span class="token punctuation">,</span><span class="token number">1300</span><span class="token punctuation">,</span><span class="token number">1600</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=71></td><td><pre></pre></td></tr><tr><td data-num=72></td><td><pre><span class="token comment">/* 查询部门名为Sales或IT的员工信息 */</span></pre></td></tr><tr><td data-num=73></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_id</pre></td></tr><tr><td data-num=74></td><td><pre><span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=75></td><td><pre><span class="token keyword">ON</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=76></td><td><pre><span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_name<span class="token punctuation">`</span></span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'Sales'</span><span class="token punctuation">,</span><span class="token string">'IT'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id=单行函数><a class=anchor href=#单行函数>#</a> 单行函数</h2><p>函数在计算机语言的使用中贯穿始终，函数的作用是什么呢？它可以把我们经常使用的代码封装起来，需要的时候直接调用即可。这样即提高了代码效率，又提高了可维护性。在SQL中也可以使用函数对检索出来的数据进行函数操作。使用这些函数，可以极大地提高用户对数据库的管理效率。</p><p>从函数定义的角度出发，可以将函数分成内置函数和自定义函数。在SQL语言中，同样也包括了内置函数和自定义函数。内置函数是系统内置的通用函数，而自定义函数是根据自己的需要编写的。</p><p>在使用SQL语言的时候，不是直接和这门语言打交道，而是通过它使用不同的数据库软件，即DBMS。DBMS之间的差异性很大，远大于一个语言不同版本之间的差异。只有很少的函数是被DBMS同时支持，大部分DBMS会有特点的函数，这就意味着采用SQL函数的代码可移植性是很差的。</p><p>MySQL提供了丰富的内置函数，从实现的功能角度可以分为数值函数，字符串函数，日期和时间函数，流程控制函数，加密与解密函数，获取MySQL信息函数，聚合函数等。这里，将内置函数分为两类，单行函数与聚合函数(或分组函数)。</p><p><strong>单行函数</strong></p><p>操作数据对象。接受参数返回一个结果。</p><p>只对一行进行变换，每行返回一个结果。</p><p>可以嵌套。</p><p>参数可以是一列或一个值。</p><h3 id=数值函数><a class=anchor href=#数值函数>#</a> 数值函数</h3><p><strong>基本函数</strong></p><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>ABS(x)</td><td>返回x的绝对值</td></tr><tr><td>SIGN(x)</td><td>返回x的符号。正数返回1，负数返回-1，0返回0</td></tr><tr><td>PI()</td><td>返回圆周率的值</td></tr><tr><td>CEIL(x), CEILING(x)</td><td>返回大于或等于某个值的最小整数</td></tr><tr><td>FLOOR(x)</td><td>返回小于或等于某个值的最大整数</td></tr><tr><td>LEAST(e1,e2,...)</td><td>返回列表中的最小值</td></tr><tr><td>GREATEST(e1,e2,...)</td><td>返回列表中的最大值</td></tr><tr><td>MOD(x,y)</td><td>返回x除以y后的余数(取模)</td></tr><tr><td>RAND()</td><td>返回0~1之间的随机值</td></tr><tr><td>RAND(x)</td><td>返回0~1之间的随机值，其中x的值用作种子值，相同的x值会产生相同的随机数</td></tr><tr><td>ROUND(x)</td><td>返回一个对x的值进行四舍五入后，最接近与x的整数</td></tr><tr><td>ROUND(x,y)</td><td>返回一个对x的值进行四舍五入后最接近x的值，并保留到小数点后面Y位</td></tr><tr><td>TRUNCATE(x,y)</td><td>返回数字x截断为y位小数的结果</td></tr><tr><td>SQRT(x)</td><td>返回x的平方根。当x的值为负数时，返回NULL</td></tr></tbody></table><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">SELECT</span> ABS<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SIGN<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">,</span>PI<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>CEIL<span class="token punctuation">(</span><span class="token number">32.32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>CEILING<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">43.23</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token comment">/* 两个RAND(10)值相等 */</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">SELECT</span> RAND<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>RAND<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>RAND<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>角度与弧度互换函数</strong></p><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>RADIANS(x)</td><td>将角度转化为弧度，其中，参数x为角度值</td></tr><tr><td>DEGREES(x)</td><td>将弧度转化为角度，其中，参数x为弧度值</td></tr></tbody></table><p><strong>三角函数</strong></p><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>SIN(x)</td><td>返回x的正弦值，其中，参数x为弧度值</td></tr><tr><td>ASIN(x)</td><td>返回x的反正弦值，即获取正弦为x的值。如果x的值不在-1到1之间，则返回NULL</td></tr><tr><td>COS(x)</td><td>返回x的余弦值，其中，参数x为弧度值</td></tr><tr><td>ACOS(x)</td><td>返回x的反余弦值，即获取余弦为x的值。如果x对值不在-1到1之间，则返回NULL</td></tr><tr><td>TAN(x)</td><td>返回x的正切值，其中，参数x为弧度值</td></tr><tr><td>ATAN(x)</td><td>返回x的反正切值，即返回正切值为x的值</td></tr><tr><td>ATAN2(m,n)</td><td>返回两个参数的反正切值</td></tr><tr><td>COT(x)</td><td>返回x的余切值，其中，x为弧度值</td></tr></tbody></table><p><strong>指数与对数函数</strong></p><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>POW(x,y), POWER(x,y)</td><td>返回x的y次方</td></tr><tr><td>EXP(x)</td><td>返回e的x次方，其中e是一个常数，2.718281828459045</td></tr><tr><td>LN(x), LOG(x)</td><td>返回以e为底的x的对数，当x&lt;=0时，返回的结果为NULL</td></tr><tr><td>LOG10(x)</td><td>返回以10为底的x的对数，当x&lt;=0时，返回的结果为NULL</td></tr><tr><td>LOG2(x)</td><td>返回以2为底的x的对数，当x&lt;=0时，返回NULL</td></tr></tbody></table><p><strong>进制间的转化函数</strong></p><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>BIN(x)</td><td>返回x的二进制编码</td></tr><tr><td>HEX(x)</td><td>返回x的十六进制编码</td></tr><tr><td>OCT(x)</td><td>返回x的八进制编码</td></tr><tr><td>CONV(x,f1,f2)</td><td>返回x以f1进制数变成f2进制数的数</td></tr></tbody></table><h3 id=字符串函数><a class=anchor href=#字符串函数>#</a> 字符串函数</h3><p>MySQL中，字符串的位置是从1开始的。</p><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>ASCII(s)</td><td>返回字符串s中的第一个字符的ASCII码值</td></tr><tr><td>CHAR_LENGTH(s)</td><td>返回字符串s的字符数。作用与CHARACTER_LENGTH(s)相同</td></tr><tr><td>CONCAT(s1,s2,...,sn)</td><td>返回字符串s的字符数，和字符集有关</td></tr><tr><td>CONCAT_WS(x,s1,s2,...,sn)</td><td>连接s1,s2,...,sn为一个字符串</td></tr><tr><td>INSERT(str,idx,len,replacestr)</td><td>与CAT(s1,s2,...)函数相同，但是每个字符串之间要加上x</td></tr><tr><td>REPLACE(str,a,b)</td><td>用字符串b替换字符串str中所有出现的字符串a</td></tr><tr><td>UPPER(s)或UCASE(s)</td><td>将字符串s的所有字母转成大写字母</td></tr><tr><td>LOWER(s)或LCASE(s)</td><td>将字符串s的所有字母转成小写字母</td></tr><tr><td>LEFT(str,n)</td><td>返回字符串str最左边的n个字符</td></tr><tr><td>RIGHT(str,n)</td><td>返回字符串str最右边的n个字符</td></tr><tr><td>LPAD(str,len,pad)</td><td>用字符串pad对str最左边进行填充，直到str的长度为len个字符</td></tr><tr><td>RPAD(str,len,pad)</td><td>用字符串pad对str最右边进行填充，直到str的长度为len个字符</td></tr><tr><td>LTRIM(s)</td><td>去掉字符串s左侧的空格</td></tr><tr><td>RTRIM(s)</td><td>去掉字符串s右侧的空格</td></tr><tr><td>TRIM(s)</td><td>去掉字符串s开始与结尾的空格</td></tr><tr><td>TRIM(s1 FROM s)</td><td>去掉字符串s开始于结尾的s1</td></tr><tr><td>TRIM(LEADING s1 FROM s)</td><td>去掉字符串s开始处的s1</td></tr><tr><td>TRIM(TRAILING s1 FROM s)</td><td>去掉字符串s结尾处的s1</td></tr><tr><td>REPEAT(str,n)</td><td>返回str重复n次的结果</td></tr><tr><td>SPACE(n)</td><td>返回n个空格</td></tr><tr><td>STRCMP(s1,s2)</td><td>比较字符串s1,s2的ASCII码值的大小</td></tr><tr><td>SUBSTR(s,index,len)</td><td>返回从字符串s的index位置开始的len个字符，作用与SUBSTRING(s,n,len)，MID(s,n,len)相同</td></tr><tr><td>LOCATE(substr,str)</td><td>返回字符串substr在字符串str中首次出现的位置，作用域POSITION(substr IN str)，INSTR(str,substr)相同。未找到，返回0</td></tr><tr><td>ELT(m,s1,s2,...,sn)</td><td>返回指定位置的字符串，如果m=1，则返回s1；如果m=2，则返回s2，如果m=n，则返回sn</td></tr><tr><td>FIELD(m,s1,s2,...,sn)</td><td>返回字符串s在字符串列表中第一次出现的位置</td></tr><tr><td>FIND_IN_SET(s1,s2)</td><td>返回字符串s1在字符串s2中出现的位置。其中，字符串s2是一个以逗号分隔的字符串</td></tr><tr><td>REVERSE(s)</td><td>返回s反转后的字符串</td></tr><tr><td>NULLIF(value1,value2)</td><td>比较两个字符串，如果value1与value2相等，则返回NULL，否则返回value1</td></tr></tbody></table><h3 id=日期和时间函数><a class=anchor href=#日期和时间函数>#</a> 日期和时间函数</h3><p><strong>获取日期/时间的函数</strong></p><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>CURDATE(), CURRENT_DATE()</td><td>返回当前日期，只包含年，月，日</td></tr><tr><td>CURTIME(), CURRENT_TIME()</td><td>返回当前时间，只包含时，分，秒</td></tr><tr><td>NOW() / SYSDATE() / CURRENT_TIMESTAMP() / LOCALTIME() / LOCALTIMESTAMP()</td><td>返回当前系统日期和时间</td></tr><tr><td>UTC_DATE()</td><td>返回UTC(世界标准时间)日期</td></tr><tr><td>UTC_TIME()</td><td>返回UTC(世界标准时间)时间</td></tr></tbody></table><p><strong>日期与时间戳的转化函数</strong></p><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>UNIX_TIMESTAMP()</td><td>以UNIX时间戳的形式返回当前时间。SELECT UNIX_TIMESTAMP() -&gt; 1634348884</td></tr><tr><td>UNIX_TIMESTAMP(date)</td><td>将时间date以UNIX时间戳的形式返回</td></tr><tr><td>FROM_UNIXTIME(timestamp)</td><td>将UNIX时间戳的时间转换为普通格式的时间</td></tr></tbody></table><p><strong>获取月份/星期/星期数/天数等函数</strong></p><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>YEAR(date) / MONTH(date) / DAY(date)</td><td>返回具体的日期值</td></tr><tr><td>HOUR(time) / MINUTE(time) / SECOND(time)</td><td>返回具体的时间值</td></tr><tr><td>MONTHNAME(date)</td><td>返回月份</td></tr><tr><td>DAYNAME(date)</td><td>返回星期几</td></tr><tr><td>WEEKDATY(date)</td><td>返回周几，周一是0，周二是1，周日是6</td></tr><tr><td>QUARTER(date)</td><td>返回日期对应的季度，范围为1~4</td></tr><tr><td>WEEK(date), WEEKOFYEAR(date)</td><td>返回一年中的第几周</td></tr><tr><td>DAYOFYEAR(date)</td><td>返回日期是一年中的第几天</td></tr><tr><td>DAYOFMONTH(date)</td><td>返回日期位于所在月份的第几天</td></tr><tr><td>DAYOFWEEK(date)</td><td>返回周几，周日是1，周一是2，...周六是7</td></tr></tbody></table><p><strong>日期的操作函数</strong></p><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>EXTRACT(type FROM date)</td><td>返回指定日期中特定的部分，type指定返回的值</td></tr></tbody><tbody><tr><td>type取值</td><td>含义</td></tr><tr><td>-------------------</td><td>----------------------------</td></tr><tr><td>MICROSECOND</td><td>返回毫秒数</td></tr><tr><td>SECOND</td><td>返回秒数</td></tr><tr><td>MINUTE</td><td>返回分钟数</td></tr><tr><td>HOUR</td><td>返回小时数</td></tr><tr><td>DAY</td><td>返回天数</td></tr><tr><td>WEEK</td><td>返回日期在一年中的第几个星期</td></tr><tr><td>MONTH</td><td>返回日期在一年中的第几个月</td></tr><tr><td>QUARTER</td><td>返回日期在一年中的第几个季度</td></tr><tr><td>YEAR</td><td>返回日期的年份</td></tr><tr><td>SECOND_MIRCROSECOND</td><td>返回秒和毫秒值</td></tr><tr><td>MINUTE_MICROSECOND</td><td>返回分钟和毫秒值</td></tr><tr><td>MINUTE_SECOND</td><td>返回分钟和毫秒值</td></tr><tr><td>HOUR_MICROSECOND</td><td>返回小时和毫秒值</td></tr><tr><td>HOUR_SECOND</td><td>返回小时和秒值</td></tr><tr><td>HOUR_MINUTE</td><td>返回小时和分钟值</td></tr><tr><td>DAY_MICROSECOND</td><td>返回天和毫秒值</td></tr><tr><td>DAY_SECOND</td><td>返回天和秒值</td></tr><tr><td>DAY_MINUTE</td><td>返回天和分钟值</td></tr><tr><td>DAY_HOUR</td><td>返回天和小时</td></tr><tr><td>YEAR_MONTH</td><td>返回年和月</td></tr></tbody></table><p><strong>时间和秒钟转换函数</strong></p><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>TIME_TO_SEC(time)</td><td>将time转化为秒并返回结果值。转化的公司为：小时 * 3600 + 分钟 * 60 + 秒</td></tr><tr><td>SEC_TO_TIME(second)</td><td>将seconds描述转化为包含小时，分钟和秒的时间</td></tr></tbody></table><p><strong>计算日期和时间的函数</strong></p><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>DATE_ADD(datetime,INTERVAL expr type), ADDDATE(date&lt;INTERVAL expr type)</td><td>返回与给定日期时间相差INTERVAL时间短的日期时间</td></tr><tr><td>DATE_SUB(date,INTERVAL expr type), SUBDATE(date,INTERVAL expr type)</td><td>返回与date相差INTERVAL时间间隔的日期</td></tr></tbody><tbody><tr><td>type(间隔类型)</td><td>含义</td></tr><tr><td>--------------</td><td>----------</td></tr><tr><td>HOUR</td><td>小时</td></tr><tr><td>MINUTE</td><td>分钟</td></tr><tr><td>SECOND</td><td>秒</td></tr><tr><td>YEAR</td><td>年</td></tr><tr><td>MONTH</td><td>月</td></tr><tr><td>DAY</td><td>日</td></tr><tr><td>YEAR_MONTH</td><td>年和月</td></tr><tr><td>DAY_HOUR</td><td>日和小时</td></tr><tr><td>DAY_MINUTE</td><td>日和分钟</td></tr><tr><td>DAY_SECOND</td><td>日和秒</td></tr><tr><td>HOUR_MINUTE</td><td>小时和分钟</td></tr><tr><td>HOUR_SECOND</td><td>小时和秒</td></tr><tr><td>MINUTE_SECOND</td><td>分钟和秒</td></tr></tbody><tbody><tr><td>函数名</td><td>作用</td></tr><tr><td>----------------------------</td><td>------------------------------------------------------------</td></tr><tr><td>ADDTIME(time1,time2)</td><td>返回time1加上time2的时间。当time2为一个数字时，代表的是秒，可以为负数</td></tr><tr><td>SUBTIME(time1,time2)</td><td>返回time1减去time2后的时间。当time2为一个数字时，代表的是秒，可以为负数</td></tr><tr><td>DATEDIFF(date1,date2)</td><td>返回date1 - date2的日期间隔天数</td></tr><tr><td>TIMEDIFF(time1,time2)</td><td>返回date1- date2的时间间隔</td></tr><tr><td>FROM_DAYS(n)</td><td>返回从0000年1月1日起，N天以后的日期</td></tr><tr><td>TO_DAYS(date)</td><td>返回日期date距离0000年1月1日的天数</td></tr><tr><td>LAST_DAY(date)</td><td>返回date所在月份的最后一天的日期</td></tr><tr><td>MAKEDATE(year,n)</td><td>针对给定年份与所在年份中的天数返回一个日期</td></tr><tr><td>MAKETIME(hour,minute,second)</td><td>将给定的小时，分钟和秒组合成时间并返回</td></tr><tr><td>PERIOD_ADD(time,n)</td><td>返回time加上n后的时间</td></tr></tbody></table><p><strong>日期的格式化与解析函数</strong></p><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>DATE_FORMAT(date,fmt)</td><td>按照字符串fmt格式化日期date值</td></tr><tr><td>TIME_FORMAT(time,fmt)</td><td>按照字符串fmt格式化时间time值</td></tr><tr><td>GET_FORMAT(date_type,format_type)</td><td>返回日期字符串的显示格式</td></tr><tr><td>STR_TO_DATE(str,fmt)</td><td>按照字符串fmt对str进行解析，解析为一个日期</td></tr></tbody></table><p>上述非GET_FORMAT函数中fmt参数常用的格式符</p><table><thead><tr><th>格式符</th><th>说明</th><th>格式符</th><th>说明</th></tr></thead><tbody><tr><td>%Y</td><td>4位数字表示年份</td><td>%y</td><td>表示两位数字表示年份</td></tr><tr><td>%M</td><td>月名表示月份</td><td>%m</td><td>两位数字表示月份</td></tr><tr><td>%b</td><td>缩写的月名</td><td>%c</td><td>数字表示月份</td></tr><tr><td>%D</td><td>英文后缀表示月中的天数</td><td>%d</td><td>两位数字表示月中的天数</td></tr><tr><td>%e</td><td>数字形式表示月中的天数</td><td></td><td></td></tr><tr><td>%H</td><td>两位数字表示小时，24小时制</td><td>%h和%l</td><td>两位数字表示小时，12小时制</td></tr><tr><td>%k</td><td>数字形式的小时，24小时制</td><td>%l</td><td>数字形式表示小时，12小时制</td></tr><tr><td>%i</td><td>两位数字表示分钟</td><td>%S和%s</td><td>两位数字表示秒</td></tr><tr><td>%W</td><td>一周中的星期名称</td><td>%a</td><td>一周中的星期缩写</td></tr><tr><td>%w</td><td>以数字表示周中的天数</td><td></td><td></td></tr><tr><td>%j</td><td>以3位数字表示年中的天数</td><td>%U</td><td>以数字表示年中的第几周，其中Sunday为周中第一天</td></tr><tr><td>%u</td><td>以数字表示年中的第几周，其中Monday为周中第一天</td><td></td><td></td></tr><tr><td>%T</td><td>24小时制</td><td>%r</td><td>12小时制</td></tr><tr><td>%p</td><td>AM或PM</td><td>%%</td><td>表示%</td></tr></tbody></table><p>GET_FORMAT函数中date_type和format_type参数取值</p><table><thead><tr><th>日期类型</th><th>格式化类型</th><th>返回的格式化字符串</th></tr></thead><tbody><tr><td>DATE</td><td>USA</td><td>%m.%d.%Y</td></tr><tr><td>DATE</td><td>JIS</td><td>%Y-%m-%d</td></tr><tr><td>DATE</td><td>ISO</td><td>%Y-%m-%d</td></tr><tr><td>DATE</td><td>EUR</td><td>%d.%m.%Y</td></tr><tr><td>DATE</td><td>INTERNAL</td><td>%Y%m%d</td></tr><tr><td>TIME</td><td>USA</td><td>%h:%i:%s %p</td></tr><tr><td>TIME</td><td>JIS</td><td>%H:%i:%s</td></tr><tr><td>TIME</td><td>ISO</td><td>%H:%i:%s</td></tr><tr><td>TIME</td><td>EUR</td><td>%H.%i.%s</td></tr><tr><td>TIME</td><td>INTERNAL</td><td>%H%i%s</td></tr><tr><td>DATETIME</td><td>USA</td><td>%Y-%m-%d %H.%i.%s</td></tr><tr><td>DATETIME</td><td>JIS</td><td>%Y-%m-%d %H:%i:%s</td></tr><tr><td>DATETIME</td><td>ISO</td><td>%Y-%m-%d %H:%i:%s</td></tr><tr><td>DATETIME</td><td>EUR</td><td>%Y-%m-%d %H.%i.%s</td></tr><tr><td>DATETIME</td><td>INTERNAL</td><td>%Y%m%d%H%i%s</td></tr></tbody></table><h3 id=流程控制函数><a class=anchor href=#流程控制函数>#</a> 流程控制函数</h3><p>流程处理函数可以根据不同的条件，执行不同的处理流程，可以在SQL语句中实现不同的条件选择。MySQL中的流程处理函数主要包括IF()，IFNULL()和CASE()函数。</p><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>IF(value,value1,value2)</td><td>如果value的值为TRUE，返回value1，否则返回value2</td></tr><tr><td>IFNULL(value1,value2)</td><td>如果value1不为NULL，返回value1，否则返回value2</td></tr><tr><td>CASE WHEN 条件1 THEN 结果1 WHEN 条件2 THEN 结果2...[ELSE resultn] END</td><td>相当于Java的if...else if...else...</td></tr><tr><td>CASE expr WHEN 常量值1 THEN 值1 WHEN 常量值1 ... [ELSE 值n] END</td><td>相当于Java的switch...case...</td></tr></tbody></table><h3 id=加密与解密函数><a class=anchor href=#加密与解密函数>#</a> 加密与解密函数</h3><p>加密与解密函数主要用于对数据库中的数据进行加密和解密处理，以防止数据被他人窃取。这些函数在保证数据库安全时非常有用。</p><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>PASSWORD(str)</td><td>返回字符串str的加密版本，41位长的字符串。加密结果不可逆，常用于用户的密码加密</td></tr><tr><td>MD5(str)</td><td>返回字符串str的md5加密后的值，也是一种加密方式。若参数为NULL，则会返回NULL</td></tr><tr><td>SHA(str)</td><td>从原明文密码str计算并返回加密后的密码字符串，当参数为NULL时，返回NULL。SHA加密算法比MD5更加安全。</td></tr><tr><td>ENCODE(value,password_seed)</td><td>返回使用password_seed作为加密密码加密value</td></tr><tr><td>DECODE(value,password_seed)</td><td>返回使用password_seed作为加密密码解密value</td></tr></tbody></table><h3 id=mysql信息函数><a class=anchor href=#mysql信息函数>#</a> MySQL信息函数</h3><p>MySQL中内置了一些可以查询MySQL信息的函数，这些函数主要用于帮助数据库开发或运维人员更好地对数据库进行维护工作。</p><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>VERSION()</td><td>返回当前MySQL的版本号</td></tr><tr><td>CONNECTION_ID()</td><td>返回当前MySQL服务器的连接数</td></tr><tr><td>DATABASE(), SCHEMA()</td><td>返回MySQL命令行当前所在的数据库</td></tr><tr><td>USER(), CURRENT_USER(), SYSTEM_USER(), SESSION_USER()</td><td>返回当前连接MySQL的用户名，返回结果格式为“主机名@用户名”</td></tr><tr><td>CHARSET(value)</td><td>返回字符串value自变量的字符集</td></tr><tr><td>COLLATION(value)</td><td>返回字符串value的比较规则</td></tr></tbody></table><h3 id=其他函数><a class=anchor href=#其他函数>#</a> 其他函数</h3><p>MySQL中有些函数无法对其进行具体的分类，但是这些函数在MySQL的开发和运维过程中也是不容忽视的。</p><table><thead><tr><th>函数名</th><th>作用</th></tr></thead><tbody><tr><td>FORMAT(value,n)</td><td>返回对数字value进行格式化后的结果数据。n表示四舍五入后保留到小数点后n位</td></tr><tr><td>CONV(value,from,to)</td><td>将value的值进行不同进制之间的转换</td></tr><tr><td>INET_ATON(ipvalue)</td><td>将以点分隔的IP地址转化为一个数字</td></tr><tr><td>INET_NTOA(value)</td><td>将数字形式的IP地址转化为以点分隔的IP地址</td></tr><tr><td>GENCHMARK(n,expr)</td><td>将表达式expr重复执行n次。用于测试MySQL处理expr表达式所耗费的时间</td></tr><tr><td>CONVERT(value USING char_code)</td><td>将value所使用的字符编码修改为char_code</td></tr></tbody></table><p><strong>单行函数练习/案例</strong></p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 显示系统时间(日期 + 时间) */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">SELECT</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>SYSDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>LOCALTIME<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>LOCALTIMESTAMP<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=4></td><td><pre></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token comment">/* 查询员工号，姓名，工资，以及工资提高百分之二十后的结果(new salary) */</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>salary<span class="token punctuation">,</span>salary <span class="token operator">*</span> <span class="token number">1.2</span> <span class="token string">"new salary"</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token comment">/* 将员工的姓名按首字母排序，并写出姓名的长度(length) */</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>LENGTH<span class="token punctuation">(</span>last_name<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> last_name <span class="token keyword">ASC</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token comment">/* 查询员工id,last_name,salary,并作为一个列输出，别名为OUT_PUT */</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span>employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>salary<span class="token punctuation">)</span> <span class="token string">"OUT_PUT"</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=17></td><td><pre></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token comment">/* 查询公司各员工工作的年数，工作的天数，并按工作年数的降序排序 */</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>DATEDIFF<span class="token punctuation">(</span>CURADTE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>hire_date<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">365</span> <span class="token string">"worked_years"</span><span class="token punctuation">,</span>DATEDIFF<span class="token punctuation">(</span>CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>hire_date<span class="token punctuation">)</span> <span class="token string">"worked_days"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=20></td><td><pre>TO_DAYS<span class="token punctuation">(</span>CURATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> TO_DAYS<span class="token punctuation">(</span>hire_date<span class="token punctuation">)</span> <span class="token string">"worked_days1"</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token keyword">FROM</span> emplooyees</pre></td></tr><tr><td data-num=22></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> worked_years <span class="token keyword">DESC</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=23></td><td><pre></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token comment">查询员工姓名,hire_date,department_id,满足以下条件：</span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token comment">雇用时间在1997年之后，department_id为80或90或10，commission_pct不为空</span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>hire_date<span class="token punctuation">,</span>department_id</pre></td></tr><tr><td data-num=29></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=30></td><td><pre><span class="token keyword">WHERE</span> department_id <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token operator">AND</span> commission_pct  <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span></pre></td></tr><tr><td data-num=32></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=33></td><td><pre><span class="token comment">AND hire_date >= '1997-01-01'; 存在着隐式转换 </span></pre></td></tr><tr><td data-num=34></td><td><pre><span class="token comment">AND date_format(hire_date,'%Y-%m-%d') >= '1997-01-01';显示转换操作，格式化，日期→字符串</span></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token comment">AND date_format(hire_date,'%Y') >= '1997';显示转换操作，格式化</span></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token operator">AND</span> hire_date <span class="token operator">>=</span> STR_TO_DATE<span class="token punctuation">(</span><span class="token string">'1997-01-01'</span><span class="token punctuation">,</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* 显示转换操作，解析，字符串→日期 */</span></pre></td></tr><tr><td data-num=38></td><td><pre></pre></td></tr><tr><td data-num=39></td><td><pre><span class="token comment">/* 查询公司中入职超过10000天的员工姓名，入职时间 */</span></pre></td></tr><tr><td data-num=40></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>hire_date</pre></td></tr><tr><td data-num=41></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=42></td><td><pre><span class="token keyword">WHERE</span> DATEDIFF<span class="token punctuation">(</span>CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>hire_date<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">10000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=43></td><td><pre></pre></td></tr><tr><td data-num=44></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=45></td><td><pre><span class="token comment">做一个查询，产生下面的结果</span></pre></td></tr><tr><td data-num=46></td><td><pre><span class="token comment">&lt;last_name> earns &lt;salary>monthly but wants &lt;salary * 3></span></pre></td></tr><tr><td data-num=47></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=48></td><td><pre><span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span>last_name<span class="token punctuation">,</span><span class="token string">' earns '</span><span class="token punctuation">,</span><span class="token keyword">TRUNCATE</span><span class="token punctuation">(</span>salary<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">' monthly but wants '</span><span class="token punctuation">,</span><span class="token keyword">TRUNCATE</span><span class="token punctuation">(</span>salary <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">"Dream Salary"</span></pre></td></tr><tr><td data-num=49></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=50></td><td><pre></pre></td></tr><tr><td data-num=51></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=52></td><td><pre><span class="token comment">使用case-when,按照下面的条件</span></pre></td></tr><tr><td data-num=53></td><td><pre><span class="token comment">job			grade</span></pre></td></tr><tr><td data-num=54></td><td><pre><span class="token comment">AD_PRES		 A</span></pre></td></tr><tr><td data-num=55></td><td><pre><span class="token comment">ST_MAN		 B</span></pre></td></tr><tr><td data-num=56></td><td><pre><span class="token comment">IT_PROG		 C</span></pre></td></tr><tr><td data-num=57></td><td><pre><span class="token comment">SA_REP		 D</span></pre></td></tr><tr><td data-num=58></td><td><pre><span class="token comment">ST_CLERK	 E</span></pre></td></tr><tr><td data-num=59></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=60></td><td><pre><span class="token keyword">SELECT</span> last_name <span class="token string">"Last_name"</span><span class="token punctuation">,</span>job_id <span class="token string">"Job_id"</span><span class="token punctuation">,</span><span class="token keyword">CASE</span> job_id <span class="token keyword">WHEN</span> <span class="token string">'AD_PRES'</span> <span class="token keyword">THEN</span> <span class="token string">'A'</span></pre></td></tr><tr><td data-num=61></td><td><pre>														 <span class="token keyword">WHEN</span> <span class="token string">'ST_MAN'</span> <span class="token keyword">THEN</span> <span class="token string">'B'</span></pre></td></tr><tr><td data-num=62></td><td><pre>														 <span class="token keyword">WHEN</span> <span class="token string">'IT_PROG'</span> TEHN <span class="token string">'C'</span></pre></td></tr><tr><td data-num=63></td><td><pre>														 <span class="token keyword">WHEN</span> <span class="token string">'SA_REP'</span> <span class="token keyword">THEN</span> <span class="token string">'D'</span></pre></td></tr><tr><td data-num=64></td><td><pre>														 <span class="token keyword">WHEN</span> <span class="token string">'ST_CLERK'</span> <span class="token keyword">THEN</span> <span class="token string">'E'</span></pre></td></tr><tr><td data-num=65></td><td><pre>														 <span class="token keyword">END</span> <span class="token string">"Grade"</span></pre></td></tr><tr><td data-num=66></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id=聚合函数><a class=anchor href=#聚合函数>#</a> 聚合函数</h2><p>聚合(或聚集，分组)函数，它是对一组数据进行汇总的函数，输入是一组数据的集合，输出的是单个值。</p><p>聚合函数类型</p><ul><li>AVG()</li><li>SUM()</li><li>MAX()</li><li>MIN()</li><li>COUNT()</li></ul><p>聚合函数语法</p><figure class="highlight tex"><figcaption data-lang=TeX></figcaption><table><tr><td data-num=1></td><td><pre>SELECT <span class="token punctuation">[</span>column,<span class="token punctuation">]</span> group function(column),...</pre></td></tr><tr><td data-num=2></td><td><pre>FROM table</pre></td></tr><tr><td data-num=3></td><td><pre><span class="token punctuation">[</span>WHERE condition<span class="token punctuation">]</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token punctuation">[</span>GROUP BY column<span class="token punctuation">]</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token punctuation">[</span>ORDER BY column<span class="token punctuation">]</span>;</pre></td></tr></table></figure><p><strong>常见的几个聚合函数</strong></p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token comment">AVG(平均值) / SUM(求和)</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token comment">只适用于数值类型的字段(或变量)</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">107</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token comment">MAX(最大) / MIN(最小) </span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token comment">适用于数值类型，字符串类型，日期时间类型的字段(或变量)</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token comment">/* COUNT */</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token comment">/* 计算指定字段在查询结构中出现的个数 */</span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>employee_id<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token comment">计算表中有多少条记录，如何实现? </span></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token comment">COUNT(*);</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token comment">COUNT(1);</span></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=25></td><td><pre></pre></td></tr><tr><td data-num=26></td><td><pre></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token comment">/* 计算指定字段  */</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=30></td><td><pre></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token keyword">SELECT</span> commission_pct</pre></td></tr><tr><td data-num=32></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=33></td><td><pre><span class="token keyword">WHERE</span> commission_pct <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=34></td><td><pre></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token comment">/* AVG = SUM / COUNT */</span></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token function">AVG</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=38></td><td><pre><span class="token function">SUM</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">107</span></pre></td></tr><tr><td data-num=39></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=40></td><td><pre></pre></td></tr><tr><td data-num=41></td><td><pre><span class="token comment">/* 查询公司中平均奖金率 */</span></pre></td></tr><tr><td data-num=42></td><td><pre><span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>commission_pct<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>IFNULL<span class="token punctuation">(</span>commission_pct<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=43></td><td><pre><span class="token function">AVG</span><span class="token punctuation">(</span>IFNULL<span class="token punctuation">(</span>commission_pct<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=44></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>GROUP BY的使用</strong></p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 查询各个部门的平均工资，最高工资 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">SELECT</span> department<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token comment">/* 查询各个job_id的平均工资 */</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">SELECT</span> job_id<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token comment">/* 查询各个department_id,job_id的平均工资 */</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">SELECT</span> department_id<span class="token punctuation">,</span>job_id<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id<span class="token punctuation">,</span>job_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">SELECT</span> department_id<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id <span class="token keyword">WITH ROLLUP</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token comment">/* 查询各个部门的平均工资，按照平均工资升序排序 */</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token keyword">SELECT</span> department_id<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> avg_sal</pre></td></tr><tr><td data-num=22></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=23></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id</pre></td></tr><tr><td data-num=24></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> avg_sal <span class="token keyword">ASC</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=25></td><td><pre></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token comment">当使用ROLLUP时，不能同时使用ORDER BY子句进行结果排序，即ROLLUP和ORDER BY是互相排除的</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token comment">/* 错误案例 */</span></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token keyword">SELECT</span> department_id<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> avg_sal</pre></td></tr><tr><td data-num=31></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=32></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id <span class="token keyword">WITH ROLLUP</span></pre></td></tr><tr><td data-num=33></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> avg_sal <span class="token keyword">ASC</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>SELECT中出现的非组函数的字段必须声明在GROUP BY中。反之，GROUP BY中声明的字段可以不出现在SELECT中。</p><p>GROUP BY声明在FROM后面，WHERE后面，ORDER BY前面，LIMIT前面。</p><p>MySQL中GROUP BY中使用WITH ROLLUP。</p><p><strong>HAVING的使用</strong></p><p>如果过滤条件中使用了聚合函数，则必须使用HAVING来替换WHERE.否则，报错。<br>HAVING必须声明在GROUP BY的后面。</p><p>使用HAVING的前提是使用了GROUP BY。</p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 查询各个部门中最高工资比1000高的部门信息 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">SELECT</span> department_id<span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id</pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">HAVING</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=6></td><td><pre></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token comment">/* 查询部门id为10，20，30，40这4个部门中最高工资比10000高的部门信息 */</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">SELECT</span> department_id<span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">WHERE</span> department_id <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id</pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">HAVING</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">10000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">SELECT</span> department_id<span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id</pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">HAVING</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">10000</span> <span class="token operator">AND</span> department_id <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=18></td><td><pre></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token comment">当过滤条件中有聚合函数时，则此过滤条件必须声明在HAVING中。</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token comment">当过滤条件中没有聚合函数时，则此过滤条件声明在WHERE中或HAVING中都可以。但，建议声明在WHERE中。</span></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token comment">WHERE与HAVING的对比</span></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token comment">从适用范围上来讲，HAVING的适用范围更广。</span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token comment">如果过滤条件中没有聚合函数，这种情况下，WHERE的执行效率要高于HAVING</span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token comment">*/</span></pre></td></tr></table></figure><p><strong>SQL底层执行原理</strong></p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token comment">sql92语法</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token comment">SELECT ...,...,...(存在聚合函数)</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token comment">FROM ...,...,...</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token comment">WHERE 多表的连接条件 AND 不包含聚合函数的过滤条件</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token comment">GROUP BY</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token comment">HAVING 包含聚合函数的过滤条件</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token comment">ORDER BY ...,...(ASC / DESC)</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token comment">LIMIT ...,...</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=11></td><td><pre></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token comment">sql99语法</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token comment">SELECT ...,...,..(存在聚合函数)</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token comment">FROM ...(LEFT/RIGHT)JOIN ... ON 多表的连接条件</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token comment">(LEFT / RIGHT)JOIN ... ON ...</span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token comment">WHERE 不包含聚合函数的过滤条件</span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token comment">GROUP BY ...,...</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token comment">HAVING 包含聚合函数的过滤条件</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token comment">ORDER BY ...,...(ASC / DESC)</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token comment">LIMIT ...,...</span></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token comment">SQL语句的执行过程</span></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token comment">FROM ...,... -> ON -> (left / RIGHT JOIN) -> WHERE -> GROUP BY -> HAVING -> SELECT -></span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token comment">DISTINCT -> ORDER BY -> LIMIT</span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token comment">*/</span></pre></td></tr></table></figure><p>在SELECT语句执行这些步骤的时候都会产生一个虚拟表，然后将这个虚拟表传入下一个步骤中作为输入。需要注意的是，这些步骤隐含在SQL的执行过程中，是看不见的。</p><p>SELECT是先执行FROM这一步的。在这个阶段，如果是多张表联查，还会经历下面的几个步骤</p><ul><li><p>首先先通过CROSS JOIN求笛卡尔积，相当于得到虚拟表vt(virtual table)1-1</p></li><li><p>通过ON进行筛选，在虚拟表vt1-1的基础上进行筛选，得到虚拟表vt1-2</p></li><li><p>添加外部行。如果我们使用的是左连接，右连接或者全连接，就会涉及到外部行，也就是在虚拟表vt1-2的基础上增加外部行，得到虚拟表vt1-3</p></li></ul><p>如果操作的是两张以上的表，还会重复上面的步骤，直到所有表都被处理为止。这个过程便得到了原始数据。</p><p>当拿到数据表的原始数据，就是最终的虚拟表vt1，就在此基础上再进行WHERE阶段。在这个阶段中，会根据vt1表的结果进行筛选过滤，得到虚拟表vt2。</p><p>然后进入第三步和第四步，也就是<code>GROUP 和 HAVING阶段</code>。在这个阶段中，实际上是在虚拟表vt2的基础上进行分组和分组过滤，得到中间的虚拟表vt3和vt4。</p><p>当我们完成了条件筛选部分之后，就可以筛选表中提取的字段，也就进入到<code>SELECT和DISTINCT阶段</code>。</p><p>首先在SELECT阶段会提取想要的字段，然后在DISTINCT阶段过滤掉重复的行，分别得到中间的虚拟表vt5-1和vt5-2。</p><p>当提取了想要的字段数据之后，就可以按照指定的字段进行排序，也就是ORDER BY阶段，得到虚表vt6。</p><p>最后在vt6的基础上，取出指定行的记录，也就是LIMIT 阶段，得到最终的结果，对应的是虚拟表vt7。</p><p>当在写SELECT语句的时候，不一定存在所有的关键字，相应的阶段就会省略。</p><p>同时因为SQL是一门机构化查询语言，所以在写SELECT语句的时候，还要注意相应的关键字顺序，所谓底层运行的原理，就是讲到的执行顺序。</p><p><strong>聚合函数练习/案例</strong></p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* WHERE子句不可使用组函数进行过滤 */</span></pre></td></tr><tr><td data-num=2></td><td><pre></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token comment">/* 查询公司员工工资的最大值，最小值，平均值，总和 */</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">SELECT</span> job_id<span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token comment">/* 选择具有各个job_id的员工人数 */</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">SELECT</span> job_id<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>employee_id<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token comment">/* 查询员工最高工资和最低工资的差距(DIFFERENCE)*/</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token string">"DIFFERENCE"</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token comment">查询各个管理者手下员工的最低工资，其中最低工资不能低于6000，</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token comment">没有管理者的员工不计算在内</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token keyword">SELECT</span> manager_id<span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=23></td><td><pre><span class="token keyword">WHERE</span> manager_id <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> manager_id</pre></td></tr><tr><td data-num=25></td><td><pre><span class="token keyword">HAVING</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">6000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=26></td><td><pre></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token comment">/* 查询所有部门的名字，location_id，员工数量和平均工资，并按平均工资降序 */</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token keyword">SELECT</span> department_name<span class="token punctuation">,</span>location_id<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>employee_id<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token keyword">FROM</span> departments d <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> employees e</pre></td></tr><tr><td data-num=30></td><td><pre><span class="token keyword">ON</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> departmennt_name<span class="token punctuation">,</span>location_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=32></td><td><pre></pre></td></tr><tr><td data-num=33></td><td><pre><span class="token comment">/* 查询每个工种，每个部门的部门名，工种名和最低工资 */</span></pre></td></tr><tr><td data-num=34></td><td><pre><span class="token keyword">SELECT</span> d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>job_id<span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token keyword">FROM</span> departments d <span class="token keyword">JOIN</span> employees e</pre></td></tr><tr><td data-num=36></td><td><pre><span class="token keyword">ON</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_name<span class="token punctuation">,</span>job_id<span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id=子查询><a class=anchor href=#子查询>#</a> 子查询</h2><p>子查询指一个查询语句嵌套另一个查询语句内部的查询，这个特性从MySQL4.1开始引入。</p><p>SQL中子查询的使用大大增强了SELECT查询的能力，因为很多时候查询需要从结果集中获取数据，或者需要从同一个表中先计算得出一个数据结果，然后与这个数据结果(可能是某个标量，也可能是某个集合)进行比较。</p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 谁的工资比Abel的高 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token comment">/* 方式一 */</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">SELECT</span> salary</pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> <span class="token string">'Abel'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=6></td><td><pre></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">WHERE</span> salary <span class="token operator">></span> <span class="token number">11000</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token comment">/* 方式二，自连接 */</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">FROM</span> employees e1<span class="token punctuation">,</span>employees e2</pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">WHERE</span> e2<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>salary<span class="token punctuation">`</span></span> <span class="token operator">></span> e1<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>salary<span class="token punctuation">`</span></span> <span class="token comment">/* 多表的连接条件 */</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token operator">AND</span> e1<span class="token punctuation">.</span>last_name <span class="token operator">=</span> <span class="token string">'Abel'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token comment">/* 方式三，子查询 */</span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=19></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=20></td><td><pre><span class="token keyword">WHERE</span> salary <span class="token operator">></span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=21></td><td><pre>    	<span class="token keyword">SELECT</span> salary</pre></td></tr><tr><td data-num=22></td><td><pre>    	<span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=23></td><td><pre>    	<span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> <span class="token string">'Abel'</span></pre></td></tr><tr><td data-num=24></td><td><pre>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num=25></td><td><pre><span class="token comment">/* 称谓的规范:外查询(或主查询)，内查询(或子查询) */</span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token comment">子查询(内查询)在主查询之前一次执行完成</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token comment">子查询的结果被主查询(外查询)使用</span></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token comment">注意事项</span></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token comment">子查询要包含在括号内</span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token comment">将子查询放在比较条件的右侧</span></pre></td></tr><tr><td data-num=32></td><td><pre><span class="token comment">单行操作符对应单行子查询，多行操作符对应多行子查询</span></pre></td></tr><tr><td data-num=33></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=34></td><td><pre></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token comment">子查询的分类</span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token comment">角度1：从内查询返回的结果的条目数</span></pre></td></tr><tr><td data-num=38></td><td><pre><span class="token comment">		单行查询 vs 多行子查询</span></pre></td></tr><tr><td data-num=39></td><td><pre><span class="token comment">角度2：内查询是否被执行多次</span></pre></td></tr><tr><td data-num=40></td><td><pre><span class="token comment">		相关子查询 vs 不相关子查询</span></pre></td></tr><tr><td data-num=41></td><td><pre><span class="token comment">*/</span></pre></td></tr></table></figure><h3 id=子查询的分类><a class=anchor href=#子查询的分类>#</a> 子查询的分类</h3><p>按内查询的结果返回一条还是多条记录，将子查询分为单行子查询，多行子查询。</p><p>按内查询是否被执行多次，将子查询划分为相关(或关联)子查询和不相关(或非关联)子查询。</p><p>子查询从数据表中查询了数据结果，如果这个数据结果只执行一次，然后这个数据结果作为主查询的条件进行执行，那么这样的子查询叫做不相关子查询。</p><p>同样，如果子查询需要执行多次，即采用循环的方式，先从外部查询开始，每次都传入子查询进行查询，然后再将结果反馈给外部，这种嵌套的执行方式就称为相关子查询。</p><h3 id=单行子查询><a class=anchor href=#单行子查询>#</a> 单行子查询</h3><p><strong>单行比较操作符</strong></p><table><thead><tr><th>操作符</th><th>含义</th></tr></thead><tbody><tr><td>=</td><td>等于</td></tr><tr><td>&gt;</td><td>大于</td></tr><tr><td>&gt;=</td><td>大于等于</td></tr><tr><td>&lt;</td><td>小于</td></tr><tr><td>&lt;=</td><td>小于等于</td></tr><tr><td>&lt;&gt;</td><td>不等于</td></tr></tbody></table><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 子查询的编写技巧(或步骤)：从里往外写，从外往里写 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token comment">/* 查询工资大于149号员工工资的员工的信息 */</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">WHERE</span> salary <span class="token operator">></span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token keyword">SELECT</span> salary</pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> <span class="token number">149</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token comment">/* 返回job_id与141员工相同，salary比143号员工多的员工姓名，job_id和工资 */</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>job_id<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">WHERE</span> job_id <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=15></td><td><pre>        <span class="token keyword">SELECT</span> job_id</pre></td></tr><tr><td data-num=16></td><td><pre>        <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=17></td><td><pre>        <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> <span class="token number">141</span></pre></td></tr><tr><td data-num=18></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token operator">AND</span> salary <span class="token operator">></span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=20></td><td><pre>    <span class="token keyword">SELECT</span> salary</pre></td></tr><tr><td data-num=21></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=22></td><td><pre>    <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> <span class="token number">143</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token comment">/* 返回公司工资最小的员工的last_name,job_id和salary */</span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>job_id<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=27></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=28></td><td><pre><span class="token keyword">WHERE</span> salary <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=29></td><td><pre>    <span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=30></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=31></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=32></td><td><pre></pre></td></tr><tr><td data-num=33></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=34></td><td><pre><span class="token comment">查询与141号或174号员工的manager_id和department_id相同的其他员工</span></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token comment">的employee_id,manager_id,department_id</span></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>manager_id<span class="token punctuation">,</span>department_id</pre></td></tr><tr><td data-num=38></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=39></td><td><pre><span class="token keyword">WHERE</span> manager_id <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=40></td><td><pre>    <span class="token keyword">SELECT</span> manager_id</pre></td></tr><tr><td data-num=41></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=42></td><td><pre>    <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> <span class="token number">141</span></pre></td></tr><tr><td data-num=43></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num=44></td><td><pre><span class="token operator">AND</span> department_id <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=45></td><td><pre>    <span class="token keyword">SELECT</span> department_id</pre></td></tr><tr><td data-num=46></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=47></td><td><pre>    <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> <span class="token number">141</span></pre></td></tr><tr><td data-num=48></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num=49></td><td><pre><span class="token operator">AND</span> employee_id <span class="token operator">&lt;></span> <span class="token number">141</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=50></td><td><pre></pre></td></tr><tr><td data-num=51></td><td><pre><span class="token comment">/* 了解 */</span></pre></td></tr><tr><td data-num=52></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>manager_id<span class="token punctuation">,</span>department_id</pre></td></tr><tr><td data-num=53></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=54></td><td><pre><span class="token keyword">WHERE</span> <span class="token punctuation">(</span>manager_id<span class="token punctuation">,</span>department_id<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=55></td><td><pre>    <span class="token keyword">SELECT</span> manager_id<span class="token punctuation">,</span>department_id</pre></td></tr><tr><td data-num=56></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=57></td><td><pre>    <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> <span class="token number">141</span></pre></td></tr><tr><td data-num=58></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=59></td><td><pre><span class="token operator">AND</span> employee_id <span class="token operator">&lt;></span> <span class="token number">141</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=60></td><td><pre></pre></td></tr><tr><td data-num=61></td><td><pre><span class="token comment">/* 查询最低工资大于50号部门最低工资的部门id和其最低工资 */</span></pre></td></tr><tr><td data-num=62></td><td><pre><span class="token keyword">SELECT</span> department_id<span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=63></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=64></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id</pre></td></tr><tr><td data-num=65></td><td><pre><span class="token keyword">HAVING</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=66></td><td><pre>    <span class="token keyword">SELECT</span>  <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=67></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=68></td><td><pre>    <span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">50</span></pre></td></tr><tr><td data-num=69></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=70></td><td><pre></pre></td></tr><tr><td data-num=71></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=72></td><td><pre><span class="token comment">显式员工的employee_id,last_name和location</span></pre></td></tr><tr><td data-num=73></td><td><pre><span class="token comment">其中，若员工department_id与location_id为1800的department_id相同</span></pre></td></tr><tr><td data-num=74></td><td><pre><span class="token comment">则location为`Canada`，其余则为`USA`</span></pre></td></tr><tr><td data-num=75></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=76></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span><span class="token keyword">CASE</span> department_id <span class="token keyword">WHEN</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=77></td><td><pre>    <span class="token keyword">SELECT</span> department_id</pre></td></tr><tr><td data-num=78></td><td><pre>	<span class="token keyword">FROM</span> departments</pre></td></tr><tr><td data-num=79></td><td><pre>	<span class="token keyword">WHERE</span> location_id <span class="token operator">=</span> <span class="token number">1800</span></pre></td></tr><tr><td data-num=80></td><td><pre>	<span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token string">'Canada'</span> <span class="token keyword">ELSE</span> <span class="token string">'USA'</span> <span class="token keyword">END</span> <span class="token string">"location"</span></pre></td></tr><tr><td data-num=81></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=82></td><td><pre></pre></td></tr><tr><td data-num=83></td><td><pre><span class="token comment">/* 子查询中的空值问题 */</span></pre></td></tr><tr><td data-num=84></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>job_id</pre></td></tr><tr><td data-num=85></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=86></td><td><pre><span class="token keyword">WHERE</span> job_id <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=87></td><td><pre>    <span class="token keyword">SELECT</span> job_id</pre></td></tr><tr><td data-num=88></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=89></td><td><pre>    <span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> <span class="token string">'Haas'</span></pre></td></tr><tr><td data-num=90></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id=多行子查询><a class=anchor href=#多行子查询>#</a> 多行子查询</h3><p><strong>多行比较操作符</strong></p><table><thead><tr><th>操作符</th><th>含义</th></tr></thead><tbody><tr><td>IN</td><td>等于列表中的任意一个</td></tr><tr><td>ANY</td><td>需要和单行比较操作符一起使用，和子查询返回的某一个值比较</td></tr><tr><td>ALL</td><td>需要和单行比较操作符一起使用，和子查询返回的所有值比较</td></tr><tr><td>SOME</td><td>实际上是ANY的别名，作用相同，一般常使用ANY</td></tr></tbody></table><h3 id=相关子查询><a class=anchor href=#相关子查询>#</a> 相关子查询</h3><p>如果子查询的执行依赖于外部查询，通常情况下都是因为子查询中的表用到了外部的表，并进行了条件关联，因为每执行一次外部查询，子查询都要重新计算一次，这样的子查询就称为关联子查询。</p><p>相关子查询按照一行接一行的顺序执行，主查询的每一行都执行一次子查询。</p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 查询员工中工资大于本部门平均工资的员工的last_name,salary和其department_id */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token comment">/* 使用相关子查询 */</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>salary<span class="token punctuation">,</span>department_id</pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">FROM</span> employees e1</pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">WHERE</span> salary <span class="token operator">></span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">FROM</span> employees e2</pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> e1<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token comment">/* 在FROM中声明子查询 */</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>salary<span class="token punctuation">,</span>e<span class="token punctuation">.</span>department_id</pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token keyword">SELECT</span> department_id<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> avg_sal</pre></td></tr><tr><td data-num=15></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=16></td><td><pre>    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id<span class="token punctuation">)</span> t_dept_avg_sal</pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> t_dept_avg_sal<span class="token punctuation">.</span>department_id</pre></td></tr><tr><td data-num=18></td><td><pre><span class="token operator">AND</span> e<span class="token punctuation">.</span>salary <span class="token operator">></span> t_dept_avg_sal<span class="token punctuation">.</span>avg_sal<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token comment">/* 查询员工的id,salary,按照department_name 排序 */</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=22></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=23></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=24></td><td><pre>    <span class="token keyword">SELECT</span> department_name</pre></td></tr><tr><td data-num=25></td><td><pre>    <span class="token keyword">FROM</span> departments d</pre></td></tr><tr><td data-num=26></td><td><pre>    <span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token punctuation">)</span> <span class="token keyword">ASC</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=28></td><td><pre></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token comment">在SELECT中，除了GROUP BY和LIMIT之外，其他位置都可以声明子查询</span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token comment">SELECT ...,...,..(存在聚合函数)</span></pre></td></tr><tr><td data-num=32></td><td><pre><span class="token comment">FROM ...(LEFT/RIGHT)JOIN ... ON 多表的连接条件</span></pre></td></tr><tr><td data-num=33></td><td><pre><span class="token comment">(LEFT / RIGHT)JOIN ... ON ...</span></pre></td></tr><tr><td data-num=34></td><td><pre><span class="token comment">WHERE 不包含聚合函数的过滤条件</span></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token comment">GROUP BY ...,...</span></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token comment">HAVING 包含聚合函数的过滤条件</span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token comment">ORDER BY ...,...(ASC / DESC)</span></pre></td></tr><tr><td data-num=38></td><td><pre><span class="token comment">LIMIT ...,...</span></pre></td></tr><tr><td data-num=39></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=40></td><td><pre></pre></td></tr><tr><td data-num=41></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=42></td><td><pre><span class="token comment">若employees表中employee_id与job_history表中employee_id相同的数目不小于2，</span></pre></td></tr><tr><td data-num=43></td><td><pre><span class="token comment">输出这些相同id的员工的employee_id,last_name和其job_id</span></pre></td></tr><tr><td data-num=44></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=45></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> job_history<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=46></td><td><pre></pre></td></tr><tr><td data-num=47></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>job_id</pre></td></tr><tr><td data-num=48></td><td><pre><span class="token keyword">FROM</span> employees e</pre></td></tr><tr><td data-num=49></td><td><pre><span class="token keyword">WHERE</span> <span class="token number">2</span> <span class="token operator">&lt;=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=50></td><td><pre>    <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=51></td><td><pre>    <span class="token keyword">FROM</span> job_histroy j</pre></td></tr><tr><td data-num=52></td><td><pre>    <span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> j<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=53></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>EXISTS与NOT EXISTS关键字</strong></p><p>关联子查询通常也会和EXISTS操作符一起使用，用来检测在子查询中是否满足条件的行。</p><p>如果在子查询中不存在满足条件的行</p><ul><li>条件返回FALSE</li><li>继续在子查询中查找</li></ul><p>如果在子查询中存在满足条件的行</p><ul><li>不在子查询中继续查找</li><li>条件返回TRUE</li></ul><p><strong>NOT EXISTS</strong>关键字表示如果不存在某种条件，则返回TRUE，否则返回FALSE。</p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* EXISTS与NOT EXISTS关键字 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token comment">/* 查询公司管理者的employee_id,last_name,job_id,department_id信息 */</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token comment">/* 自连接 */</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">SELECT</span> mgr<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>mgr<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>mgr<span class="token punctuation">.</span>job_id<span class="token punctuation">,</span>mgr<span class="token punctuation">.</span>department_id</pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">FROM</span> employees emp <span class="token keyword">JOIN</span> employees mgr</pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">ON</span> emp<span class="token punctuation">.</span>manager_id <span class="token operator">=</span> mgr<span class="token punctuation">.</span>employee_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token comment">/* 子查询 */</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>job_id<span class="token punctuation">,</span>department_id</pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">WHERE</span> employee_id <span class="token operator">IN</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> manager_id</pre></td></tr><tr><td data-num=13></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=14></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token comment">/* 使用EXISTS */</span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>job_id<span class="token punctuation">,</span>department_id</pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">FROM</span> employees e1</pre></td></tr><tr><td data-num=19></td><td><pre><span class="token keyword">WHERE</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=20></td><td><pre>    <span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=21></td><td><pre>    <span class="token keyword">FROM</span> employees e2</pre></td></tr><tr><td data-num=22></td><td><pre>    <span class="token keyword">WHERE</span> e1<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> e2<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=24></td><td><pre></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token comment">/* 查询departments表中，不存在于employees表中的部门的department_id和department_name */</span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token comment">/* 方式一 */</span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token keyword">SELECT</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span>department_name</pre></td></tr><tr><td data-num=28></td><td><pre><span class="token keyword">FROM</span> department d</pre></td></tr><tr><td data-num=29></td><td><pre><span class="token keyword">WHERE</span> <span class="token keyword">EXISTS</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=30></td><td><pre>    <span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=31></td><td><pre>    <span class="token keyword">FROM</span> employees e</pre></td></tr><tr><td data-num=32></td><td><pre>    <span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=33></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>相关更新</strong></p><p>使用相关子查询依据一个表中的数据更新另一个表的数据。</p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">UPDATE</span> table1 alias1</pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">SET</span> <span class="token keyword">column</span> <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=3></td><td><pre>    <span class="token keyword">SELECT</span> expression</pre></td></tr><tr><td data-num=4></td><td><pre>    <span class="token keyword">FROM</span> table2 alias2</pre></td></tr><tr><td data-num=5></td><td><pre>    <span class="token keyword">WHERE</span> alias1<span class="token punctuation">.</span><span class="token keyword">column</span> <span class="token operator">=</span> alias2<span class="token punctuation">.</span><span class="token keyword">column</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token comment">/* 在employees中增加一个department_name字段，数据为员工对应的部门名称 */</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> employees</pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">ADD</span><span class="token punctuation">(</span>department_name VARCHAR2<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=11></td><td><pre></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token keyword">UPDATE</span> employees e</pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">SET</span> department_name <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=14></td><td><pre>    <span class="token keyword">SELECT</span> department_name</pre></td></tr><tr><td data-num=15></td><td><pre>    <span class="token keyword">FROM</span> departments d</pre></td></tr><tr><td data-num=16></td><td><pre>    <span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id</pre></td></tr><tr><td data-num=17></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>相关删除</strong></p><p>使用相关子查询依据一个表中的数据删除另一个表的数据。</p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> table1 alias1</pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">WHERE</span> <span class="token keyword">column</span> operator <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=3></td><td><pre>    <span class="token keyword">SELECT</span> expression</pre></td></tr><tr><td data-num=4></td><td><pre>    <span class="token keyword">FROM</span> table2 alias2</pre></td></tr><tr><td data-num=5></td><td><pre>    <span class="token keyword">WHERE</span> alias1<span class="token punctuation">.</span><span class="token keyword">column</span> <span class="token operator">=</span> alias2<span class="token punctuation">.</span><span class="token keyword">column</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token comment">/* 删除表employees中，其与emp_history表皆有的数据 */</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> employees e</pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">WHERE</span> employee_id <span class="token operator">IN</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=11></td><td><pre>    <span class="token keyword">SELECT</span> employee_id</pre></td></tr><tr><td data-num=12></td><td><pre>    <span class="token keyword">FROM</span> emp_history</pre></td></tr><tr><td data-num=13></td><td><pre>    <span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> e<span class="token punctuation">.</span>employee_id</pre></td></tr><tr><td data-num=14></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>子查询练习/案例</strong></p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 查询平均工资最高的job信息 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token comment">/* 方式一 */</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">FROM</span> jobs</pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">WHERE</span> job_id <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=6></td><td><pre>    <span class="token keyword">SELECT</span> job_id</pre></td></tr><tr><td data-num=7></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id</pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token keyword">HAVING</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=10></td><td><pre>        <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>avg_sal<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=11></td><td><pre>        <span class="token keyword">FROM</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=12></td><td><pre>            <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> avg_sal</pre></td></tr><tr><td data-num=13></td><td><pre>            <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=14></td><td><pre>            <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id</pre></td></tr><tr><td data-num=15></td><td><pre>            <span class="token punctuation">)</span> t_job_avg_sal</pre></td></tr><tr><td data-num=16></td><td><pre>        <span class="token punctuation">)</span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=18></td><td><pre></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token comment">/* 方式二 */</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token keyword">FROM</span> jobs</pre></td></tr><tr><td data-num=22></td><td><pre><span class="token keyword">WHERE</span> job_id <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=23></td><td><pre>    <span class="token keyword">SELECT</span> job_id</pre></td></tr><tr><td data-num=24></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=25></td><td><pre>    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id</pre></td></tr><tr><td data-num=26></td><td><pre>    <span class="token keyword">HAVING</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token keyword">ALL</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=27></td><td><pre>            <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> avg_sal</pre></td></tr><tr><td data-num=28></td><td><pre>            <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=29></td><td><pre>            <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id</pre></td></tr><tr><td data-num=30></td><td><pre>        <span class="token punctuation">)</span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=32></td><td><pre></pre></td></tr><tr><td data-num=33></td><td><pre><span class="token comment">/* 方式三 */</span></pre></td></tr><tr><td data-num=34></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token keyword">FROM</span> jobs</pre></td></tr><tr><td data-num=36></td><td><pre><span class="token keyword">WHERE</span> job_id <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=37></td><td><pre>    <span class="token keyword">SELECT</span> job_id</pre></td></tr><tr><td data-num=38></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=39></td><td><pre>    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id</pre></td></tr><tr><td data-num=40></td><td><pre>    <span class="token keyword">HAVING</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">ALL</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=41></td><td><pre>            <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> avg_sal</pre></td></tr><tr><td data-num=42></td><td><pre>            <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=43></td><td><pre>            <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id</pre></td></tr><tr><td data-num=44></td><td><pre>       		<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> avg_sal <span class="token keyword">DESC</span></pre></td></tr><tr><td data-num=45></td><td><pre>        	<span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span></pre></td></tr><tr><td data-num=46></td><td><pre>        <span class="token punctuation">)</span></pre></td></tr><tr><td data-num=47></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=48></td><td><pre></pre></td></tr><tr><td data-num=49></td><td><pre><span class="token comment">/* 方式四 */</span></pre></td></tr><tr><td data-num=50></td><td><pre><span class="token keyword">SELECT</span> j<span class="token punctuation">.</span><span class="token operator">*</span></pre></td></tr><tr><td data-num=51></td><td><pre><span class="token keyword">FROM</span> jobs j<span class="token punctuation">,</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=52></td><td><pre>    <span class="token keyword">SELECT</span> job_id<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> avg_sal</pre></td></tr><tr><td data-num=53></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=54></td><td><pre>    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job_id</pre></td></tr><tr><td data-num=55></td><td><pre>    <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> avg_sal <span class="token keyword">DESC</span></pre></td></tr><tr><td data-num=56></td><td><pre>    <span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span></pre></td></tr><tr><td data-num=57></td><td><pre>    <span class="token punctuation">)</span> t_job_avg_sal</pre></td></tr><tr><td data-num=58></td><td><pre><span class="token keyword">WHERE</span> j<span class="token punctuation">.</span>job_id <span class="token operator">=</span> t_job_avg_sal<span class="token punctuation">.</span>job_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=59></td><td><pre></pre></td></tr><tr><td data-num=60></td><td><pre><span class="token comment">/* 查询平均工资高于平均工资的部门有哪些 */</span></pre></td></tr><tr><td data-num=61></td><td><pre><span class="token keyword">SELECT</span> department_id</pre></td></tr><tr><td data-num=62></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=63></td><td><pre><span class="token keyword">WHERE</span> department_id <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span></pre></td></tr><tr><td data-num=64></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id</pre></td></tr><tr><td data-num=65></td><td><pre><span class="token keyword">HAVING</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=66></td><td><pre>    <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=67></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=68></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=69></td><td><pre></pre></td></tr><tr><td data-num=70></td><td><pre><span class="token comment">/* 查询出公司中所有manager的详细信息 */</span></pre></td></tr><tr><td data-num=71></td><td><pre><span class="token comment">/* 自连接 */</span></pre></td></tr><tr><td data-num=72></td><td><pre><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> mgr<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>mgr<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>mgr<span class="token punctuation">.</span>job_id<span class="token punctuation">,</span>mgr<span class="token punctuation">.</span>department_id</pre></td></tr><tr><td data-num=73></td><td><pre><span class="token keyword">FROM</span> employees emp <span class="token keyword">JOIN</span> employees mgr</pre></td></tr><tr><td data-num=74></td><td><pre><span class="token keyword">ON</span> emp<span class="token punctuation">.</span>manager_id <span class="token operator">=</span> mgr<span class="token punctuation">.</span>employee_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=75></td><td><pre></pre></td></tr><tr><td data-num=76></td><td><pre><span class="token comment">/* 子查询 */</span></pre></td></tr><tr><td data-num=77></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>job_id<span class="token punctuation">,</span>department_id</pre></td></tr><tr><td data-num=78></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=79></td><td><pre><span class="token keyword">WHERE</span> employee_id <span class="token operator">IN</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=80></td><td><pre>    <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> manager_id</pre></td></tr><tr><td data-num=81></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=82></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=83></td><td><pre></pre></td></tr><tr><td data-num=84></td><td><pre><span class="token comment">/* 使用EXISTS */</span></pre></td></tr><tr><td data-num=85></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>job_id<span class="token punctuation">,</span>department_id</pre></td></tr><tr><td data-num=86></td><td><pre><span class="token keyword">FROM</span> employees e1</pre></td></tr><tr><td data-num=87></td><td><pre><span class="token keyword">WHERE</span> <span class="token keyword">EXISTS</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=88></td><td><pre>    <span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=89></td><td><pre>    <span class="token keyword">FROM</span> employees e2</pre></td></tr><tr><td data-num=90></td><td><pre>    <span class="token keyword">WHERE</span> e1<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> e2<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=91></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=92></td><td><pre></pre></td></tr><tr><td data-num=93></td><td><pre><span class="token comment">/* 各个部门中，最高工资中最低的那个部门的 最低工资是多少？ */</span></pre></td></tr><tr><td data-num=94></td><td><pre><span class="token comment">/* 方式一 */</span></pre></td></tr><tr><td data-num=95></td><td><pre><span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=96></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=97></td><td><pre><span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=98></td><td><pre>    <span class="token keyword">SELECT</span> department_id</pre></td></tr><tr><td data-num=99></td><td><pre>	<span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=100></td><td><pre>	<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id</pre></td></tr><tr><td data-num=101></td><td><pre>	<span class="token keyword">HAVING</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=102></td><td><pre>        <span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>max_sla<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=103></td><td><pre>        <span class="token keyword">FROM</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=104></td><td><pre>            <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> max_sal</pre></td></tr><tr><td data-num=105></td><td><pre>            <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=106></td><td><pre>            <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id</pre></td></tr><tr><td data-num=107></td><td><pre>            <span class="token punctuation">)</span> t_dept_max_sal</pre></td></tr><tr><td data-num=108></td><td><pre>	<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=109></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=110></td><td><pre><span class="token comment">/* 方式二 */</span></pre></td></tr><tr><td data-num=111></td><td><pre><span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=112></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=113></td><td><pre><span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=114></td><td><pre>    <span class="token keyword">SELECT</span> department_id</pre></td></tr><tr><td data-num=115></td><td><pre>	<span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=116></td><td><pre>	<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id</pre></td></tr><tr><td data-num=117></td><td><pre>	<span class="token keyword">HAVING</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token keyword">ALL</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=118></td><td><pre>            <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=119></td><td><pre>            <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=120></td><td><pre>            <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id</pre></td></tr><tr><td data-num=121></td><td><pre>	<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=122></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=123></td><td><pre><span class="token comment">/* 方式三 */</span></pre></td></tr><tr><td data-num=124></td><td><pre><span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=125></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=126></td><td><pre><span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=127></td><td><pre>    <span class="token keyword">SELECT</span> department_id</pre></td></tr><tr><td data-num=128></td><td><pre>	<span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=129></td><td><pre>	<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id</pre></td></tr><tr><td data-num=130></td><td><pre>	<span class="token keyword">HAVING</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=131></td><td><pre>            <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> max_sal</pre></td></tr><tr><td data-num=132></td><td><pre>            <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=133></td><td><pre>            <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id</pre></td></tr><tr><td data-num=134></td><td><pre>       		<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> max_sal <span class="token keyword">ASC</span></pre></td></tr><tr><td data-num=135></td><td><pre>        	<span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span></pre></td></tr><tr><td data-num=136></td><td><pre>	<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=137></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=138></td><td><pre><span class="token comment">/* 方式四 */</span></pre></td></tr><tr><td data-num=139></td><td><pre><span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=140></td><td><pre><span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=141></td><td><pre>            <span class="token keyword">SELECT</span> department_id<span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> max_sal</pre></td></tr><tr><td data-num=142></td><td><pre>            <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=143></td><td><pre>            <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id</pre></td></tr><tr><td data-num=144></td><td><pre>       		<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> max_sal <span class="token keyword">ASC</span></pre></td></tr><tr><td data-num=145></td><td><pre>        	<span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span></pre></td></tr><tr><td data-num=146></td><td><pre>	<span class="token punctuation">)</span> t_dept_max_sal</pre></td></tr><tr><td data-num=147></td><td><pre><span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> t_dept_max_sal<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span> </pre></td></tr><tr><td data-num=148></td><td><pre></pre></td></tr><tr><td data-num=149></td><td><pre><span class="token comment">/* 查询平均工资最高的部门的manager的详细信息：last_name,department_id,email,salary */</span></pre></td></tr><tr><td data-num=150></td><td><pre><span class="token comment">/* 方式一 */</span></pre></td></tr><tr><td data-num=151></td><td><pre><span class="token keyword">SELECT</span> last_nmae<span class="token punctuation">,</span>department_id<span class="token punctuation">,</span>email<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=152></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=153></td><td><pre><span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> <span class="token keyword">ANY</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=154></td><td><pre>    <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> manager_id</pre></td></tr><tr><td data-num=155></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=156></td><td><pre>    <span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=157></td><td><pre>        <span class="token keyword">SELECT</span> department_id</pre></td></tr><tr><td data-num=158></td><td><pre>        <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=159></td><td><pre>        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id</pre></td></tr><tr><td data-num=160></td><td><pre>        <span class="token keyword">HAVING</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=161></td><td><pre>            <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>avg_sal<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=162></td><td><pre>            <span class="token keyword">FROM</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=163></td><td><pre>                <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> avg_sal</pre></td></tr><tr><td data-num=164></td><td><pre>                <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=165></td><td><pre>                <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id</pre></td></tr><tr><td data-num=166></td><td><pre>                <span class="token punctuation">)</span> t_dept_avg_sal</pre></td></tr><tr><td data-num=167></td><td><pre>        <span class="token punctuation">)</span></pre></td></tr><tr><td data-num=168></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num=169></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=170></td><td><pre></pre></td></tr><tr><td data-num=171></td><td><pre><span class="token comment">/* 方式二 */</span></pre></td></tr><tr><td data-num=172></td><td><pre><span class="token keyword">SELECT</span> last_nmae<span class="token punctuation">,</span>department_id<span class="token punctuation">,</span>email<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=173></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=174></td><td><pre><span class="token keyword">WHERE</span> employee_id <span class="token operator">=</span> <span class="token keyword">ANY</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=175></td><td><pre>    <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> manager_id</pre></td></tr><tr><td data-num=176></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=177></td><td><pre>    <span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=178></td><td><pre>        <span class="token keyword">SELECT</span> department_id</pre></td></tr><tr><td data-num=179></td><td><pre>        <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=180></td><td><pre>        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id</pre></td></tr><tr><td data-num=181></td><td><pre>        <span class="token keyword">HAVING</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token keyword">ALL</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=182></td><td><pre>               <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> avg_sal</pre></td></tr><tr><td data-num=183></td><td><pre>               <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=184></td><td><pre>               <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id</pre></td></tr><tr><td data-num=185></td><td><pre>        <span class="token punctuation">)</span></pre></td></tr><tr><td data-num=186></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num=187></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=188></td><td><pre></pre></td></tr><tr><td data-num=189></td><td><pre><span class="token comment">/* 方式三 */</span></pre></td></tr><tr><td data-num=190></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>department_id<span class="token punctuation">,</span>email<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=191></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=192></td><td><pre><span class="token keyword">WHERE</span> employee_id <span class="token operator">IN</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=193></td><td><pre>    <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> manager_id</pre></td></tr><tr><td data-num=194></td><td><pre>    <span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=195></td><td><pre>        <span class="token keyword">SELECT</span> department_id<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> avg_sal</pre></td></tr><tr><td data-num=196></td><td><pre>        <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=197></td><td><pre>        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id</pre></td></tr><tr><td data-num=198></td><td><pre>        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> avg_sal <span class="token keyword">DESC</span></pre></td></tr><tr><td data-num=199></td><td><pre>        <span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span></pre></td></tr><tr><td data-num=200></td><td><pre>        <span class="token punctuation">)</span> t_dept_avg_sal</pre></td></tr><tr><td data-num=201></td><td><pre>    <span class="token keyword">WHERE</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> t_dept_avg_sal<span class="token punctuation">.</span>department_id</pre></td></tr><tr><td data-num=202></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=203></td><td><pre></pre></td></tr><tr><td data-num=204></td><td><pre><span class="token comment">/* 查询部门的部门号，其中不包括job_id是“ST_CLERK”的部门号 */</span></pre></td></tr><tr><td data-num=205></td><td><pre><span class="token comment">/* 方式一 */</span></pre></td></tr><tr><td data-num=206></td><td><pre><span class="token keyword">SELECT</span> depart_ment_id</pre></td></tr><tr><td data-num=207></td><td><pre><span class="token keyword">FROM</span> departments</pre></td></tr><tr><td data-num=208></td><td><pre><span class="token keyword">WHERE</span> department_id <span class="token operator">NOT</span> <span class="token operator">IN</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=209></td><td><pre>    <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> department_id</pre></td></tr><tr><td data-num=210></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=211></td><td><pre>    <span class="token keyword">WHERE</span> job_id <span class="token operator">=</span> <span class="token string">'ST_CLERK'</span></pre></td></tr><tr><td data-num=212></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=213></td><td><pre></pre></td></tr><tr><td data-num=214></td><td><pre><span class="token comment">/* 方式二 */</span></pre></td></tr><tr><td data-num=215></td><td><pre><span class="token keyword">SELECT</span> department_id</pre></td></tr><tr><td data-num=216></td><td><pre><span class="token keyword">FROM</span> departments d</pre></td></tr><tr><td data-num=217></td><td><pre><span class="token keyword">WHERE</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=218></td><td><pre>    <span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=219></td><td><pre>    <span class="token keyword">FROM</span> employees e</pre></td></tr><tr><td data-num=220></td><td><pre>    <span class="token keyword">WHERE</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=221></td><td><pre>    <span class="token operator">AND</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>job_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> <span class="token string">'ST_CLERK'</span></pre></td></tr><tr><td data-num=222></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=223></td><td><pre></pre></td></tr><tr><td data-num=224></td><td><pre><span class="token comment">/* 选择所有没有管理者的员工的last_name */</span></pre></td></tr><tr><td data-num=225></td><td><pre><span class="token keyword">SELECT</span> last_name</pre></td></tr><tr><td data-num=226></td><td><pre><span class="token keyword">FROM</span> employees emp</pre></td></tr><tr><td data-num=227></td><td><pre><span class="token keyword">WHERE</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=228></td><td><pre>    <span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=229></td><td><pre>    <span class="token keyword">FROM</span> employees mgr</pre></td></tr><tr><td data-num=230></td><td><pre>    <span class="token keyword">WHERE</span> emp<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> e2<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=231></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=232></td><td><pre>    </pre></td></tr><tr><td data-num=233></td><td><pre><span class="token comment">/* 查询员工号，姓名，雇佣时间，工资，其中员工的管理者为'De Haan' */</span></pre></td></tr><tr><td data-num=234></td><td><pre><span class="token comment">/* 方式一 */</span></pre></td></tr><tr><td data-num=235></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>hire_date<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=236></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=237></td><td><pre><span class="token keyword">WHERE</span> manager_id <span class="token operator">IN</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=238></td><td><pre>    <span class="token keyword">SELECT</span> employee_id</pre></td></tr><tr><td data-num=239></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=240></td><td><pre>    <span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> <span class="token string">'De Haan'</span></pre></td></tr><tr><td data-num=241></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=242></td><td><pre></pre></td></tr><tr><td data-num=243></td><td><pre><span class="token comment">/* 方式二 */</span></pre></td></tr><tr><td data-num=244></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>hire_date<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=245></td><td><pre><span class="token keyword">FROM</span> employees e1</pre></td></tr><tr><td data-num=246></td><td><pre><span class="token keyword">WHERE</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=247></td><td><pre>    <span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=248></td><td><pre>    <span class="token keyword">FROM</span> employees e2</pre></td></tr><tr><td data-num=249></td><td><pre>    <span class="token keyword">WHERE</span> e1<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>manager_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> e2<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>employee_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=250></td><td><pre>    <span class="token operator">AND</span> e2<span class="token punctuation">.</span>last_name <span class="token operator">=</span> <span class="token string">'De Haan'</span></pre></td></tr><tr><td data-num=251></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=252></td><td><pre></pre></td></tr><tr><td data-num=253></td><td><pre><span class="token comment">/* 查询各部门中工资比本部门平均工资高的员工的员工号，姓名和工资(相关子查询) */</span></pre></td></tr><tr><td data-num=254></td><td><pre><span class="token comment">/* 相关子查询 */</span></pre></td></tr><tr><td data-num=255></td><td><pre><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span>salary<span class="token punctuation">,</span>department_id</pre></td></tr><tr><td data-num=256></td><td><pre><span class="token keyword">FROM</span> employees e1</pre></td></tr><tr><td data-num=257></td><td><pre><span class="token keyword">WHERE</span> salary <span class="token operator">></span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=258></td><td><pre>    <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=259></td><td><pre>    <span class="token keyword">FROM</span> employees e2</pre></td></tr><tr><td data-num=260></td><td><pre>    <span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> e1<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=261></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=262></td><td><pre></pre></td></tr><tr><td data-num=263></td><td><pre><span class="token comment">/* 在FROM中声明子查询 */</span></pre></td></tr><tr><td data-num=264></td><td><pre><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>salary<span class="token punctuation">,</span>e<span class="token punctuation">.</span>department_id</pre></td></tr><tr><td data-num=265></td><td><pre><span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num=266></td><td><pre>    <span class="token keyword">SELECT</span> department_id<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> avg_sal</pre></td></tr><tr><td data-num=267></td><td><pre>    <span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=268></td><td><pre>    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> department_id<span class="token punctuation">)</span> t_dept_avg_sal</pre></td></tr><tr><td data-num=269></td><td><pre><span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> t_dept_avg_sal<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=270></td><td><pre></pre></td></tr><tr><td data-num=271></td><td><pre><span class="token comment">/* 查询每个部门下的部门人数大于5的部门名称(相关子查询) */</span></pre></td></tr><tr><td data-num=272></td><td><pre><span class="token keyword">SELECT</span> department_name</pre></td></tr><tr><td data-num=273></td><td><pre><span class="token keyword">FROM</span> departments d</pre></td></tr><tr><td data-num=274></td><td><pre><span class="token keyword">WHERE</span> <span class="token number">5</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=275></td><td><pre>    <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=276></td><td><pre>    <span class="token keyword">FROM</span> employees e</pre></td></tr><tr><td data-num=277></td><td><pre>    <span class="token keyword">WHERE</span> d<span class="token punctuation">.</span>department_id <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>department_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=278></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=279></td><td><pre></pre></td></tr><tr><td data-num=280></td><td><pre><span class="token comment">/* 查询每个国家下的部门个数大于2的国家编号(相关子查询) */</span></pre></td></tr><tr><td data-num=281></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> locations<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=282></td><td><pre><span class="token keyword">SELECT</span> country_id</pre></td></tr><tr><td data-num=283></td><td><pre><span class="token keyword">FROM</span> locations l</pre></td></tr><tr><td data-num=284></td><td><pre><span class="token keyword">WHERE</span> <span class="token number">2</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num=285></td><td><pre>    <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=286></td><td><pre>    <span class="token keyword">FROM</span> departments d</pre></td></tr><tr><td data-num=287></td><td><pre>    <span class="token keyword">WHERE</span> l<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span> <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>location_id<span class="token punctuation">`</span></span></pre></td></tr><tr><td data-num=288></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id=创建和管理表><a class=anchor href=#创建和管理表>#</a> 创建和管理表</h2><h3 id=概述-2><a class=anchor href=#概述-2>#</a> 概述</h3><p><strong>一条数据存储的过程</strong></p><p>存储数据是处理数据的第一步。只有正确地把数据存储起来，才能进行有效的处理和分析。</p><p>那么，怎样才能把用户各种经营相关的，纷繁复杂的数据，有序，高效地存储起来。在MySQL中，一个完整地数据存储过程总共有4步，分别是创建数据库，确认字段，创建数据表，插入数据。</p><p>从系统架构的层次上看，MySQL数据库系统从大到小依次是数据库服务器，数据库，数据表，数据表的行与列。</p><p><strong>标识符命名规则</strong></p><p>数据库名，表名不得超过30个字符，变量名限制为29个。</p><p>必须只能包含<code>A-Z</code>,<code>a-z</code>,<code>0-9</code>,<code>_</code>共63个字符。</p><p>数据库名，表名，字段名等对象名中间不要包含空格。</p><p>同一个MySQL软件中，数据库不能同名；同一个库中，表不能重名；同一个表中，字段不能重名。</p><p>必须保证字段没有和保留字，数据库系统或常用方法冲突。如果坚持使用，需使用`着重号引起来。</p><p>保持字段名和类型的一致性，在命名字段并为其指定数据类型的时候一定要保证一致性。</p><h3 id=mysql中的数据类型><a class=anchor href=#mysql中的数据类型>#</a> MySQL中的数据类型</h3><table><thead><tr><th>类型</th><th></th></tr></thead><tbody><tr><td>整数类型</td><td>INYINT, SMALLINT, MEDIUMINT, INT(或INTEGER), BIGINT</td></tr><tr><td>浮点类型</td><td>FLOAT, DOUBLE</td></tr><tr><td>定点数类型</td><td>DECIMAL</td></tr><tr><td>位类型</td><td>BIT</td></tr><tr><td>日期时间类型</td><td>YEAR, TIME, DATE, DATETIME, TIMESTAMP</td></tr><tr><td>文本字符串类型</td><td>CHAR, VARCHAR, TINYTEXT, TEXT, MEDIUMTEXT, LONGTEXT</td></tr><tr><td>枚举类型</td><td>ENUM</td></tr><tr><td>集合类型</td><td>SET</td></tr><tr><td>二进制字符串类型</td><td>BINARY, VARBINARY, TINYBLOB, BLOB, MEDIUMBLOB, LONGBLOB</td></tr><tr><td>JSON类型</td><td>JSON对象，JSON数组</td></tr><tr><td>空间数据类型</td><td>单值：GEOMETRY, POINT, LINESTRING, POLYGON;<br>集合：MULTIPOINT, MULTILINESTRING, MULTIPOLYGON, GEOMETRYCOLLECTION</td></tr></tbody><tbody><tr><td>数据类型</td><td>描述</td></tr><tr><td>-------------</td><td>------------------------------------------------------------</td></tr><tr><td>INT</td><td>从<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo>−</mo><msup><mn>2</mn><mn>31</mn></msup></mrow><annotation encoding=application/x-tex>-2^{31}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.897438em;vertical-align:-.08333em></span><span class=mord>−</span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>到<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mn>2</mn><mn>31</mn></msup></mrow><annotation encoding=application/x-tex>2^{31}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>的整型数据。存储大小为4个字节</td></tr><tr><td>CHAR(size)</td><td>定长字符数据。若未指定，默认为1个字符，最大长度255</td></tr><tr><td>VARCHAR(size)</td><td>可变长字符数据，根据字符串实际长度保存，必须指定长度</td></tr><tr><td>FLOAT(M,D)</td><td>单精度，占用4个字节，M=整数位+小数位，D=小数位。D&lt;=M&lt;=255,0&lt;=D&lt;=30,默认M+D&lt;=6</td></tr><tr><td>DOUBLE(M,D)</td><td>双精度，占用8个字节，D&lt;=M&lt;=255,0&lt;=D&lt;=30，默认M+D&lt;=15</td></tr><tr><td>DECIMAL(M,D)</td><td>高精度小数，占用M+2个字节，D&lt;=M&lt;=65,0&lt;=D&lt;=30,最大取值范围与DOUBLE相同</td></tr><tr><td>DATE</td><td>日期型数据，格式'YYYY-MM-DD'</td></tr><tr><td>BLOB</td><td>二进制形式的长文本数据，最大可达4G</td></tr><tr><td>TEXT</td><td>长文本数据，最大可达4G</td></tr></tbody></table><h3 id=创建数据库><a class=anchor href=#创建数据库>#</a> 创建数据库</h3><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 如何创建数据库 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token comment">/* 方式一 */</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> mytest1<span class="token punctuation">;</span><span class="token comment">/* 创建的此数据库使用的是默认的字符集 */</span></pre></td></tr><tr><td data-num=4></td><td><pre></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token comment">/* 方式二 */</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> myteset2 <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token string">'gbk'</span><span class="token punctuation">;</span><span class="token comment">/* 显示指明了要创建的数据库的字符集 */</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> mytest2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=8></td><td><pre></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token comment">方式三，推荐</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token comment">如果要创建的数据库已经存在，则创建不成功，但不会报错</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> mytest2 <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token string">'utf8'</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id=管理数据库><a class=anchor href=#管理数据库>#</a> 管理数据库</h3><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 查看当前连接中的数据库都有哪些 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">DATABASES</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token comment">/* 切换数据库 */</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">USE</span> atguigudb<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=6></td><td><pre></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token comment">/* 查看当前数据库中保存的数据表 */</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">TABLES</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token comment">/* 查看当前使用的数据库 */</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">SELECT</span> <span class="token keyword">DATABASE</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> DUAL<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token comment">/* 查看指定数据库下保存的数据表 */</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">TABLES</span> <span class="token keyword">FROM</span> mysql<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token comment">/* 修改数据库 */</span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token comment">/* 更改数据库字符集 */</span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">database</span> mytest2 <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token string">'utf8'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token comment">/* 删除数据库 */</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token keyword">DROP</span> <span class="token keyword">DATABASE</span> mytest1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token keyword">DROP</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> mytest1<span class="token punctuation">;</span><span class="token comment">/* 推荐 */</span></pre></td></tr></table></figure><h3 id=创建表><a class=anchor href=#创建表>#</a> 创建表</h3><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token keyword">USE</span> atguigudb<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> atguigudb<span class="token punctuation">;</span><span class="token comment">/* 默认使用的是utf8 */</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLES</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=4></td><td><pre></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token comment">/* 方式一 */</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> myemp1<span class="token punctuation">(</span></pre></td></tr><tr><td data-num=7></td><td><pre>	id <span class="token keyword">INT</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=8></td><td><pre>    emp_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=9></td><td><pre>    hire_date <span class="token keyword">DATE</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=11></td><td><pre></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token comment">/* 查看表结构 */</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">DESC</span> myemp1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> myemp1<span class="token punctuation">;</span><span class="token comment">/* 如果创建表时没有指明使用的字符集，则默认使用表所在数据库的字符集 */</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token comment">/* 查看表数据 */</span></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> myemp1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=17></td><td><pre></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token comment">方式二 </span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token comment">基于现有的表，同时导入数据</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> myemp2</pre></td></tr><tr><td data-num=23></td><td><pre><span class="token keyword">AS</span></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>salary</pre></td></tr><tr><td data-num=25></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=26></td><td><pre></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token keyword">DESC</span> myemp2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token keyword">DESC</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=29></td><td><pre></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token keyword">FROM</span> myemp2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=32></td><td><pre></pre></td></tr><tr><td data-num=33></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=34></td><td><pre><span class="token comment">查询语句中字段的别名，可以作为新创建的表的字段的名称</span></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token comment">此时的查询语句可以结构比较丰富，使用各种SELECT</span></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> myemp3</pre></td></tr><tr><td data-num=38></td><td><pre><span class="token keyword">AS</span></pre></td></tr><tr><td data-num=39></td><td><pre><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>employee_id emp_id<span class="token punctuation">,</span>e<span class="token punctuation">.</span>last_name lname<span class="token punctuation">,</span>d<span class="token punctuation">.</span>department_name</pre></td></tr><tr><td data-num=40></td><td><pre><span class="token keyword">FROM</span> employees e <span class="token keyword">JOIN</span> departments d</pre></td></tr><tr><td data-num=41></td><td><pre><span class="token keyword">ON</span> e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=42></td><td><pre></pre></td></tr><tr><td data-num=43></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=44></td><td><pre><span class="token keyword">FROM</span> myemp3<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=45></td><td><pre><span class="token keyword">DESC</span> myemp3<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=46></td><td><pre></pre></td></tr><tr><td data-num=47></td><td><pre><span class="token comment">/* 创建一个表employees_copy,实现对employees表的复制，包括表数据 */</span></pre></td></tr><tr><td data-num=48></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span></pre></td></tr><tr><td data-num=49></td><td><pre><span class="token keyword">AS</span></pre></td></tr><tr><td data-num=50></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=51></td><td><pre><span class="token keyword">FROM</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=52></td><td><pre></pre></td></tr><tr><td data-num=53></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees_copy<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=54></td><td><pre></pre></td></tr><tr><td data-num=55></td><td><pre><span class="token comment">/* 创建一个表employees_blank,实现对employees表的复制，不包括表数据 */</span></pre></td></tr><tr><td data-num=56></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> employees_copy</pre></td></tr><tr><td data-num=57></td><td><pre><span class="token keyword">AS</span></pre></td></tr><tr><td data-num=58></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=59></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=60></td><td><pre><span class="token comment">/* WHERE department_id > 10000; */</span></pre></td></tr><tr><td data-num=61></td><td><pre><span class="token keyword">WHERE</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=62></td><td><pre></pre></td></tr><tr><td data-num=63></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees_blank<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=64></td><td><pre></pre></td></tr><tr><td data-num=65></td><td><pre><span class="token comment">/* 修改表 */</span></pre></td></tr><tr><td data-num=66></td><td><pre><span class="token comment">/* 添加一个字段 */</span></pre></td></tr><tr><td data-num=67></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> myemp1</pre></td></tr><tr><td data-num=68></td><td><pre><span class="token keyword">ADD</span> salary <span class="token keyword">DOUBLE</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* 默认添加到表中的最后一个字段的位置 */</span></pre></td></tr><tr><td data-num=69></td><td><pre></pre></td></tr><tr><td data-num=70></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> myemp1</pre></td></tr><tr><td data-num=71></td><td><pre><span class="token keyword">ADD</span> phone_number <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">FIRST</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=72></td><td><pre></pre></td></tr><tr><td data-num=73></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> myemp1</pre></td></tr><tr><td data-num=74></td><td><pre><span class="token keyword">ADD</span> email <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token keyword">AFTER</span> emp_name<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=75></td><td><pre>                  </pre></td></tr><tr><td data-num=76></td><td><pre><span class="token comment">/* 修改一个字段，数据类型，长度，默认值(略) */</span></pre></td></tr><tr><td data-num=77></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> myemp1</pre></td></tr><tr><td data-num=78></td><td><pre><span class="token keyword">MODIFY</span> emp_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=79></td><td><pre></pre></td></tr><tr><td data-num=80></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> myemp1</pre></td></tr><tr><td data-num=81></td><td><pre><span class="token keyword">MODIFY</span> emp_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">'aaa'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=82></td><td><pre></pre></td></tr><tr><td data-num=83></td><td><pre><span class="token comment">/* 重命名一个字段 */</span></pre></td></tr><tr><td data-num=84></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> myemp1</pre></td></tr><tr><td data-num=85></td><td><pre>CHANGE salary monthly_salary <span class="token keyword">DOUBLE</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=86></td><td><pre></pre></td></tr><tr><td data-num=87></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> myemp1</pre></td></tr><tr><td data-num=88></td><td><pre>CHANGE email my_email <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=89></td><td><pre></pre></td></tr><tr><td data-num=90></td><td><pre><span class="token comment">/* 删除一个字段 */</span></pre></td></tr><tr><td data-num=91></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> myemp1</pre></td></tr><tr><td data-num=92></td><td><pre><span class="token keyword">DROP</span> <span class="token keyword">COLUMN</span> my_email<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=93></td><td><pre></pre></td></tr><tr><td data-num=94></td><td><pre><span class="token comment">/* 重命名表 */</span></pre></td></tr><tr><td data-num=95></td><td><pre><span class="token comment">/* 方式一 */</span></pre></td></tr><tr><td data-num=96></td><td><pre><span class="token keyword">RENAME</span> <span class="token keyword">TABLE</span> myemp1</pre></td></tr><tr><td data-num=97></td><td><pre><span class="token keyword">TO</span> myempl1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=98></td><td><pre></pre></td></tr><tr><td data-num=99></td><td><pre><span class="token keyword">DESC</span> myempll<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=100></td><td><pre><span class="token comment">/* 方式二 */</span></pre></td></tr><tr><td data-num=101></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> myemp2</pre></td></tr><tr><td data-num=102></td><td><pre><span class="token keyword">RENAME</span> <span class="token keyword">TO</span> myempl2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=103></td><td><pre></pre></td></tr><tr><td data-num=104></td><td><pre><span class="token comment">/* 删除表 */</span></pre></td></tr><tr><td data-num=105></td><td><pre><span class="token comment">/* 不光将表结构删除掉，同时表中的数据也删除掉，释放表空间 */</span></pre></td></tr><tr><td data-num=106></td><td><pre><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> myemp2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=107></td><td><pre><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> myempl2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=108></td><td><pre></pre></td></tr><tr><td data-num=109></td><td><pre><span class="token comment">/* 清空表 */</span></pre></td></tr><tr><td data-num=110></td><td><pre><span class="token comment">/* 清空表中的所有数据，但表结构保留 */</span></pre></td></tr><tr><td data-num=111></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees_copy<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=112></td><td><pre><span class="token keyword">TRUNCATE</span> <span class="token keyword">TABLE</span> employees_copy<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=113></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees_copy<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=114></td><td><pre><span class="token keyword">DESC</span> employees_copy<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=115></td><td><pre></pre></td></tr><tr><td data-num=116></td><td><pre><span class="token comment">/* DCL中COMMIT和ROLLBACK */</span></pre></td></tr><tr><td data-num=117></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=118></td><td><pre><span class="token comment">COMMIT: 提交数据</span></pre></td></tr><tr><td data-num=119></td><td><pre><span class="token comment">一旦执行COMMIT,则数据就被永久的保存在了数据库中，意味着数据不可以回滚。</span></pre></td></tr><tr><td data-num=120></td><td><pre><span class="token comment">ROLLBACK: 回滚数据</span></pre></td></tr><tr><td data-num=121></td><td><pre><span class="token comment">一旦执行ROLLBACK,则可以实现数据的回滚。</span></pre></td></tr><tr><td data-num=122></td><td><pre><span class="token comment"></span></pre></td></tr><tr><td data-num=123></td><td><pre><span class="token comment">对比TRUNCATE TABLE和DELETE FROM</span></pre></td></tr><tr><td data-num=124></td><td><pre><span class="token comment">相同点：都可以实现对表中所有数据的删除，同时保留表结构。</span></pre></td></tr><tr><td data-num=125></td><td><pre><span class="token comment">不同点</span></pre></td></tr><tr><td data-num=126></td><td><pre><span class="token comment">TRUNCATE TABLE: 一旦执行此操作，表数据全部清除。同时，数据是不可以回滚的。</span></pre></td></tr><tr><td data-num=127></td><td><pre><span class="token comment">DELETE FROM: 一旦执行此操作，表数据可以全部清除(不带WHERE)。同时数据是可以实现回滚</span></pre></td></tr><tr><td data-num=128></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=129></td><td><pre></pre></td></tr><tr><td data-num=130></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=131></td><td><pre><span class="token comment">DDL和DML的说明</span></pre></td></tr><tr><td data-num=132></td><td><pre><span class="token comment">DDL的操作一旦执行，就不可回滚。指令SET autocommit = FALSE对DDL操作失效，因为在执行完</span></pre></td></tr><tr><td data-num=133></td><td><pre><span class="token comment">DDL操作之后，一定会执行一次COMMIT.而此COMMIT操作不受SET autocommit = FALSE的影响。</span></pre></td></tr><tr><td data-num=134></td><td><pre><span class="token comment"></span></pre></td></tr><tr><td data-num=135></td><td><pre><span class="token comment">DML的操作默认情况，一旦执行，也是不可回滚的。但是，如果在执行DML之前，</span></pre></td></tr><tr><td data-num=136></td><td><pre><span class="token comment">执行了SET autocommit = FALSE,则执行的DML操作就可以实现回滚。</span></pre></td></tr><tr><td data-num=137></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=138></td><td><pre><span class="token keyword">COMMIT</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=139></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=140></td><td><pre><span class="token keyword">FROM</span> myemp3<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=141></td><td><pre></pre></td></tr><tr><td data-num=142></td><td><pre><span class="token keyword">SET</span> autocommit <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=143></td><td><pre><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> myemp3<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=144></td><td><pre></pre></td></tr><tr><td data-num=145></td><td><pre><span class="token keyword">ROLLBACK</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=146></td><td><pre></pre></td></tr><tr><td data-num=147></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=148></td><td><pre><span class="token keyword">FROM</span> myemp3<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=149></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=150></td><td><pre><span class="token comment">TRUNCATE TABLE比DELETE速度快，且使用的系统和事务日志资源少，</span></pre></td></tr><tr><td data-num=151></td><td><pre><span class="token comment">但TRUNCATE无事务且不触发TRIGGER,故不建议在开发代码中使用此语句。</span></pre></td></tr><tr><td data-num=152></td><td><pre><span class="token comment">*/</span></pre></td></tr></table></figure><h3 id=内容扩展><a class=anchor href=#内容扩展>#</a> 内容扩展</h3><p><strong>MySQL字段命令规范</strong></p><p>表名，字段名必须使用小写字母或数字，禁止出现数字开头，禁止两个下划线中间只出现数字。数据库字段名的修改代价很大，因为无法进行预发布，所以字段名称需要谨慎考虑。(例如.rdc_config,level3_name)</p><p>禁用保留字，如desc, range, match, delayed等。</p><p>表必备三字段：id, gmt_create,gmt_modified。其中id必为主键，类型位BIGINT UNSIGNED，单表时自增，步长为1。gmt_create,gmt_modified的类型均为DATETIME类型，前者现在时表示主动式创建，后者过去分词表示被动式更新。</p><p>表的命令最好是遵循&quot;业务名称_表的作用&quot;。(例如.force_project,trade_config)</p><p>库名与应用名称尽量一致。</p><p>合适的字符存储长度，不但节约数据库表空间，节约索引存储，更重要的是提升检索速度。</p><p><strong>如何理解清空表，删除表等操作需谨慎？</strong></p><p>表删除操作将把表的定义和表中的数据一起删除，并且MySQL在执行删除操作时，不会有任何的确认信息提示，因此执行删除操作时应当谨慎。在删除表前，最好对表中的数据进行备份，这样当操作失败时可以对数据进行恢复，以免造成无法挽回的后果。</p><p>同样的，在使用ALTER TABLE进行表的基本修改操作时，在执行操作过程之前，也应该确保对数据进行完整的备份，因为数据库的改变是无法撤销的，如果添加了一个不需要的字段，可以将其删除；相同的，如果删除了一个需要的列，该列下面的所有数据都将会丢弃。</p><p><strong>DDL的原子化(MySQL8)</strong></p><p>InnoDB表的DDL支持事务完整性，即DDL操作要么成功要么回滚。DDL操作回滚日志写入到data dictionary数据字典表mysql.innodb_ddl_log(该表是隐藏的表，通过show tables无法看到)中，用于回滚操作。通过设置参数，可将DDL操作日志打印输出到MySQL错误日志中。</p><p><strong>创建和管理表的练习/案例</strong></p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 创建数据库test01_office，指明字符集为utf8 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> test01_office <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token string">'utf8'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">USE</span>  test01_office<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=4></td><td><pre></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token comment">创建表dept01</span></pre></td></tr><tr><td data-num=7></td><td><pre><span class="token comment">字段 类型</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token comment">id  INT(7)</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token comment">NAME VARCHAR(25)</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> dept01<span class="token punctuation">(</span></pre></td></tr><tr><td data-num=12></td><td><pre>    id <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=13></td><td><pre>    <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre></pre></td></tr><tr><td data-num=16></td><td><pre><span class="token comment">/* 将表departments中的数据插入新表dept02中 */</span></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> dept02</pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">AS</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token keyword">FROM</span> departments<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=21></td><td><pre></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token comment">/*</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token comment">创建表emp01</span></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token comment">字段				类型</span></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token comment">id				 INT(7)</span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token comment">first_name		 VARCHAR(25)</span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token comment">last_name		 VARCHAR(25)</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token comment">dept_id			 INT(7)</span></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> emp01<span class="token punctuation">(</span></pre></td></tr><tr><td data-num=31></td><td><pre>	id <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=32></td><td><pre>    first_name	<span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=33></td><td><pre>    last_name	<span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=34></td><td><pre>    dept_id	<span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=36></td><td><pre></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token comment">/* 将列last_name的长度增加到50 */</span></pre></td></tr><tr><td data-num=38></td><td><pre><span class="token keyword">DESC</span> emp01<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=39></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> emp01</pre></td></tr><tr><td data-num=40></td><td><pre><span class="token keyword">MODIFY</span> last_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=41></td><td><pre></pre></td></tr><tr><td data-num=42></td><td><pre><span class="token comment">/* 根据表employees创建emp02 */</span></pre></td></tr><tr><td data-num=43></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> emp02</pre></td></tr><tr><td data-num=44></td><td><pre><span class="token keyword">AS</span></pre></td></tr><tr><td data-num=45></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=46></td><td><pre><span class="token keyword">FROM</span> atguigudb<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>employees<span class="token punctuation">`</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=47></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">TABLES</span> <span class="token keyword">FROM</span> test01_office<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=48></td><td><pre></pre></td></tr><tr><td data-num=49></td><td><pre><span class="token comment">/* 删除表emp01 */</span></pre></td></tr><tr><td data-num=50></td><td><pre><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> emp01<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=51></td><td><pre><span class="token keyword">ROLLBACK</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=52></td><td><pre></pre></td></tr><tr><td data-num=53></td><td><pre><span class="token comment">/* 将表emp02重命名为emp01 */</span></pre></td></tr><tr><td data-num=54></td><td><pre><span class="token comment">/* alter table emp02 rename to emp01; */</span></pre></td></tr><tr><td data-num=55></td><td><pre><span class="token keyword">RENAME</span> <span class="token keyword">TABLE</span> emp02 <span class="token keyword">TO</span> emp01<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=56></td><td><pre></pre></td></tr><tr><td data-num=57></td><td><pre><span class="token comment">/* 在表dept02和emp01中添加新列test_column,并检查所有的操作 */</span></pre></td></tr><tr><td data-num=58></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> emp01 <span class="token keyword">ADD</span> test_column <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=59></td><td><pre><span class="token keyword">DESC</span> emp01<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=60></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> dept02 <span class="token keyword">ADD</span> test_column <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=61></td><td><pre><span class="token keyword">DESC</span> dept02<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=62></td><td><pre></pre></td></tr><tr><td data-num=63></td><td><pre><span class="token comment">/* 直接删除表emp01中的列dept_id */</span></pre></td></tr><tr><td data-num=64></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> emp01</pre></td></tr><tr><td data-num=65></td><td><pre><span class="token keyword">DROP</span> <span class="token keyword">COLUMN</span> department_id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=66></td><td><pre></pre></td></tr><tr><td data-num=67></td><td><pre></pre></td></tr><tr><td data-num=68></td><td><pre><span class="token comment">/* 创建数据库test02_market */</span></pre></td></tr><tr><td data-num=69></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> test02_market <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token string">'utf8'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=70></td><td><pre><span class="token keyword">USE</span> test02_market<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=71></td><td><pre></pre></td></tr><tr><td data-num=72></td><td><pre><span class="token comment">/* 创建数据表customers */</span></pre></td></tr><tr><td data-num=73></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token keyword">TABLE</span> customers<span class="token punctuation">(</span></pre></td></tr><tr><td data-num=74></td><td><pre>    c_num <span class="token keyword">INT</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=75></td><td><pre>    c_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=76></td><td><pre>    c_contact <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=77></td><td><pre>    c_city <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=78></td><td><pre>    c_birth <span class="token keyword">DATE</span></pre></td></tr><tr><td data-num=79></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=80></td><td><pre><span class="token keyword">SHOW</span> <span class="token keyword">TABLES</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=81></td><td><pre></pre></td></tr><tr><td data-num=82></td><td><pre><span class="token comment">/* 将c_contack字段移动到c_birth字段后面 */</span></pre></td></tr><tr><td data-num=83></td><td><pre><span class="token keyword">DESC</span> customers<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=84></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> customers</pre></td></tr><tr><td data-num=85></td><td><pre><span class="token keyword">MODIFY</span> c_contact <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">AFTER</span> c_birth<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=86></td><td><pre></pre></td></tr><tr><td data-num=87></td><td><pre><span class="token comment">/* 将c_name字段数据类型改为varchar(70) */</span></pre></td></tr><tr><td data-num=88></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> customers</pre></td></tr><tr><td data-num=89></td><td><pre><span class="token keyword">MODIFY</span> c_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=90></td><td><pre></pre></td></tr><tr><td data-num=91></td><td><pre><span class="token comment">/* 将c_contact字段改名为c_phone */</span></pre></td></tr><tr><td data-num=92></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> customers</pre></td></tr><tr><td data-num=93></td><td><pre>CHANGE c_contact c_phone <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=94></td><td><pre></pre></td></tr><tr><td data-num=95></td><td><pre><span class="token comment">/* 增加c_gender字段到c_name后面，数据类型为char(1) */</span></pre></td></tr><tr><td data-num=96></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> customers</pre></td></tr><tr><td data-num=97></td><td><pre><span class="token keyword">ADD</span> c_gender <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">AFTER</span> c_name<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=98></td><td><pre></pre></td></tr><tr><td data-num=99></td><td><pre><span class="token comment">/* 将表名改为customers_info  */</span></pre></td></tr><tr><td data-num=100></td><td><pre><span class="token keyword">RENAME</span> <span class="token keyword">TABLE</span> customers</pre></td></tr><tr><td data-num=101></td><td><pre><span class="token keyword">TO</span> customers_info<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=102></td><td><pre><span class="token keyword">DESC</span> customers_info<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=103></td><td><pre></pre></td></tr><tr><td data-num=104></td><td><pre><span class="token comment">/* 删除字段c_city */</span></pre></td></tr><tr><td data-num=105></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> customers_info</pre></td></tr><tr><td data-num=106></td><td><pre><span class="token keyword">DROP</span> <span class="token keyword">COLUMN</span> c_city<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=107></td><td><pre></pre></td></tr><tr><td data-num=108></td><td><pre><span class="token comment">/* 创建数据库test03_company */</span></pre></td></tr><tr><td data-num=109></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> test03_company <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token string">'utf8'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=110></td><td><pre><span class="token keyword">USE</span> test03_company<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=111></td><td><pre></pre></td></tr><tr><td data-num=112></td><td><pre><span class="token comment">/* 创建表offices */</span></pre></td></tr><tr><td data-num=113></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> offices<span class="token punctuation">(</span></pre></td></tr><tr><td data-num=114></td><td><pre>    officeCode <span class="token keyword">INT</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=115></td><td><pre>    city <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=116></td><td><pre>    address <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=117></td><td><pre>    country <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=118></td><td><pre>    country <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=119></td><td><pre>    postalCode <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=120></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=121></td><td><pre></pre></td></tr><tr><td data-num=122></td><td><pre><span class="token comment">/* 创建表employees */</span></pre></td></tr><tr><td data-num=123></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> employees<span class="token punctuation">(</span></pre></td></tr><tr><td data-num=124></td><td><pre>    empNum <span class="token keyword">INT</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=125></td><td><pre>    lastName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=126></td><td><pre>    firstName <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=127></td><td><pre>    mobile <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=128></td><td><pre>    <span class="token identifier"><span class="token punctuation">`</span>code<span class="token punctuation">`</span></span> <span class="token keyword">INT</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=129></td><td><pre>    jobTitle <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=130></td><td><pre>    birth <span class="token keyword">DATE</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=131></td><td><pre>    note <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=132></td><td><pre>    sex <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=133></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=134></td><td><pre><span class="token keyword">DESC</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=135></td><td><pre><span class="token comment">/* 将表employees的mobile字段修改到code字段 */</span></pre></td></tr><tr><td data-num=136></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> employees</pre></td></tr><tr><td data-num=137></td><td><pre><span class="token keyword">MODIFY</span> mobile <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">AFTER</span> <span class="token identifier"><span class="token punctuation">`</span>code<span class="token punctuation">`</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=138></td><td><pre></pre></td></tr><tr><td data-num=139></td><td><pre><span class="token comment">/* 将表employees的birth字段改名为birthday */</span></pre></td></tr><tr><td data-num=140></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> employees</pre></td></tr><tr><td data-num=141></td><td><pre>CHANGE birth birthday <span class="token keyword">DATE</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=142></td><td><pre></pre></td></tr><tr><td data-num=143></td><td><pre><span class="token comment">/* 修改sex字段，数据类型为char(1) */</span></pre></td></tr><tr><td data-num=144></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> employees</pre></td></tr><tr><td data-num=145></td><td><pre><span class="token keyword">MODIFY</span> sex <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=146></td><td><pre></pre></td></tr><tr><td data-num=147></td><td><pre><span class="token comment">/* 删除字段note */</span></pre></td></tr><tr><td data-num=148></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> employees</pre></td></tr><tr><td data-num=149></td><td><pre><span class="token keyword">DROP</span> <span class="token keyword">COLUMN</span> note<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=150></td><td><pre></pre></td></tr><tr><td data-num=151></td><td><pre><span class="token comment">/* 增加字段名favoriate_activity,数据类型为varchar(100) */</span></pre></td></tr><tr><td data-num=152></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> employees</pre></td></tr><tr><td data-num=153></td><td><pre><span class="token keyword">ADD</span> favoriate_activity <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=154></td><td><pre></pre></td></tr><tr><td data-num=155></td><td><pre><span class="token comment">/* 将表employees的名称修改为employees_info */</span></pre></td></tr><tr><td data-num=156></td><td><pre><span class="token keyword">RENAME</span> <span class="token keyword">TABLE</span> employees <span class="token keyword">TO</span> employees_info<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=157></td><td><pre><span class="token keyword">DESC</span> employees_info<span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id=增删改dml><a class=anchor href=#增删改dml>#</a> 增删改(DML)</h2><h3 id=插入数据><a class=anchor href=#插入数据>#</a> 插入数据</h3><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 储备工作 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">USE</span> atguigudb<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> emp1<span class="token punctuation">(</span></pre></td></tr><tr><td data-num=4></td><td><pre>    id <span class="token keyword">INT</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=5></td><td><pre>    <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=6></td><td><pre>    hire_date <span class="token keyword">DATE</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=7></td><td><pre>    salary <span class="token keyword">DOUBLE</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">DESC</span> emp1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">FROM</span> emp1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=12></td><td><pre></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token comment">/* 一条一条的添加数据 */</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token comment">/* 方式一 - 没有指明添加的字段 */</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> emp1</pre></td></tr><tr><td data-num=16></td><td><pre><span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'Tom'</span><span class="token punctuation">,</span><span class="token string">'2000-12-21'</span><span class="token punctuation">,</span><span class="token number">3400</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* 一定要按照声明的字段的先后顺序添加 */</span></pre></td></tr><tr><td data-num=17></td><td><pre></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token comment">/* 方式二 - 指明要添加的字段(推荐) */</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> emp1<span class="token punctuation">(</span>id<span class="token punctuation">,</span>hire_date<span class="token punctuation">,</span>salary<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'Tom'</span><span class="token punctuation">,</span><span class="token string">'2000-12-21'</span><span class="token punctuation">,</span><span class="token number">3400</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=21></td><td><pre></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token comment">/* 没有进行赋值的hire_date的值为NULL */</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> emp1<span class="token punctuation">(</span>id<span class="token punctuation">,</span>salary<span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4500</span><span class="token punctuation">,</span><span class="token string">'shk'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=25></td><td><pre></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token comment">/* 方式三 - 同时插入多条记录(推荐)*/</span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> emp1<span class="token punctuation">(</span>id<span class="token punctuation">,</span>NAME<span class="token punctuation">,</span>salary<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token keyword">VALUES</span></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'Jim'</span><span class="token punctuation">,</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'xxxx'</span><span class="token punctuation">,</span><span class="token number">5500</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=31></td><td><pre></pre></td></tr><tr><td data-num=32></td><td><pre><span class="token comment">/* 将查询结果插入到表中 */</span></pre></td></tr><tr><td data-num=33></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> ROM emp1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=34></td><td><pre></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> emp1<span class="token punctuation">(</span>id<span class="token punctuation">,</span>NAME<span class="token punctuation">,</span>salary<span class="token punctuation">,</span>hire_date<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token keyword">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>salary<span class="token punctuation">,</span>hire_date <span class="token comment">/* 查询的字段一定要与添加到表的字段一一对应 */</span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token keyword">FROM</span> employees</pre></td></tr><tr><td data-num=38></td><td><pre><span class="token keyword">WHERE</span> department_id <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=39></td><td><pre></pre></td></tr><tr><td data-num=40></td><td><pre><span class="token keyword">DESC</span> emp1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=41></td><td><pre><span class="token keyword">DESC</span> employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=42></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=43></td><td><pre><span class="token comment">emp1表中要添加数据的字段的长度不能低于employees表中查询的字段的长度</span></pre></td></tr><tr><td data-num=44></td><td><pre><span class="token comment">如果emp1表中要添加数据的字段的长度低于employees表中查询的字段的长度的话，</span></pre></td></tr><tr><td data-num=45></td><td><pre><span class="token comment">就有添加不成功的风险</span></pre></td></tr><tr><td data-num=46></td><td><pre><span class="token comment">*/</span></pre></td></tr></table></figure><h3 id=更新数据><a class=anchor href=#更新数据>#</a> 更新数据</h3><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* UPDATE ... SET ... WHERE ... */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token comment">可以实现批量修改数据</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token comment">修改数据时，是有可能不成功的(可能是由于约束的影响造成的)</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">UPDATE</span> emp1</pre></td></tr><tr><td data-num=7></td><td><pre><span class="token keyword">SET</span> hire_date <span class="token operator">=</span> CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> emp1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=11></td><td><pre></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token comment">/* 同时修改一条数据的多个字段 */</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token keyword">UPDATE</span> emp1</pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">SET</span> hire_date <span class="token operator">=</span> CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>salary <span class="token operator">=</span> <span class="token number">6000</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token comment">/* 将表中姓名中包含字符a的提薪20% */</span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token keyword">UPDATE</span> emp1</pre></td></tr><tr><td data-num=19></td><td><pre><span class="token keyword">SET</span> salary <span class="token operator">=</span> salary <span class="token operator">*</span> <span class="token number">1.2</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token keyword">WHERE</span> NAME <span class="token operator">LIKE</span> <span class="token string">'%a%'</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id=删除数据><a class=anchor href=#删除数据>#</a> 删除数据</h3><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token comment">删除数据 DELETE FROM ... WHERE ...</span></pre></td></tr><tr><td data-num=3></td><td><pre><span class="token comment">在删除数据时，也有可能因为约束的影响，导致删除失败</span></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> emp1</pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=7></td><td><pre></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> departments</pre></td></tr><tr><td data-num=9></td><td><pre><span class="token keyword">WHERE</span> department_id <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token comment">DML操作默认情况下，执行完以后都会自动提交数据</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token comment">如果希望执行完以后不自动提交数据，则需要使用SET autocommit = FALSE</span></pre></td></tr><tr><td data-num=13></td><td><pre><span class="token comment">*/</span></pre></td></tr></table></figure><h3 id=计算列mysql8><a class=anchor href=#计算列mysql8>#</a> 计算列(MySQL8)</h3><p>指某一列的值是通过别的列计算得来的。</p><p>在MySQL8.0中，CREATE TABLE和ALTER TABLE中都支持增加计算列。</p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 计算列 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">USE</span> atguigudb<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> test1<span class="token punctuation">(</span></pre></td></tr><tr><td data-num=5></td><td><pre>    a	<span class="token keyword">INT</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=6></td><td><pre>    b	<span class="token keyword">INT</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=7></td><td><pre>    c	<span class="token keyword">INT</span>	GENERATED ALWAYS <span class="token keyword">AS</span> <span class="token punctuation">(</span>a <span class="token operator">+</span> b<span class="token punctuation">)</span> VIRTUAL<span class="token comment">/* 字段c即为计算列 */</span></pre></td></tr><tr><td data-num=8></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=9></td><td><pre></pre></td></tr><tr><td data-num=10></td><td><pre><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> tset1<span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=11></td><td><pre><span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>综合练习/案例</strong></p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 创建数据库test01_library */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> test01_library <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token string">'utf8'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token keyword">USE</span> test01_library<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token comment">/* 创建表books,表结构如下 */</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> books<span class="token punctuation">(</span></pre></td></tr><tr><td data-num=7></td><td><pre>    id	<span class="token keyword">INT</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=8></td><td><pre>    <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span>	<span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=9></td><td><pre>    <span class="token identifier"><span class="token punctuation">`</span>authors<span class="token punctuation">`</span></span>	<span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=10></td><td><pre>    price	<span class="token keyword">FLOAT</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=11></td><td><pre>    pubdate	<span class="token keyword">YEAR</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=12></td><td><pre>    note	<span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=13></td><td><pre>    num	<span class="token keyword">INT</span></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=15></td><td><pre><span class="token keyword">DESC</span> books<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=16></td><td><pre></pre></td></tr><tr><td data-num=17></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> books<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token comment">/* 向books表中插入记录 */</span></pre></td></tr><tr><td data-num=19></td><td><pre><span class="token comment">/* 不指定字段名称，插入第一条记录 */</span></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> books</pre></td></tr><tr><td data-num=21></td><td><pre><span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'Tal of AAA'</span><span class="token punctuation">,</span><span class="token string">'Dickes'</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token string">'1995'</span><span class="token punctuation">,</span><span class="token string">'novel'</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=22></td><td><pre><span class="token comment">/* 指定所有字段名称，插入第二记录 */</span></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> books<span class="token punctuation">(</span>id<span class="token punctuation">,</span>NAME<span class="token punctuation">,</span>AUTHORS<span class="token punctuation">,</span>price<span class="token punctuation">,</span>pubdate<span class="token punctuation">,</span><span class="token operator">not</span><span class="token punctuation">,</span>num<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token comment">/* 同时插入多条记录(剩下的所有记录) */</span></pre></td></tr><tr><td data-num=25></td><td><pre><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> books<span class="token punctuation">(</span>id<span class="token punctuation">,</span>NAME<span class="token punctuation">,</span>AUTHORS<span class="token punctuation">,</span>price<span class="token punctuation">,</span>pubdate<span class="token punctuation">,</span><span class="token operator">not</span><span class="token punctuation">,</span>num<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=26></td><td><pre><span class="token keyword">VALUES</span></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'Story of Jane'</span><span class="token punctuation">,</span><span class="token string">'Jane Tim'</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">2001</span><span class="token punctuation">,</span><span class="token string">'novel'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'Lovey Day'</span><span class="token punctuation">,</span><span class="token string">'George Byron'</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">2005</span><span class="token punctuation">,</span><span class="token string">'novel'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'Old land'</span><span class="token punctuation">,</span><span class="token string">'Honore Blade'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">2010</span><span class="token punctuation">,</span><span class="token string">'Law'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">'The Battle'</span><span class="token punctuation">,</span><span class="token string">'Upton Sara'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">1999</span><span class="token punctuation">,</span><span class="token string">'medicine'</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token string">'Rose Hood'</span><span class="token punctuation">,</span><span class="token string">'Richard haggard'</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">,</span><span class="token number">2008</span><span class="token punctuation">,</span><span class="token string">'cartoon'</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=32></td><td><pre></pre></td></tr><tr><td data-num=33></td><td><pre><span class="token comment">/* 将小说类型(novel)的书的价格都增加5 */</span></pre></td></tr><tr><td data-num=34></td><td><pre><span class="token keyword">UPDATE</span> books</pre></td></tr><tr><td data-num=35></td><td><pre><span class="token keyword">SET</span> price <span class="token operator">=</span> price <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token keyword">WHERE</span> note <span class="token operator">=</span> <span class="token string">'novel'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=37></td><td><pre></pre></td></tr><tr><td data-num=38></td><td><pre><span class="token comment">/* 将名称为EmmaT的书的价格改为40，并将说明改为drama */</span></pre></td></tr><tr><td data-num=39></td><td><pre><span class="token keyword">UPDATE</span> books</pre></td></tr><tr><td data-num=40></td><td><pre><span class="token keyword">SET</span> price <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">,</span>note <span class="token operator">=</span> <span class="token string">'drama'</span></pre></td></tr><tr><td data-num=41></td><td><pre><span class="token keyword">WHERE</span> NAME <span class="token operator">=</span> <span class="token string">'EmmaT'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=42></td><td><pre></pre></td></tr><tr><td data-num=43></td><td><pre><span class="token comment">/* 删除库存为0的记录 */</span></pre></td></tr><tr><td data-num=44></td><td><pre><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> books</pre></td></tr><tr><td data-num=45></td><td><pre><span class="token keyword">WHERE</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=46></td><td><pre></pre></td></tr><tr><td data-num=47></td><td><pre><span class="token comment">/* 统计书名中包含a字母的书 */</span></pre></td></tr><tr><td data-num=48></td><td><pre><span class="token keyword">SELECT</span> NAME</pre></td></tr><tr><td data-num=49></td><td><pre><span class="token keyword">FROM</span> books</pre></td></tr><tr><td data-num=50></td><td><pre><span class="token keyword">WHERE</span> NAME <span class="token operator">LIKE</span> <span class="token string">'%a%'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=51></td><td><pre></pre></td></tr><tr><td data-num=52></td><td><pre><span class="token comment">/* 统计书名中包含a字母的书的数量和库存总量 */</span></pre></td></tr><tr><td data-num=53></td><td><pre><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=54></td><td><pre><span class="token keyword">FROM</span> books</pre></td></tr><tr><td data-num=55></td><td><pre><span class="token keyword">WHERE</span> NAME <span class="token operator">LIKE</span> <span class="token string">'%a%'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=56></td><td><pre></pre></td></tr><tr><td data-num=57></td><td><pre><span class="token comment">/* 找出“novel”类型的书，按照价格降序排序 */</span></pre></td></tr><tr><td data-num=58></td><td><pre><span class="token keyword">SELECT</span> NAME<span class="token punctuation">,</span>note<span class="token punctuation">,</span>price</pre></td></tr><tr><td data-num=59></td><td><pre><span class="token keyword">FROM</span> books</pre></td></tr><tr><td data-num=60></td><td><pre><span class="token keyword">WHERE</span> note <span class="token operator">=</span> <span class="token string">'novel'</span></pre></td></tr><tr><td data-num=61></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> price <span class="token keyword">DESC</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=62></td><td><pre></pre></td></tr><tr><td data-num=63></td><td><pre><span class="token comment">/* 查询图书信息，按照库存量降序排列，如果库存量相同的按照note升序排列 */</span></pre></td></tr><tr><td data-num=64></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=65></td><td><pre><span class="token keyword">FROM</span> books</pre></td></tr><tr><td data-num=66></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> num <span class="token keyword">DESC</span><span class="token punctuation">,</span>note <span class="token keyword">ASC</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=67></td><td><pre></pre></td></tr><tr><td data-num=68></td><td><pre><span class="token comment">/* 按照note分类统计书的数量 */</span></pre></td></tr><tr><td data-num=69></td><td><pre><span class="token keyword">SELECT</span> note<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=70></td><td><pre><span class="token keyword">FROM</span> books</pre></td></tr><tr><td data-num=71></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> note<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=72></td><td><pre></pre></td></tr><tr><td data-num=73></td><td><pre><span class="token comment">/* 按照note分类统计书的库存量，显示库存量超过30本的 */</span></pre></td></tr><tr><td data-num=74></td><td><pre><span class="token keyword">SELECT</span> note<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=75></td><td><pre><span class="token keyword">FROM</span> books</pre></td></tr><tr><td data-num=76></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> note</pre></td></tr><tr><td data-num=77></td><td><pre><span class="token keyword">HAVING</span> <span class="token function">SUM</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">30</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=78></td><td><pre></pre></td></tr><tr><td data-num=79></td><td><pre><span class="token comment">/* 查询所有图书，每页显示6本，显示第二页 */</span></pre></td></tr><tr><td data-num=80></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=81></td><td><pre><span class="token keyword">FROM</span> books</pre></td></tr><tr><td data-num=82></td><td><pre><span class="token keyword">LIMIT</span> <span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=83></td><td><pre></pre></td></tr><tr><td data-num=84></td><td><pre><span class="token comment">/* 按照note分类统计书的库存量，显示库存量最多的 */</span></pre></td></tr><tr><td data-num=85></td><td><pre><span class="token keyword">SELECT</span> note<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> sum_num</pre></td></tr><tr><td data-num=86></td><td><pre><span class="token keyword">FROM</span> books</pre></td></tr><tr><td data-num=87></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> note</pre></td></tr><tr><td data-num=88></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> sum_num <span class="token keyword">DESC</span></pre></td></tr><tr><td data-num=89></td><td><pre><span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=90></td><td><pre></pre></td></tr><tr><td data-num=91></td><td><pre><span class="token comment">/* 查询书名达到10个字符的书，不包括里面的空格 */</span></pre></td></tr><tr><td data-num=92></td><td><pre><span class="token keyword">SELECT</span> CHAR_LENGTH<span class="token punctuation">(</span><span class="token keyword">REPLACE</span><span class="token punctuation">(</span>NAME<span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=93></td><td><pre><span class="token keyword">FROM</span> books<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=94></td><td><pre></pre></td></tr><tr><td data-num=95></td><td><pre><span class="token keyword">SELECT</span> NAME</pre></td></tr><tr><td data-num=96></td><td><pre><span class="token keyword">FROM</span> books</pre></td></tr><tr><td data-num=97></td><td><pre><span class="token keyword">WHERE</span> CHAR_LENGTH<span class="token punctuation">(</span><span class="token keyword">REPLACE</span><span class="token punctuation">(</span>NAME<span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=98></td><td><pre><span class="token comment">/* 查询书名和类型，其中note值为novel显示小说,law显示法律，medicine显示医药 */</span></pre></td></tr><tr><td data-num=99></td><td><pre><span class="token keyword">SELECT</span> NAME <span class="token string">"书名"</span><span class="token punctuation">,</span>note<span class="token punctuation">,</span><span class="token keyword">CASE</span> note <span class="token keyword">WHEN</span> <span class="token string">'novel'</span> <span class="token keyword">THEN</span> <span class="token string">'小说'</span></pre></td></tr><tr><td data-num=100></td><td><pre>								 <span class="token keyword">WHEN</span> <span class="token string">'law'</span> <span class="token keyword">THEN</span> <span class="token string">'法律'</span></pre></td></tr><tr><td data-num=101></td><td><pre>								 <span class="token keyword">WHEN</span> <span class="token string">'medicine'</span> <span class="token keyword">THEN</span> <span class="token string">'医药'</span></pre></td></tr><tr><td data-num=102></td><td><pre>								 <span class="token keyword">WHEN</span> <span class="token string">'cartoon'</span>  <span class="token keyword">THEN</span> <span class="token string">'卡通'</span></pre></td></tr><tr><td data-num=103></td><td><pre>								 <span class="token keyword">WHEN</span> <span class="token string">'joke'</span>	<span class="token keyword">THEN</span> <span class="token string">'笑话'</span></pre></td></tr><tr><td data-num=104></td><td><pre>								 <span class="token keyword">ELSE</span> <span class="token string">'其他'</span></pre></td></tr><tr><td data-num=105></td><td><pre>								 <span class="token keyword">END</span> <span class="token string">"类型"</span></pre></td></tr><tr><td data-num=106></td><td><pre><span class="token keyword">FROM</span> boosk<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=107></td><td><pre> </pre></td></tr><tr><td data-num=108></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num=109></td><td><pre><span class="token comment">查询书名，库存，其中num值超过30本的，显示滞销，</span></pre></td></tr><tr><td data-num=110></td><td><pre><span class="token comment">大于0并低于10的，显示畅销，为0的显示无货</span></pre></td></tr><tr><td data-num=111></td><td><pre><span class="token comment">*/</span></pre></td></tr><tr><td data-num=112></td><td><pre><span class="token keyword">SELECT</span> NAME <span class="token keyword">AS</span> <span class="token string">"书名"</span><span class="token punctuation">,</span>num <span class="token keyword">AS</span> <span class="token string">"库存"</span><span class="token punctuation">,</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> num <span class="token operator">></span> <span class="token number">30</span> <span class="token keyword">THEN</span> <span class="token string">'滞销'</span></pre></td></tr><tr><td data-num=113></td><td><pre>										<span class="token keyword">WHEN</span> num <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">AND</span> num <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token keyword">THEN</span> <span class="token string">'畅销'</span></pre></td></tr><tr><td data-num=114></td><td><pre>										<span class="token keyword">WHEN</span> num <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token string">'无货'</span></pre></td></tr><tr><td data-num=115></td><td><pre>										<span class="token keyword">END</span> <span class="token string">"显示状态"</span></pre></td></tr><tr><td data-num=116></td><td><pre><span class="token keyword">FROM</span> books<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=117></td><td><pre></pre></td></tr><tr><td data-num=118></td><td><pre><span class="token comment">/* 统计每一种note的库存量，并合计总量 */</span></pre></td></tr><tr><td data-num=119></td><td><pre><span class="token keyword">SELECT</span> IFNULL<span class="token punctuation">(</span>note<span class="token punctuation">,</span><span class="token string">'合计库存量'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> note<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span></pre></td></tr><tr><td data-num=120></td><td><pre><span class="token keyword">FROM</span> books</pre></td></tr><tr><td data-num=121></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> note <span class="token keyword">WITH ROLLUP</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=122></td><td><pre></pre></td></tr><tr><td data-num=123></td><td><pre><span class="token comment">/* 统计每一种note的数量，并合计总量 */</span></pre></td></tr><tr><td data-num=124></td><td><pre><span class="token keyword">SELECT</span> IFNULL<span class="token punctuation">(</span>note<span class="token punctuation">,</span><span class="token string">'合计总量'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> note<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=125></td><td><pre><span class="token keyword">FROM</span> books</pre></td></tr><tr><td data-num=126></td><td><pre><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> note <span class="token keyword">WITH ROLLUP</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=127></td><td><pre></pre></td></tr><tr><td data-num=128></td><td><pre><span class="token comment">/* 统计库存量前三名的图书 */</span></pre></td></tr><tr><td data-num=129></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=130></td><td><pre><span class="token keyword">FROM</span> books</pre></td></tr><tr><td data-num=131></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> num <span class="token keyword">DESC</span></pre></td></tr><tr><td data-num=132></td><td><pre><span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=133></td><td><pre></pre></td></tr><tr><td data-num=134></td><td><pre><span class="token comment">/* 找出最早出版的一本书 */</span></pre></td></tr><tr><td data-num=135></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=136></td><td><pre><span class="token keyword">FROM</span> books</pre></td></tr><tr><td data-num=137></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> pubdate <span class="token keyword">ASC</span></pre></td></tr><tr><td data-num=138></td><td><pre><span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=139></td><td><pre></pre></td></tr><tr><td data-num=140></td><td><pre><span class="token comment">/* 找出novel中价格最高的一本书 */</span></pre></td></tr><tr><td data-num=141></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=142></td><td><pre><span class="token keyword">FROM</span> books</pre></td></tr><tr><td data-num=143></td><td><pre><span class="token keyword">WHERE</span> note <span class="token operator">=</span> <span class="token string">'novel'</span></pre></td></tr><tr><td data-num=144></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> price <span class="token keyword">DESC</span></pre></td></tr><tr><td data-num=145></td><td><pre><span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=146></td><td><pre></pre></td></tr><tr><td data-num=147></td><td><pre><span class="token comment">/* 找出书名中字数最多的一本书，不含空格 */</span></pre></td></tr><tr><td data-num=148></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=149></td><td><pre><span class="token keyword">FROM</span> books</pre></td></tr><tr><td data-num=150></td><td><pre><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> CHAR_LENGTH<span class="token punctuation">(</span><span class="token keyword">REPLACE</span><span class="token punctuation">(</span>NAME<span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>增删改练习/案例</strong></p><figure class="highlight sql"><figcaption data-lang=SQL></figcaption><table><tr><td data-num=1></td><td><pre><span class="token comment">/* 创建数据库dbtest11 */</span></pre></td></tr><tr><td data-num=2></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> dbtest11 <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token string">'utf8'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=3></td><td><pre></pre></td></tr><tr><td data-num=4></td><td><pre><span class="token comment">/* 运行以下脚本创建表my_employees */</span></pre></td></tr><tr><td data-num=5></td><td><pre><span class="token keyword">USE</span> dbtest11<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=6></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> my_employees<span class="token punctuation">(</span></pre></td></tr><tr><td data-num=7></td><td><pre>    id	<span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=8></td><td><pre>    first_name	<span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=9></td><td><pre>    last_name	<span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=10></td><td><pre>    userid	<span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=11></td><td><pre>    salary	<span class="token keyword">DOUBLE</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=12></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=13></td><td><pre></pre></td></tr><tr><td data-num=14></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> users<span class="token punctuation">(</span></pre></td></tr><tr><td data-num=15></td><td><pre>    id	<span class="token keyword">INT</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=16></td><td><pre>    userid	<span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=17></td><td><pre>    department_id	<span class="token keyword">INT</span></pre></td></tr><tr><td data-num=18></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=19></td><td><pre></pre></td></tr><tr><td data-num=20></td><td><pre><span class="token comment">/* 显示表my_employees的结构 */</span></pre></td></tr><tr><td data-num=21></td><td><pre><span class="token keyword">DESC</span> my_employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=22></td><td><pre></pre></td></tr><tr><td data-num=23></td><td><pre><span class="token comment">/* 向my_employees表中插入下列数据 */</span></pre></td></tr><tr><td data-num=24></td><td><pre><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> my_employees</pre></td></tr><tr><td data-num=25></td><td><pre><span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'patel'</span><span class="token punctuation">,</span><span class="token string">'Ralph'</span><span class="token punctuation">,</span><span class="token string">'Rpatel'</span><span class="token punctuation">,</span><span class="token number">895</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=26></td><td><pre></pre></td></tr><tr><td data-num=27></td><td><pre><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> my_employees <span class="token keyword">VALUES</span></pre></td></tr><tr><td data-num=28></td><td><pre><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'Dancs'</span><span class="token punctuation">,</span><span class="token string">'Betty'</span><span class="token punctuation">,</span><span class="token string">'Bdancs'</span><span class="token punctuation">,</span><span class="token number">860</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=29></td><td><pre><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'Biri'</span><span class="token punctuation">,</span><span class="token string">'Ben'</span><span class="token punctuation">,</span><span class="token string">'Bbiri'</span><span class="token punctuation">,</span><span class="token number">1100</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=30></td><td><pre><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'Newman'</span><span class="token punctuation">,</span><span class="token string">'Chad'</span><span class="token punctuation">,</span><span class="token string">'Cnewman'</span><span class="token punctuation">,</span><span class="token number">750</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=31></td><td><pre><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'Ropeburn'</span><span class="token punctuation">,</span><span class="token string">'Audrey'</span><span class="token punctuation">,</span><span class="token string">'Bdancs'</span><span class="token punctuation">,</span><span class="token number">1550</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=32></td><td><pre></pre></td></tr><tr><td data-num=33></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> my_employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=34></td><td><pre></pre></td></tr><tr><td data-num=35></td><td><pre><span class="token comment">/* 向users表中插入数据 */</span></pre></td></tr><tr><td data-num=36></td><td><pre><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> users <span class="token keyword">VALUES</span></pre></td></tr><tr><td data-num=37></td><td><pre><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'Rpatel'</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=38></td><td><pre><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'Bdancs'</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=39></td><td><pre><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'Bbiri'</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=40></td><td><pre><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'Cnewman'</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=41></td><td><pre><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'Aropebur'</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=42></td><td><pre></pre></td></tr><tr><td data-num=43></td><td><pre>SELCT <span class="token operator">*</span> <span class="token keyword">FROM</span> users<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=44></td><td><pre></pre></td></tr><tr><td data-num=45></td><td><pre><span class="token comment">/* 将3号员工的last_name修改为“drelxer” */</span></pre></td></tr><tr><td data-num=46></td><td><pre><span class="token keyword">UPDATE</span> my_employees</pre></td></tr><tr><td data-num=47></td><td><pre><span class="token keyword">SET</span> last_name <span class="token operator">=</span> <span class="token string">'drelxer'</span></pre></td></tr><tr><td data-num=48></td><td><pre><span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=49></td><td><pre></pre></td></tr><tr><td data-num=50></td><td><pre><span class="token comment">/* 将所有工资少于900的员工的工资修改为1000 */</span></pre></td></tr><tr><td data-num=51></td><td><pre><span class="token keyword">UPDATE</span> my_employees</pre></td></tr><tr><td data-num=52></td><td><pre><span class="token keyword">SET</span> salary <span class="token operator">=</span> <span class="token number">1000</span></pre></td></tr><tr><td data-num=53></td><td><pre><span class="token keyword">WHERE</span> salary <span class="token operator">&lt;</span> <span class="token number">900</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=54></td><td><pre></pre></td></tr><tr><td data-num=55></td><td><pre><span class="token comment">/* 将userid为Bbiri的user表和my_employees表的记录全部删除 */</span></pre></td></tr><tr><td data-num=56></td><td><pre><span class="token comment">/* 方式一 */</span></pre></td></tr><tr><td data-num=57></td><td><pre><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> my_employees</pre></td></tr><tr><td data-num=58></td><td><pre><span class="token keyword">WHERE</span> userid <span class="token operator">=</span> <span class="token string">'Bbiri'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=59></td><td><pre></pre></td></tr><tr><td data-num=60></td><td><pre><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> users</pre></td></tr><tr><td data-num=61></td><td><pre><span class="token keyword">WHERE</span> userid <span class="token operator">=</span> <span class="token string">'Bbiri'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=62></td><td><pre></pre></td></tr><tr><td data-num=63></td><td><pre><span class="token comment">/* 方式二 */</span></pre></td></tr><tr><td data-num=64></td><td><pre><span class="token keyword">DELETE</span> m<span class="token punctuation">,</span>u</pre></td></tr><tr><td data-num=65></td><td><pre><span class="token keyword">FROM</span> my_employees m</pre></td></tr><tr><td data-num=66></td><td><pre><span class="token keyword">JOIN</span> users u</pre></td></tr><tr><td data-num=67></td><td><pre><span class="token keyword">ON</span> m<span class="token punctuation">.</span>userid <span class="token operator">=</span> u<span class="token punctuation">.</span>userid</pre></td></tr><tr><td data-num=68></td><td><pre><span class="token keyword">WHERE</span> m<span class="token punctuation">.</span>userid <span class="token operator">=</span> <span class="token string">'Bbiri'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=69></td><td><pre></pre></td></tr><tr><td data-num=70></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> my_employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=71></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=72></td><td><pre><span class="token comment">/* 删除my_employees,users表所有数据 */</span></pre></td></tr><tr><td data-num=73></td><td><pre><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> my_employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=74></td><td><pre><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> users<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=75></td><td><pre></pre></td></tr><tr><td data-num=76></td><td><pre><span class="token comment">/* 检查所作的修正 */</span></pre></td></tr><tr><td data-num=77></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> my_employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=78></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=79></td><td><pre></pre></td></tr><tr><td data-num=80></td><td><pre><span class="token comment">/* 清空表my_employees */</span></pre></td></tr><tr><td data-num=81></td><td><pre><span class="token keyword">TRUNCATE</span> <span class="token keyword">TABLE</span> my_employees<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=82></td><td><pre></pre></td></tr><tr><td data-num=83></td><td><pre><span class="token comment">/* ........... */</span></pre></td></tr><tr><td data-num=84></td><td><pre><span class="token comment">/* 使用现有数据库dbtest11 */</span></pre></td></tr><tr><td data-num=85></td><td><pre><span class="token keyword">USE</span> dbtest11<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=86></td><td><pre></pre></td></tr><tr><td data-num=87></td><td><pre><span class="token comment">/* 创建表格pet */</span></pre></td></tr><tr><td data-num=88></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> pet<span class="token punctuation">(</span></pre></td></tr><tr><td data-num=89></td><td><pre>    NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=90></td><td><pre>    OWNER <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=91></td><td><pre>    species <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=92></td><td><pre>    sex <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=93></td><td><pre>    birth <span class="token keyword">YEAR</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=94></td><td><pre>    death <span class="token keyword">YEAR</span></pre></td></tr><tr><td data-num=95></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=96></td><td><pre><span class="token keyword">DESC</span> pet<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=97></td><td><pre></pre></td></tr><tr><td data-num=98></td><td><pre><span class="token comment">/* 添加记录 */</span></pre></td></tr><tr><td data-num=99></td><td><pre><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> pet <span class="token keyword">VALUES</span></pre></td></tr><tr><td data-num=100></td><td><pre><span class="token punctuation">(</span><span class="token string">'Fluffy'</span><span class="token punctuation">,</span><span class="token string">'harold'</span><span class="token punctuation">,</span><span class="token string">'Cat'</span><span class="token punctuation">,</span><span class="token string">'f'</span><span class="token punctuation">,</span><span class="token string">'2003'</span><span class="token punctuation">,</span><span class="token string">'2010'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=101></td><td><pre><span class="token punctuation">(</span><span class="token string">'Claws'</span><span class="token punctuation">,</span><span class="token string">'gwen'</span><span class="token punctuation">,</span><span class="token string">'Cat'</span><span class="token punctuation">,</span><span class="token string">'m'</span><span class="token punctuation">,</span><span class="token string">'2004'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=102></td><td><pre><span class="token punctuation">(</span><span class="token string">'Buffy'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token string">'Dog'</span><span class="token punctuation">,</span><span class="token string">'f'</span><span class="token punctuation">,</span><span class="token string">'2009'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=103></td><td><pre><span class="token punctuation">(</span><span class="token string">'Fang'</span><span class="token punctuation">,</span><span class="token string">'benny'</span><span class="token punctuation">,</span><span class="token string">'Dog'</span><span class="token punctuation">,</span><span class="token string">'m'</span><span class="token punctuation">,</span><span class="token string">'2000'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=104></td><td><pre><span class="token punctuation">(</span><span class="token string">'bowser'</span><span class="token punctuation">,</span><span class="token string">'diane'</span><span class="token punctuation">,</span><span class="token string">'Dog'</span><span class="token punctuation">,</span><span class="token string">'m'</span><span class="token punctuation">,</span><span class="token string">'2003'</span><span class="token punctuation">,</span><span class="token string">'2009'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=105></td><td><pre><span class="token punctuation">(</span><span class="token string">'Chirpy'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token string">'Bird'</span><span class="token punctuation">,</span><span class="token string">'f'</span><span class="token punctuation">,</span><span class="token string">'2008'</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=106></td><td><pre></pre></td></tr><tr><td data-num=107></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=108></td><td><pre><span class="token keyword">FROM</span> pet<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=109></td><td><pre><span class="token comment">/* 添加字段：主人的生日owner_birth DATE类型 */</span></pre></td></tr><tr><td data-num=110></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> pet</pre></td></tr><tr><td data-num=111></td><td><pre><span class="token keyword">ADD</span> owner_birth <span class="token keyword">DATE</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=112></td><td><pre></pre></td></tr><tr><td data-num=113></td><td><pre><span class="token comment">/* 将名称为Claws的猫的主人改为kevin */</span></pre></td></tr><tr><td data-num=114></td><td><pre><span class="token keyword">UPDATE</span> pet</pre></td></tr><tr><td data-num=115></td><td><pre><span class="token keyword">SET</span> OWNER <span class="token operator">=</span> <span class="token string">'kevin'</span></pre></td></tr><tr><td data-num=116></td><td><pre><span class="token keyword">WHERE</span> NAME <span class="token operator">=</span> <span class="token string">'Claws'</span> <span class="token operator">AND</span> species <span class="token operator">=</span> <span class="token string">'Cat'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=117></td><td><pre></pre></td></tr><tr><td data-num=118></td><td><pre><span class="token comment">/* 将没有死的狗的主人改为duck */</span></pre></td></tr><tr><td data-num=119></td><td><pre><span class="token keyword">UPDATE</span> pet</pre></td></tr><tr><td data-num=120></td><td><pre><span class="token keyword">SET</span> OWNER <span class="token operator">=</span> <span class="token string">'duck'</span></pre></td></tr><tr><td data-num=121></td><td><pre><span class="token keyword">WHERE</span> death <span class="token operator">IS</span> <span class="token boolean">NULL</span> <span class="token operator">AND</span> species <span class="token operator">=</span> <span class="token string">'Dog'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=122></td><td><pre></pre></td></tr><tr><td data-num=123></td><td><pre><span class="token comment">/* 查询没有主人的宠物的名字 */</span></pre></td></tr><tr><td data-num=124></td><td><pre><span class="token keyword">SELECT</span> NAME</pre></td></tr><tr><td data-num=125></td><td><pre><span class="token keyword">FROM</span> pet</pre></td></tr><tr><td data-num=126></td><td><pre><span class="token keyword">WHERE</span> OWNER <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=127></td><td><pre></pre></td></tr><tr><td data-num=128></td><td><pre><span class="token comment">/* 查询已经死了的cat的姓名，主人，以及去世时间 */</span></pre></td></tr><tr><td data-num=129></td><td><pre><span class="token keyword">SELECT</span> NAME<span class="token punctuation">,</span>OWNER<span class="token punctuation">,</span>death</pre></td></tr><tr><td data-num=130></td><td><pre><span class="token keyword">FROM</span> pet</pre></td></tr><tr><td data-num=131></td><td><pre><span class="token keyword">WHERE</span> death <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=132></td><td><pre></pre></td></tr><tr><td data-num=133></td><td><pre><span class="token comment">/* 删除已经死亡的狗 */</span></pre></td></tr><tr><td data-num=134></td><td><pre><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> pet</pre></td></tr><tr><td data-num=135></td><td><pre><span class="token keyword">WHERE</span> death <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span></pre></td></tr><tr><td data-num=136></td><td><pre><span class="token operator">AND</span> species <span class="token operator">=</span> <span class="token string">'Dog'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=137></td><td><pre></pre></td></tr><tr><td data-num=138></td><td><pre><span class="token comment">/* 查询所有宠物信息 */</span></pre></td></tr><tr><td data-num=139></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=140></td><td><pre><span class="token keyword">FROM</span> pet<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=141></td><td><pre></pre></td></tr><tr><td data-num=142></td><td><pre><span class="token comment">/* ............. */</span></pre></td></tr><tr><td data-num=143></td><td><pre><span class="token comment">/* 使用已有的数据库dbtest11 */</span></pre></td></tr><tr><td data-num=144></td><td><pre><span class="token keyword">USE</span> dbtest11<span class="token punctuation">;</span></pre></td></tr><tr><td data-num=145></td><td><pre></pre></td></tr><tr><td data-num=146></td><td><pre><span class="token comment">/* 创建表employee,并添加记录 */</span></pre></td></tr><tr><td data-num=147></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> employee<span class="token punctuation">(</span></pre></td></tr><tr><td data-num=148></td><td><pre>    id	<span class="token keyword">INT</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=149></td><td><pre>    NAME	<span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=150></td><td><pre>    sex	<span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=151></td><td><pre>    tel	<span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=152></td><td><pre>    addr	<span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=153></td><td><pre>    salary	<span class="token keyword">DOUBLE</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num=154></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=155></td><td><pre></pre></td></tr><tr><td data-num=156></td><td><pre><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> employee <span class="token keyword">VALUES</span></pre></td></tr><tr><td data-num=157></td><td><pre><span class="token punctuation">(</span><span class="token number">10001</span><span class="token punctuation">,</span><span class="token string">'张一'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token string">'1345679900'</span><span class="token punctuation">,</span><span class="token string">'山东青岛'</span><span class="token punctuation">,</span><span class="token number">1001.58</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=158></td><td><pre><span class="token punctuation">(</span><span class="token number">10002</span><span class="token punctuation">,</span><span class="token string">'刘小'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token string">'1345431900'</span><span class="token punctuation">,</span><span class="token string">'河北保定'</span><span class="token punctuation">,</span><span class="token number">1201.21</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=159></td><td><pre><span class="token punctuation">(</span><span class="token number">10003</span><span class="token punctuation">,</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token string">'1345431901'</span><span class="token punctuation">,</span><span class="token string">'广东佛山'</span><span class="token punctuation">,</span><span class="token number">1004.11</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num=160></td><td><pre><span class="token punctuation">(</span><span class="token number">10004</span><span class="token punctuation">,</span><span class="token string">'王五'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token string">'1345431902'</span><span class="token punctuation">,</span><span class="token string">'广东广州'</span><span class="token punctuation">,</span><span class="token number">1405.16</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=161></td><td><pre></pre></td></tr><tr><td data-num=162></td><td><pre><span class="token comment">/* 查询出薪资在1200~1300之间的员工信息 */</span></pre></td></tr><tr><td data-num=163></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=164></td><td><pre><span class="token keyword">FROM</span> employee</pre></td></tr><tr><td data-num=165></td><td><pre><span class="token keyword">WHERE</span> salary <span class="token operator">BETWEEN</span> <span class="token number">1200</span> <span class="token operator">AND</span> <span class="token number">1300</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=166></td><td><pre></pre></td></tr><tr><td data-num=167></td><td><pre><span class="token comment">/* 查询出姓刘的员工的工号，姓名，家庭住址 */</span></pre></td></tr><tr><td data-num=168></td><td><pre><span class="token keyword">SELECT</span> id<span class="token punctuation">,</span>NAME<span class="token punctuation">,</span>addr</pre></td></tr><tr><td data-num=169></td><td><pre><span class="token keyword">FROM</span> employee</pre></td></tr><tr><td data-num=170></td><td><pre><span class="token keyword">WHERE</span> NAME <span class="token operator">LIKE</span> <span class="token string">'刘%'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=171></td><td><pre></pre></td></tr><tr><td data-num=172></td><td><pre><span class="token comment">/* 将李四的家庭住址改为广东韶关 */</span></pre></td></tr><tr><td data-num=173></td><td><pre><span class="token keyword">UPDATE</span> employee</pre></td></tr><tr><td data-num=174></td><td><pre><span class="token keyword">SET</span> addr <span class="token operator">=</span> <span class="token string">'广东佛山'</span></pre></td></tr><tr><td data-num=175></td><td><pre><span class="token keyword">WHERE</span> NAME <span class="token operator">=</span> <span class="token string">'李四'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num=176></td><td><pre></pre></td></tr><tr><td data-num=177></td><td><pre><span class="token comment">/* 查询出姓名中带小的员工 */</span></pre></td></tr><tr><td data-num=178></td><td><pre><span class="token keyword">SELECT</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num=179></td><td><pre><span class="token keyword">FROM</span> employee</pre></td></tr><tr><td data-num=180></td><td><pre><span class="token keyword">WHERE</span> NAME <span class="token operator">LIKE</span> <span class="token string">'%小%'</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h2 id=数据类型详解><a class=anchor href=#数据类型详解>#</a> 数据类型详解</h2><h3 id=整数类型><a class=anchor href=#整数类型>#</a> !整数类型</h3><table><thead><tr><th>整数类型</th><th>字节</th><th>有符号数取值范围</th><th>无符号数取值范围</th></tr></thead><tbody><tr><td>TINYINT</td><td>1</td><td>-127~127</td><td>0~255</td></tr><tr><td>SMALLINT</td><td>2</td><td>-32768~32767</td><td>0~65535</td></tr><tr><td>MEDIUMINT</td><td>3</td><td>-8388608~8388607</td><td>0~16777215</td></tr><tr><td>INT, INTEGER</td><td>4</td><td>-2147483648~2147483647</td><td>0~4294967295</td></tr><tr><td>BIGINT</td><td>8</td><td>-9223372036854775808~9223372036854775807</td><td>0~18446744073709551615</td></tr></tbody></table><p><strong>可选属性</strong></p><p><strong>M</strong></p><p>表示显示宽度，求值范围是(0,255)。例如int(5)，当数据宽度小于5位的时候在数字前面需要用字符填满宽度。该项功能需要配合&quot;ZEROFILL&quot;使用，表示用“0”填满宽度，否则指定显示宽度无效。</p><p>如果设置了显示宽度，那么插入的数据宽度超过显示宽度限制，会不会截断或插入失败？</p><p>不会对插入的数据有任何影响，还是按照类型的实际宽度进行保存，即显示宽度与类型可以存储的值范围无关。从MySQL8.0.17开始，整数数据类型不推荐使用显示宽度属性。</p><p>整型数据类型可以在定义表结构时指定所需要的显示宽度，如果不指定，则系统为每一种类型指定默认的宽度值。</p><p><code>CREATE TABLE test_int1(x TINYINT,y SMALLINT, z MEDIUMINT,m INT, n BIGINT);</code></p><p><strong>UNSIGNED</strong></p><p>无符号类型(非负)，所有的整数类型都有一个可选的属性UNSIGNED(无符号属性)，无符号整数类型的最小取值为0。所以，如果需要在MySQL数据库中保存非负整数值时，可以将整数类型设置为无符号类型。</p><p>int类型默认显示宽度为int(11)，无符号int类型默认显示宽度为int(10)。</p><p><strong>ZEROFILL</strong></p><p>0填充，(如果莫列是ZEROFILL，那么MySQL会自动为当前列添加UNSIGNED属性)，如果指定了ZEROFILL只是表示不够M位时，用0在左边填充，如果超过M位，只要不超过数据存储范围即可。</p><p>原来，在int(M)中，M的值跟int(M)所占多少存储空间并无任何关系。int(3), int(4), int(8)在磁盘上都是占用4bytes的存储空间。也就是说，int(M)，必须和UNSIGNED ZEROFILL一起使用才有意义。如果整数值超过M位，就按照实际位数存储。只是无须再用字符0进行填充。</p><p><strong>适用场景</strong></p><p><code>TINYINT</code>：一般用于枚举数据，比如系统设定取值范围很小且固定的场景</p><p><code>SMALLINT</code>：可以用于较小范围的统计数据，比如统计工厂的固定资产库存数量等</p><p><code>MEDIUMINT</code>：用于较大整数的计算，比如车站每日的客流量</p><p><code>INT,INTEGER</code>：取值范围足够大，一般情况下不用考虑超限问题，用得最多，比如商品编号</p><p><code>BIGINT</code>：只有当处理特别巨大的整数时才会用到。比如双十一的交易量，大型门户网站点击量</p><p><strong>如何选择？</strong></p><p>在评估用哪种整数类型的时候，需要考虑存储空间和可靠性的平衡问题：一方面，用占用字节数少的整数类型可以节省存储空间；另一方面，要是为节省存储空间，适用的整数类型取值范围太小，一旦遇到超出取值范围的情况，就可能引起系统错误，影响可靠性。</p><p>如果使用SMALLINT类型，虽然占用字节数比INT类型的整数少，但是却不能保证数据不会超出范围65535。相反，使用INT，就能确保有足够大的取值范围，不用担心数据超出范围影响可靠性的问题。</p><p>实际工作中，系统故障产生的成本远远超过增加几个字段存储空间所产生的成本。因此，建议先确保数据不会超过取值范围，在这个前提之下，再去考虑如何节省存储空间。</p><p><strong>整数类型的UNSIGNED属性有什么用？</strong></p><p>MySQL中的整数类型可以使用可选的UNSIGNED属性来表示不允许负值的无符号整数。使用UNSIGNED属性可以将正整数的上限提高一倍，因为它不需要存储负数值。</p><p>例如， <code>TINYINT UNSIGNED</code>类型的取值范围是0 ~ 255，而普通的TINYINT类型的值范围是 -128 ~ 127。<code>INT UNSIGNED</code>类型的取值范围是 0 ~ 4,294,967,295，而普通的INT类型的值范围是-2,147,483,648 ~ 2,147,483,647。</p><p>对于从0开始递增的ID列，使用UNSIGNED属性非常适合，因为不允许负值并且可以拥有更大的上限范围，提供了更多的ID值可用。</p><p><strong>Boolean类型如何表示？</strong></p><p>MySQL中没有专门的布尔类型，而是用TINYINT(1)类型来表示布尔值。TINYINT(1)类型可以存储0或1，分别对应false或true。</p><h3 id=浮点类型><a class=anchor href=#浮点类型>#</a> !浮点类型</h3><p>浮点数和定点数类型的特点是可以处理小数，可以把整数看成小数的一个特例。因此，浮点数和定点数的使用场景，比整数大多了。MySQL支持的浮点数，分别是FLOAT, DOUBLE, REAL。</p><p>FLOAT表示单精度浮点数。</p><p>DOUBLE表示双精度浮点数。</p><p>REAL默认就是DOUBLE。如果把SQL模式设定为启用“REAL_AS_FLOAT”，那么，MySQL就认为REAL是FLOAT。如果要启用“REAL_AS_FLOAT”，可以通过以下SQL语句实现</p><p><code>SET sql_mode = &quot;REAL_AS_FLOAT&quot;</code></p><p><strong>FLOAT和DOUBLE这两种数据类型的区别是什么？</strong></p><p>FLOAT占用字节数少，取值范围小；DOUBLE占用字节数多，取值范围也大。</p><p><strong>为什么浮点数类型的无符号数取值范围，只相当于有符号数取值范围的一半，也就是只相当于有符号数取值范围大于等于零的部分？</strong></p><p>MySQL存储浮点数的格式为：符号(S), 尾数(M)和阶码(E)。因此，无论有没有符号，MySQL的浮点数都会存储表示符号的部分。因此，所谓的无符号数取值范围，其实就是有符号数取值范围大于等于零的部分。</p><p><strong>数据精度说明</strong></p><p>对于浮点类型，在MySQL中单精度值使用4个字节，双精度值使用8个字节。</p><p>MySQL允许使用非标准语法(其他数据库未必支持，因此如果涉及到数据迁移，则最好不要这么用)：FLOAT(M,D)或DOUBLE(M,D)。这里，M称为精度，D称为标度。(M,D)中 M=整数位+小数位，D=小数位。(D&lt;=M&lt;=255,0&lt;=D&lt;=30)。例如，定义为FLOAT(5,2)的一个列可以显示为-999.99-999.99。如果超过这个范围会报错。</p><p>FLOAT和DOUBLE类型在不指定(M,D)时，默认会按照实际的精度(由实际的硬件和操作系统决定)来显示。</p><p>说明：浮点类型，也可以加UNSIGNED，但是不会改变数据范围，例如：FLOAT(3,2) UNSIGNED仍然只能表示0-9.99的范围。</p><p>不管是否显示设置了精度(M,D)，这里MySQL的处理方案如下</p><ul><li>如果存储时，整数部分超出了范围，MySQL就会报错，不允许存在这样的值</li><li>如果存储时，小数点部分若超出范围，就分以下情况<ul><li>若四舍五入，整数部分没有超出范围，则只警告，但能成功操作并四舍五入删除多余的小数位后保存。例如在FLOAT(5,2)列内插入999.009，近似结果是999.01</li><li>若四舍五入后，整数部分超出范围，则MySQL报错，并拒绝处理。如FLOAT(5,2)列内插入999.995和-999.995都会报错</li></ul></li><li>从MySQL8.0.17开始，FLOAT(M,D)和DOUBLE(M,D)用法在官方文档中已经明确不推荐使用，将来可能被移除。另外，关于浮点型FLOAT和DOUBLE的UNSINGNED也不推荐使用了</li></ul><p>MySQL用4个字节存储FLOAT类型数据，用8个字节来存储DOUBLE类型数据。无论用哪个，都是采用二进制的方式来进行存储的。比如9.625，用二进制来表达，就是1001.101，或者表达成1.001101x<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mn>2</mn><mn>3</mn></msup></mrow><annotation encoding=application/x-tex>2^3</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8141079999999999em;vertical-align:0></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span>。如果尾数不是0或5，就无法用一个二进制数来精确表达。进而，就只好在取值允许的范围内进行四舍五入。</p><p>在编程中，如果用到浮点数，要特别注意误差问题，因为浮点数是不准确的，所以要避免使用等号来判断两个数是否相等。同时，在一些对精度要求较高的项目中，不要使用浮点数，其会导致结果错误。MySQL数据类型中的精准的数据类型就是定点数类型：DECIMAL。</p><h3 id=定点数类型><a class=anchor href=#定点数类型>#</a> !定点数类型</h3><table><thead><tr><th>数据类型</th><th>字节数</th><th>含义</th></tr></thead><tbody><tr><td>DECIMAL(M,D), DEC, NUMERIC</td><td>M + 2字节</td><td>有效范围由M和D决定</td></tr></tbody></table><p>使用DECIMAL(M,D)的方式表示高精度小数。其中，M被称为精度，D被称为标度。0&lt;=M&lt;=65, 0&lt;=D&lt;=30, D&lt;M。例如，定义DECIMAL(5,2)的类型，表示该列取值范围是-999.99~999.99。</p><p>DECIMAL(M,D)的最大取值范围与DOUBLE类型一样，但是有效的数据范围是由M和D决定的。DECIMAL的存储空间并不是固定的，由精度值M决定，总共占用的存储空间为M+2个字节。也就是说，在一些对精度要求不高的场景下，比起占用同样字节长度的定点数，浮点数表达的数值范围可以更大一些。</p><p>定点数在MySQL内部是以字符串的形式进行存储，这就决定了它一定是精准的。</p><p>当DECIMAL类型不指定精度和标度时，其默认为DECIMAL(10,0)。当数据的精度超出了定点数类型的精度范围时，则MySQL同样会进行四舍五入处理。</p><p><strong>浮点数与定点数</strong></p><ul><li>浮点数相对于定点数的优点是在长度一定的情况下，浮点类型取值范围大，但是不精准，适用于需要取值范围大，又可以容忍微小误差的科学计算场景(比如计算化学，分子建模等)</li><li>定点数类型取值范围相对小，但是精准，没有误差，适合于对精度要求极高的场景(比如涉及金额计算的场景)</li></ul><p>由于DECIMAL数据类型的精准性，在项目中，除了极少数(比如商品编号)用到整数类型外，其他的数值都用的是DECIMAL，原因就是某项目所处的零售行业，要求精准，一分钱也不能差。</p><p><strong>DECIMAL和FLOAT/DOUBLE的区别是什么？</strong></p><p>DECIMAL 和 FLOAT 的区别是：<strong>DECIMAL 是定点数，FLOAT/DOUBLE 是浮点数。DECIMAL 可以存储精确的小数值，FLOAT/DOUBLE 只能存储近似的小数值。</strong></p><p>DECIMAL 用于存储具有精度要求的小数，例如与货币相关的数据，可以避免浮点数带来的精度损失。</p><p>在Java中，MySQL 的 DECIMAL 类型对应的是 Java 类 <code>java.math.BigDecimal</code>。</p><h3 id=位类型><a class=anchor href=#位类型>#</a> 位类型</h3><table><thead><tr><th>二进制字符串类型</th><th>长度</th><th>长度范围</th><th>占用空间</th></tr></thead><tbody><tr><td>BITM(M)</td><td>M</td><td>1&lt;=M&lt;=64</td><td>约为(M + 7) / 8个字节</td></tr></tbody></table><p>BIT类型，如果没有指定(M)，默认是1位。这个1位，表示只能存1位的二进制值。这里(M)是表示二进制的位数，位数最小值为1，最大值为64。</p><p>在向BIT类型的字段中插入数据时，一定要确保插入的数据在BIT类型支持的范围内。</p><p>使用SELECT命令查询位字段时，可以用BIN()或HEX()函数进行读取。</p><h3 id=日期与时间类型><a class=anchor href=#日期与时间类型>#</a> !日期与时间类型</h3><p>日期与时间是重要的信息，在我们的系统中，几乎所有的数据表都用得到。原因是客户需要知道数据的时间标签，从而进行数据查询，统计和处理。</p><p>MySQL有多种表示日期和时间的数据类型，不同的版本可能有所差异，MySQL8.0版本支持的日期和时间类型主要有</p><ul><li>YEAR - 通常用来表示年</li><li>DATE - 通常用来表示年，月，日</li><li>TIME - 通常用来表示时，分，秒</li><li>DATETIME - 通常用来表示年，月，日，时，分，秒</li><li>TIMESTAMP - 通常用来表示带时区的年，月，日，时，分，秒</li></ul><table><thead><tr><th>类型</th><th>名称</th><th>字节</th><th>日期格式</th><th>最小值</th><th>最大值</th></tr></thead><tbody><tr><td>YEAR</td><td>年</td><td>1</td><td>YYYY或YY</td><td>1901</td><td>2155</td></tr><tr><td>TIME</td><td>时间</td><td>3</td><td>HH::MM::SS</td><td>-030:59:59</td><td>838:59:59</td></tr><tr><td>DATE</td><td>日期</td><td>3</td><td>YYYY-MM-DD</td><td>1000-01-01</td><td>9999-12-03</td></tr><tr><td>DATETIME</td><td>日期时间</td><td>6</td><td>YYYY-MM-DD HH:MM:SS</td><td>1000-01-01 00:00:00</td><td>9999-12-31 23:59:59</td></tr><tr><td>TIMESTAMP</td><td>日期时间</td><td>4</td><td>YYYY-MM-DD HH:MM:SS</td><td>1970-01-01 00:00:00 UTC</td><td>2038-01-19 03:14:07 UTC</td></tr></tbody></table><p><strong>YEAR类型</strong></p><p>YEAR类型用来表示年份，在所有的日期时间类型中所占用的存储空间最小，只需1个字节的存储空间。</p><p>在MySQL中，YEAR有以下几种存储格式</p><ul><li>以4位字符串或数字格式表示YEAR类型，其格式为YYYY,最小值为1901，最大值2155</li><li>以2位字符串格式表示YEAR类型，最小值为00，最大值为99<ul><li>当取值为01到69时，表示2001到2069</li><li>当取值为70到99时，表示1970到1999</li><li>当取值整数的0或00添加时，那么指0000年</li><li>当取值是日期/字符串0添加的话，是2000年</li></ul></li></ul><p>从MySQL5.5.27开始，2位格式的YEAR已经不推荐使用。YEAR默认格式就是“YYYY”，没必要写成YEAR(4)，从MySQL8.0.19开始，不推荐使用指定显示宽度的YEAR(4)数据类型。</p><p><strong>DATE类型</strong></p><p>DATE类型表示日期，没有时间部分，格式为<code>YYYY-MM-DD</code>，其中，YYYY表年份，MM表示月份，DD表示日期。</p><p>需要3个字节的存储空间。在向DATE类型的字段插入数据时，同样需要满足一定的格式条件。</p><ul><li>以<code>YYYY-MM-DD</code>格式或者<code>YYYYMMDD</code>格式表示的字符串日期，其最小取值为1000-01-01，最大取值为999-12-03。YYYYMMDD格式会被转化为YYYY-MM-DD格式</li><li>以<code>YY-MM-DD</code>格式或者<code>YYMMDD</code>格式表示的字符串日期，此格式中，年份为两位数值或字符串满足YEAR类型的格式条件为，当年份取值为00到69时，会被转化为2000到2069；当年份取值为70到99时，会被转化为1970到1999</li><li>使用CURRENT_DATE()或者NOW()函数，会插入当前系统的日期</li></ul><p><strong>TIME类型</strong></p><p>TIME类型用来表示时间，不包含日期部分。在MySQL中，需要3个字节的存储空间来存储TIME类型的数据，可以使用“HH:MM:SS”格式来表示TIME类型，其中，HH表示小时，MM表示分钟，SS表示秒。</p><p>在MySQL中，向TIME类型的字段插入数据时，也可以使用几种不同的格式</p><ul><li>可以使用带有冒号的字符串，比如'D HH:MM:SS', 'HH:MM:SS', 'HH:MM', 'D HH:MM', 'D HH'或’SS‘格式，都能被正确地插入TIME类型的字段中。其中D表示天，其最小值为0，最大值为34。如果使用带有D格式的字符串插入TIME类型的字段时，D会被转化为小时，计算格式为D*24+HH。当使用带有冒号并且不带D的字符串表示时间时，表示当天的时间，比如12:10表示12:10:00，而不是00:12:10。</li><li>可以使用不带有冒号的字符串或数字，格式为'HHMMSS'或者'HHMMSS'。如果插入一个不合法的字符串或者数字，MySQL在存储数据时，会将其自动转化为00:00:00进行存储，比如1210，MySQL会将最右边的两位解析成秒，表示00:12:10，而不是12:10:00</li><li>使用CURRENT_TIME()或者NOW()，会插入当前系统的时间</li></ul><p><strong>DATETIME类型</strong></p><p>DATETIME类型在所有的日期时间类型中占用的存储空间最大，总共需要8个字节的存储空间。在格式上为DATE类型和TIME类型的组合，可以表示为<code>YYYY-MM-DD HH:MM:SS</code>，其中YYYY表示年份，MM表示月份，DD表示日期，HH表示小时，MM表示分钟，SS表示秒。</p><p>在向DATETIME类型的字段插入数据时，同样需要满足一定的格式条件</p><ul><li>以<code>YYYY-MM-DD HH:MM:SS</code>格式或者<code>YYYYMMDDHHMMSS</code>格式的字符串插入DATETIME类型的字段时，最小值为1000-01-01 00:00:00，最大值为9999-12-03 23:59:59</li><li>以YYYYMMDDHHMMSS格式的数字插入DATETIME类型的字段时，会被转化为YYY-MM-DD HH:MM:SS格式</li><li>以<code>YY-MM-DD HH:MM:SS</code>格式或者<code>YYMMDDHHMMSS</code>格式的字符串插入DATETIME类型的字段时，两位数的年份规则符合YEAR类型的规则，00到69表示2000到2069；70到99表示1970到1999</li><li>使用函数CURRENT_TIMESTAMP()和NOW()，可以向DATETIME类型的字段插入系统的当期日期和时间</li></ul><p><strong>TIMESTAMP类型</strong></p><p>TIMESTAMP类型也可以表示日期时间，其显示格式与DATETIME类型相同，都是<code>YYYY-MM-DD HH:MM:SS</code>，需要4个字节存储空间。但是TIMESTAMP存储的时间范围比DATETIME要小很多，只能存储&quot;1970-01-01 00:00:01 UTC&quot;到“2038-01-19 03：14：07 UTC”之间的时间。其中，UTC表示世界统一时间，也叫做世界标准时间。</p><p>存储数据的时候需要对当前时间所在的时区进行转换，查询数据的时候再将时间转换回当前的时区。因此，使用TIMESTAMP存储的同一个时间值，在不同的时区查询时会显示不同的时间。</p><p>向TIMESTAMP类型的字段插入数据时，当插入的数据格式满足YY-MM-DD HH:MM:SS和YYMMDDHHMMSS时，两位数值的年份同样符合YEAR类型的规则条件，只不过表示的时间范围要小很多。</p><p>如果向TIMESTAMP类型的字段插入的时间超出了TIMESTAMP类型的范围，则MySQL会抛出错误信息。</p><p><strong>TIMESTAMP和DATETIME的区别是什么？</strong></p><p>TIMESTAMP存储空间比较小，表示的日期时间范围也比较小。</p><p>底层存储方式不同，TIMESTAMP底层存储的是毫秒值，距离1970-1-1 0:0:0 0毫秒的毫秒值。</p><p>两个日期比较大小或日期计算时，TIMESTAMP更方便，更快。</p><p>TIMESTAMP和时区有关。TIMESTAMP会根据用户的时区不同，显示不同的结果。而DATETIME则只能反映出插入时当地的时区，其他时区的人查看数据必然会有误差的。</p><p>开发中，用得最多的日期时间类型，就是DATETIME。虽然MySQL也支持YEAR(年), TIME(时间), DATE(日期), 以及TIMESTAMP类型，但在实际项目中，尽量用DATETIME类型。因为这个数据类型包括了完整的日期和时间信息，取值范围也最大，使用起来比较方便。毕竟，如果日期时间信息分散在好几个字段，很不容易记，而且查询的时候，SQL语句也会更加复杂。</p><p>此外，一般存储注册时间，商品发布时间等，不建议使用DATETIME存储，而是使用时间戳，因为DATETIME虽然直观，但不便于计算。</p><h3 id=文本字符串类型><a class=anchor href=#文本字符串类型>#</a> !文本字符串类型</h3><table><thead><tr><th>文本字符串类型</th><th>值的长度</th><th>长度范围</th><th>占用的存储空间</th></tr></thead><tbody><tr><td>CHAR(M)</td><td>M</td><td>0&lt;=M&lt;=255</td><td>M个字节</td></tr><tr><td>VARCHAR(M)</td><td>M</td><td>0&lt;=M&lt;=65535</td><td>M+1个字节</td></tr><tr><td>TINYTEXT</td><td>L</td><td>0&lt;=L&lt;=255</td><td>L+2个字节</td></tr><tr><td>TEXT</td><td>L</td><td>0&lt;=L&lt;=65535</td><td>L+2个字节</td></tr><tr><td>MEDIUMTEXT</td><td>L</td><td>0&lt;=L&lt;=16777215</td><td>L+3个字节</td></tr><tr><td>LONGTEXT</td><td>L</td><td>0&lt;=L&lt;=4294967295</td><td>L+4个字节</td></tr><tr><td>ENUM</td><td>L</td><td>0&lt;=L&lt;=65535</td><td>1或2个字节</td></tr><tr><td>SET</td><td>L</td><td>0&lt;=L&lt;=64</td><td>1,2,3,4或8个字节</td></tr></tbody></table><p><strong>CHAR与VARCHAR类型</strong></p><p>用于存储比较短的字符串。</p><table><thead><tr><th>字符串(文本)类型</th><th>特点</th><th>长度</th><th>长度范围</th><th>占用的存储空间</th></tr></thead><tbody><tr><td>CHAR(M)</td><td>固定长度</td><td>M</td><td>0&lt;=M&lt;=255</td><td>M个字节</td></tr><tr><td>VARCHAR(M)</td><td>可变长度</td><td>M</td><td>0&lt;=M&lt;=65535</td><td>(实际长度 + 1)个字节</td></tr></tbody></table><p><strong>CHAR类型</strong></p><ul><li>CHAR(M)类型一般需要预先定义字符串长度。如果不指定(M)，则表示长度默认是1个字符</li><li>如果保存时，数据的实际长度比CHAR类型声明的长度小，则会在右侧填充空格以达到指定的长度。当MySQL检索CHAR类型的数据时，CHAR类型的字段会去除尾部的空格</li><li>定义CHAR类型字段时，声明的字段长度即为CHAR类型字段所占的存储空间的字节数</li></ul><p><strong>哪些情况使用CHAR或VARCHAR更好</strong></p><table><thead><tr><th>类型</th><th>特点</th><th>空间上</th><th>时间上</th><th>适用场景</th></tr></thead><tbody><tr><td>CHAR(M)</td><td>固定长度</td><td>浪费存储空间</td><td>效率高</td><td>存储不大，速度要求高</td></tr><tr><td>VARCHAR(M)</td><td>可变长度</td><td>节省存储空间</td><td>效率低</td><td>非CHAR的情况</td></tr></tbody></table><p>情况1：存储很短的信息，比如门牌号之类的很短的信息应该用CHAR，而VARCHAR还要占一个字节用于存储信息长度，比较浪费。</p><p>情况2：固定长度的。比如适用uuid作为主键，那用CHAR更合适。</p><p>情况3：十分频繁改变的column。因为VARCHAR每次存储都要有额外的计算来获取长度。</p><p>情况4：具体存储引擎中的情况</p><ul><li><code>MyISAM</code>数据存储引擎和数据列：MyISAM数据表，最好使用固定长度(CHAR)的数据列代替可变长度(VARCHAR)的数据列。这样使得整个表静态化，从而使数据检索更快，用空间换取时间</li><li><code>MEMORY</code>存储引擎和数据列：MEMORY数据表目前都使用固定长度得数据行存储，因此无论使用CHAR或VARCHAR列都没有问题，两者都作为CHAR类型处理</li><li><code>InnoDB</code>存储引擎，建议使用VARCHAR类型。因为对于InnoDB数据表，内部的行存储格式并没有区分固定长度和可变长度列(所有数据行都使用指向数据列值的头指针)，而且主要影响性能的因素是数据行使用的存储总量，由于CHAR平均占用的空间多于VARCHAR，所以除了简短并且固定长度的，其他考虑VARCHAR.这样节省空间，对磁盘I/O和数据存储总量比较好</li></ul><p><strong>TEXT类型</strong></p><p>在MySQL中，TEXT用来保存文本类型的字符串。在向TEXT类型的字段保存和查询数据时，系统自动按照实际长度存储，不需要预先定义长度。</p><table><thead><tr><th>文本字符类型</th><th>特点</th><th>长度</th><th>长度范围</th><th>占用的存储空间</th></tr></thead><tbody><tr><td>TINYTEXT</td><td>小文本，可变长度</td><td>L</td><td>0&lt;=L&lt;=255</td><td>L+2个字节</td></tr><tr><td>TEXT</td><td>文本，可变长度</td><td>L</td><td>0&lt;=L&lt;=65535</td><td>L+2个字节</td></tr><tr><td>MEDIUMTEXT</td><td>中等文本，可变长度</td><td>L</td><td>0&lt;=L&lt;=16777215</td><td>L+3个字节</td></tr><tr><td>LONGTEXT</td><td>大文本，可变长度</td><td>L</td><td>0&lt;=L&lt;=4294967295(相当于4GB)</td><td>L+4个字节</td></tr></tbody></table><p>由于实际存储的长度不确定，MySQL不允许TEXT类型的字段做主键。遇到这种情况，只能采用CHAR(M)，或者VARCHAR(M)。</p><p>在保存和查询数据时，并没有删除TEXT类型的数据尾部的空格。</p><p>TEXT文本类型，可以存储比较大的文本段，搜索速度稍慢，因此如果不是特别大的内容，建议使用CHAR，VARCHAR来代替。还有TEXT类型不用加默认值，加了也没用。而且TEXT和BLOB类型的数据删除后容易导致空洞，使得文件碎片比较多，所以频繁使用的表不建议包含TEXT类型字段，建议单独分出去，单独使用一个表。</p><p><strong>CHAR和VARCHAR的区别是什么？</strong></p><p>CHAR 和 VARCHAR 是最常用到的字符串类型，两者的主要区别在于：<strong>CHAR 是定长字符串，VARCHAR 是变长字符串。</strong></p><p>CHAR 在存储时会在右边填充空格以达到指定的长度，检索时会去掉空格；VARCHAR 在存储时需要使用 1 或 2 个额外字节记录字符串的长度，检索时不需要处理。</p><p>CHAR 更适合存储长度较短或者长度都差不多的字符串，例如 Bcrypt 算法、MD5 算法加密后的密码、身份证号码。VARCHAR 类型适合存储长度不确定或者差异较大的字符串，例如用户昵称、文章标题等。</p><p>CHAR(M) 和 VARCHAR(M) 的 M 都代表能够保存的字符数的最大值，无论是字母、数字还是中文，每个都只占用一个字符。</p><p><strong>VARCHAR(100)和VARCHAR(10)的区别是什么？</strong></p><p>VARCHAR(100)和 VARCHAR(10)都是变长类型，表示能存储最多 100 个字符和 10 个字符。因此，VARCHAR (100) 可以满足更大范围的字符存储需求，有更好的业务拓展性。而 VARCHAR(10)存储超过 10 个字符时，就需要修改表结构才可以。</p><p>虽说 VARCHAR(100)和 VARCHAR(10)能存储的字符范围不同，但二者存储相同的字符串，所占用磁盘的存储空间其实是一样的，这也是很多人容易误解的一点。</p><p>不过，VARCHAR(100) 会消耗更多的内存。这是因为 VARCHAR 类型在内存中操作时，通常会分配固定大小的内存块来保存值，即使用字符类型中定义的长度。例如在进行排序的时候，VARCHAR(100)是按照 100 这个长度来进行的，也就会消耗更多内存。</p><p><strong>NULL和<code>''</code>的区别是什么？</strong></p><p>关联问题 - <strong>为什么MySQL不建议使用<code>NULL</code>作为列默认值？</strong></p><p><code>NULL</code> 跟 <code>''</code>(空字符串)是两个完全不一样的值，区别如下</p><ul><li><code>NULL</code> 代表一个不确定的值,就算是两个 <code>NULL</code>,它俩也不一定相等。例如，<code>SELECT NULL=NULL</code>的结果为 false，但是在我们使用<code>DISTINCT</code>,<code>GROUP BY</code>,<code>ORDER BY</code>时,<code>NULL</code>又被认为是相等的</li><li><code>''</code>的长度是 0，是不占用空间的，而<code>NULL</code> 是需要占用空间的</li><li><code>NULL</code> 会影响聚合函数的结果。例如，<code>SUM</code>、<code>AVG</code>、<code>MIN</code>、<code>MAX</code> 等聚合函数会忽略 <code>NULL</code> 值。 <code>COUNT</code> 的处理方式取决于参数的类型。如果参数是<code>*</code>(<code>COUNT(*)</code>)，则会统计所有的记录数，包括 <code>NULL</code> 值；如果参数是某个字段名(<code>COUNT(列名)</code>)，则会忽略 <code>NULL</code> 值，只统计非空值的个数</li><li>查询 <code>NULL</code> 值时，必须使用 <code>IS NULL</code> 或 <code>IS NOT NULLl</code> 来判断，而不能使用 =、!=、 &lt;、&gt; 之类的比较运算符。而<code>''</code>是可以使用这些比较运算符的</li></ul><h3 id=enum类型><a class=anchor href=#enum类型>#</a> ENUM类型</h3><p>ENUM类型也叫作枚举类型，ENUM类型的取值范围需要在定义字段时进行指定。设置字段值时，ENUM类型只允许从成员中选取单个值，不能一次选取多个值。</p><p>其所需的存储空间由定义ENUM类型时指定的成员个数决定。</p><table><thead><tr><th>文本字符串类型</th><th>长度</th><th>长度范围</th><th>占用的存储空间</th></tr></thead><tbody><tr><td>ENUM</td><td>L</td><td>1&lt;=L&lt;=65535</td><td>1或2个字节</td></tr></tbody></table><h3 id=set类型><a class=anchor href=#set类型>#</a> SET类型</h3><p>SET表示一个字符串对象，可以包含0个或多个成员，但成员个数的上限为64。设置字段值时，可以取取值范围内的0个或多个值。</p><p>当SET类型包含的成员个数不同时，其所占用的存储空间也是不同的。</p><table><thead><tr><th>成员个数范围(L表示实际成员个数)</th><th>占用的存储空间</th></tr></thead><tbody><tr><td>1&lt;=L&lt;=8</td><td>1个字节</td></tr><tr><td>9&lt;=L&lt;=16</td><td>2个字节</td></tr><tr><td>17&lt;=L&lt;=24</td><td>3个字节</td></tr><tr><td>25&lt;=L&lt;=32</td><td>4个字节</td></tr><tr><td>33&lt;=L&lt;=64</td><td>8个字节</td></tr></tbody></table><p>SET类型在存储数据时成员个数越多，其占用的存储空间越大。SET类型在选取成员时，可以一次选择多个成员，这一点与ENUM类型不同。</p><h3 id=二进制字符串类型><a class=anchor href=#二进制字符串类型>#</a> !二进制字符串类型</h3><p>MySQL中的二进制字符串类型主要存储一些二进制数据，比如可以存储图片，音频和视频等二进制数据。</p><p>MySQL中支持的二进制字符串类型主要包括BINARY, VARBINARY, TINYBLOB, BLOB, MEDIUMBLOB和LONGBLOB类型。</p><p><strong>BINARY与VARBINARY类型</strong></p><p>BINARY和VARBINARY类似于CHAR和VARCHAR,，只是它们存储的是二进制字符串。</p><p>BINARY(M)为固定长度的二进制字符串，M表示最多能存储的字符数，取值范围是0~255个字符。如果未指定(M)，表示只能存储1个字节。例如BINARY(8)，表示最多能存储8个字节，如果字段值不足(M)个字节，将在右边填充<code>\0</code>以补齐指定长度。</p><p>VARBINARY(M)为可变长度的二进制字符串，M表示最多能存储的字节数，总字节数不能超过行的字节长度限制65535，另外还要考虑外字节开销，VARBINARY类型的数据除了存储数据本身外，还需要1或2个字节来存储数据的字节数。VARBINARY类型必须指定(M)，否则报错。</p><table><thead><tr><th>二进制字符串类型</th><th>特点</th><th>值的长度</th><th>占用空间</th></tr></thead><tbody><tr><td>BINARY(M)</td><td>固定长度</td><td>M(0&lt;=M&lt;255)</td><td>M个字节</td></tr><tr><td>VARBINARY(M)</td><td>可变长度</td><td>M(0&lt;=M&lt;=65535)</td><td>M+1个字节</td></tr></tbody></table><p><strong>BLOB类型</strong></p><p>BLOB是一个二进制大对象，可以容纳可变数量的数据。</p><p>MySQL中的BLOB类型包括TINYBLOB, BLOB, MEDIUMBLOB和LONGBLOB 4种类型。它们可容纳值得最大长度不同。可以存储一个二进制得大对象，比如图片，音频和视频等。</p><p>需要注意得是，在实际工作中，往往不会在MySQL数据库中使用BLOB类型存储大对象数据，通常会将图片，音频和视频文件存储到服务器得磁盘上，并将图片，音频和视频得访问路径存储到MySQL中。</p><table><thead><tr><th>二进制字符串类型</th><th>值得长度</th><th>长度范围</th><th>占用空间</th></tr></thead><tbody><tr><td>TINYBLOB</td><td>L</td><td>0&lt;=L&lt;=255</td><td>L + 1个字节</td></tr><tr><td>BLOB</td><td>L</td><td>0&lt;=L&lt;=65535(相当于64KB)</td><td>L + 2个字节</td></tr><tr><td>MEDIUMBLOB</td><td>L</td><td>0&lt;=L&lt;=16777215(相当于16MB)</td><td>L + 3个字节</td></tr><tr><td>LONGBLOB</td><td>L</td><td>0&lt;=L&lt;=4294967295(相对于4GB)</td><td>L + 4个字节</td></tr></tbody></table><p><strong>TEXT和BLOB的使用注意事项</strong></p><p>在使用TEXT和BLOB字段类型时要注意以下几点</p><p>BLOB和TEXT值也会引起自己的一些问题，特别是执行了大量的删除或更新操作的时候。删除这种值会在数据表中留下很大的空洞，以后填入这些空洞的记录可能长度不同。为了提高性能，建议定期使用OPTIMIZE TABLE功能对这类表进行碎片整理。</p><p>如果需要对大文本字段进行模糊查询，MySQL提供了前缀索引，但是仍然要在不必要的时候避免检索大型的BLOB或TEXT值。例如，SELECT *查询就不是很好的想法，除非能确定作为约束条件的WHERE子句只会找到所需要的数据行。否则，可能毫无目的地在网络上传输大量的值。</p><p>把BLOB或TEXT列分离到单独的表中。在某些环境中，如果把这些数据列移动到第二张实际表中，可以把原数据表中的数据列转换为固定长度的数据行个数，那么它就是有意义的。这会减少主表中的碎片，并得到固定长度数据行的性能优势。它还可使主数据表上运行SELECT *查询的时候不会通过网络传输大量的BLOB或TEXT值。</p><p><strong>为什么不推荐使用TEXT和BLOB？</strong></p><p>TEXT类型类似于 CHAR（0-255 字节）和 VARCHAR（0-65,535 字节），但可以存储更长的字符串，即长文本数据，例如博客内容。</p><p>BLOB 类型主要用于存储二进制大对象，例如图片、音视频等文件。</p><p>在日常开发中，很少使用 TEXT 类型，但偶尔会用到，而 BLOB 类型则基本不常用。如果预期长度范围可以通过 VARCHAR 来满足，建议避免使用 TEXT。</p><p>数据库规范通常不推荐使用 BLOB 和 TEXT 类型，这两种类型具有一些缺点和限制，例如：</p><ul><li>不能有默认值</li><li>在使用临时表时无法使用内存临时表，只能在磁盘上创建临时表</li><li>检索效率较低</li><li>不能直接创建索引，需要指定前缀长度</li><li>可能会消耗大量的网络和 IO 带宽</li><li>可能导致表上的 DML 操作变慢</li></ul><h3 id=json类型><a class=anchor href=#json类型>#</a> JSON类型</h3><p>JSON(JavaScript Object Notation)是一种轻量级的数据交换格式。简洁和清晰的层次结构使得JSON成为理想的数据交换语义。它易于人阅读和编写，同时也易于机器解析和生成，并有效性地提升网络传输效率。JSON可以将JavaScript对象中表示的一组数据转换为字符串，然后就可以在网络或者程序之间轻松地传递这个字符串，并在需要的时候将它还原为各编程语言所支持的数据格式。</p><p>在MySQL5.7中，就已经支持JSON数据类型。在MySQL8.x版本中，JSON类型提供了可以进行自动验证的JSON文档和优化的存储结构，使得在MySQL中存储和读取JSON类型的数据更加方便和高效。</p><p>创建实际表，表中包含一个JSON类型的字段js。</p><p>通过<code>-&gt;</code>和<code>-&gt;&gt;</code>符号，从JSON字段中正确查询出了指定的JSON数据的值。</p><h3 id=空间类型><a class=anchor href=#空间类型>#</a> 空间类型</h3><p>MySQL空间类型扩展支持地理特征的生成，存储和分析。这里的地理特征表示世界上具有位置的任何东西，可以是一个实体，例如一座山，可以是空间，例如一座办公楼；也可以是一个可定义的位置，例如一个十字路口等。MySQL中使用Geometry(几何)来表示所有地理特征。Geometry指一个点或点的集合，代表世界上任何具有位置的事物。</p><p>MySQL的空间数据类型(Spatial Data Type)对应于OpenGIS类，包括单值类型：GEOMETRY, POINT, LINESTTRING, POLYGON以及集合类型：MULTIPOINT, MULTILINESTRING, MULTIPOLYGON, GEOMETRYCOLLECTION。</p><p>Geometry是所有空间集合类型的基类，其他类型如POINT, LINESTRING, POLYGON都是Geometry的子类。</p><ul><li>Point, 顾名思义就是点，有一个坐标值。例如POINT(121.213342 31.234532), POINT(30 10), 坐标值支持DECIMAL类型，经度(longitude)在前，维度(latitude)在后，用空格分隔</li><li>LineString, 线, 由一系列点连接而成。如果线从头至尾没有交叉，那就是简单的(simple)；如果起点和终点重叠，那就是封闭的(closed)。例如LINESTRING(30 10,10 30,40 40)，点与点之间用逗号分隔，一个点中的经纬度用空格分隔，与POINT格式一致</li><li>Polygon, 多边形。可以是一个实心平面形，即没有内部边界，也可以有空洞，类似纽扣。最简单的就是只有一个外边界的情况。例如POLYGON((0 0，10 0，10 10，0 10))</li></ul><h3 id=小结及选择建议><a class=anchor href=#小结及选择建议>#</a> 小结及选择建议</h3><p>在定义数据类型时，如果确定是整数，就用INT；如果是小数，一定用定点数类型DECIMAL(M,D)；如果是日期与时间，就用DATETIME。</p><p>这样做的好处是，首先确保系统不会因为数据类型定义出错。</p><p>关于字符串的选择</p><ul><li>任何字段如果为非负数，必须是UNSIGNED</li><li>小数类型为DECIMAL，禁止使用FLOAT和DOUBLE<ul><li>在存储的时候，FLOAT和DOUBLE都存在精度损失的问题，很可能在比较值的时候，得到不正确的结果。如果存储的数据范围超过DECIMAL的范围，建议将数据拆成整数和小数并分开存储</li></ul></li><li>如果存储的字符串长度几乎相等，使用CHAR定长字符串类型</li><li>VARCHAR是可变长字符串，不预先分配存储空间，长度不要超过5000。如果存储长度大于此值，定义字段类型为TEXT，独立出来一张表，用主键来对应，避免影响其他字段索引效率</li></ul><div class=tags><a href=/tags/database/ rel=tag><i class="ic i-tag"></i> 数据库</a></div></div><footer><div class=meta><span class=item><span class=icon><i class="ic i-calendar-check"></i></span> <span class=text>更新于</span> <time title="修改时间：2025-09-19 22:24:59" itemprop=dateModified datetime=2025-09-19T22:24:59+08:00>2025-09-19</time></span><span class=item data-path=/computer-science/programming/database/mysql/mspart1/ title=阅读次数><span class=icon><i class="ic i-eye"></i></span> <span class=text>阅读次数</span><span class=waline-pageview-count></span> <span class=text>次</span></span></div><div id=copyright><ul><li class=author><strong>本文作者：</strong> ReverseSacle <i class="ic i-at"><em>@</em></i>逆转天平</li><li class=link><strong>本文链接：</strong> <a href=https://www.reversesacle.com/computer-science/programming/database/mysql/mspart1/ title=MySQL数据库基础-第一部分>https://www.reversesacle.com/computer-science/programming/database/mysql/mspart1/</a></li><li class=license><strong>版权声明：</strong> 本站所有文章除特别声明外，均采用 <span class=exturl data-url=aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class=post-nav><div class="item left"><a href=/computer-science/programming/database/programming/ itemprop=url rel=prev data-background-image=https:&#x2F;&#x2F;resa-imgs.oss-accelerate.aliyuncs.com&#x2F;img&#x2F;acg15.webp title=数据库编程基础><span class=type>上一篇</span><span class=category><i class="ic i-flag"></i> 数据库</span><h3>数据库编程基础</h3></a></div><div class="item right"><a href=/computer-science/programming/database/mysql/mspart2/ itemprop=url rel=next data-background-image=https:&#x2F;&#x2F;resa-imgs.oss-accelerate.aliyuncs.com&#x2F;img&#x2F;acg7.webp title=MySQL数据库基础-第二部分><span class=type>下一篇</span><span class=category><i class="ic i-flag"></i> MySQL</span><h3>MySQL数据库基础-第二部分</h3></a></div></div><div class=wrap id=comments><div id=waline-comment></div></div></div><div id=sidebar><div class=inner><div class=panels><div class=inner><div class="contents panel pjax" data-title=文章目录><ol class=toc><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%A6%82%E8%BF%B0><span class=toc-number>1.</span> <span class=toc-text>!概述</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93relational-database-rdb><span class=toc-number>2.</span> <span class=toc-text>!关系型数据库(Relational Database - RDB)</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E9%9D%9E%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E9%9D%9Erdb><span class=toc-number>3.</span> <span class=toc-text>非关系型数据库(非RDB)</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E8%A1%A8%E8%AE%B0%E5%BD%95%E5%AD%97%E6%AE%B5><span class=toc-number>4.</span> <span class=toc-text>表&#x2F;记录&#x2F;字段</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#mysql%E7%9A%84%E7%99%BB%E5%BD%95><span class=toc-number>5.</span> <span class=toc-text>MySQL的登录</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%B0%8F%E7%BB%93%E4%B8%80><span class=toc-number>6.</span> <span class=toc-text>小结一</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#sql%E5%88%86%E7%B1%BB><span class=toc-number>7.</span> <span class=toc-text>SQL分类</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#sql%E8%AF%AD%E8%A8%80%E7%9A%84%E8%A7%84%E5%88%99%E4%B8%8E%E8%A7%84%E8%8C%83><span class=toc-number>8.</span> <span class=toc-text>SQL语言的规则与规范</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%9F%BA%E6%9C%AC%E7%9A%84select%E8%AF%AD%E5%8F%A5><span class=toc-number>9.</span> <span class=toc-text>基本的SELECT语句</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E8%BF%90%E7%AE%97%E7%AC%A6><span class=toc-number>10.</span> <span class=toc-text>运算符</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%AC%A6><span class=toc-number>10.1.</span> <span class=toc-text>算术运算符</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6><span class=toc-number>10.2.</span> <span class=toc-text>比较运算符</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6><span class=toc-number>10.3.</span> <span class=toc-text>逻辑运算符</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E4%BD%8D%E8%BF%90%E7%AE%97%E7%AC%A6><span class=toc-number>10.4.</span> <span class=toc-text>位运算符</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%8E%92%E5%BA%8F%E4%B8%8E%E5%88%86%E9%A1%B5><span class=toc-number>11.</span> <span class=toc-text>排序与分页</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%8E%92%E5%BA%8F><span class=toc-number>11.1.</span> <span class=toc-text>排序</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%88%86%E9%A1%B5><span class=toc-number>11.2.</span> <span class=toc-text>分页</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2><span class=toc-number>12.</span> <span class=toc-text>多表查询</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#union%E7%9A%84%E4%BD%BF%E7%94%A8><span class=toc-number>13.</span> <span class=toc-text>UNION的使用</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E8%87%AA%E7%84%B6%E8%BF%9E%E6%8E%A5%E4%B8%8Eusing%E8%BF%9E%E6%8E%A5sql99><span class=toc-number>14.</span> <span class=toc-text>自然连接与USING连接(SQL99)</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%B0%8F%E7%BB%93%E4%BA%8C><span class=toc-number>15.</span> <span class=toc-text>小结二</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0><span class=toc-number>16.</span> <span class=toc-text>单行函数</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%95%B0%E5%80%BC%E5%87%BD%E6%95%B0><span class=toc-number>16.1.</span> <span class=toc-text>数值函数</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0><span class=toc-number>16.2.</span> <span class=toc-text>字符串函数</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E5%87%BD%E6%95%B0><span class=toc-number>16.3.</span> <span class=toc-text>日期和时间函数</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E5%87%BD%E6%95%B0><span class=toc-number>16.4.</span> <span class=toc-text>流程控制函数</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%E5%87%BD%E6%95%B0><span class=toc-number>16.5.</span> <span class=toc-text>加密与解密函数</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#mysql%E4%BF%A1%E6%81%AF%E5%87%BD%E6%95%B0><span class=toc-number>16.6.</span> <span class=toc-text>MySQL信息函数</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%85%B6%E4%BB%96%E5%87%BD%E6%95%B0><span class=toc-number>16.7.</span> <span class=toc-text>其他函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0><span class=toc-number>17.</span> <span class=toc-text>聚合函数</span></a></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%AD%90%E6%9F%A5%E8%AF%A2><span class=toc-number>18.</span> <span class=toc-text>子查询</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%AD%90%E6%9F%A5%E8%AF%A2%E7%9A%84%E5%88%86%E7%B1%BB><span class=toc-number>18.1.</span> <span class=toc-text>子查询的分类</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%8D%95%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2><span class=toc-number>18.2.</span> <span class=toc-text>单行子查询</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%A4%9A%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2><span class=toc-number>18.3.</span> <span class=toc-text>多行子查询</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E7%9B%B8%E5%85%B3%E5%AD%90%E6%9F%A5%E8%AF%A2><span class=toc-number>18.4.</span> <span class=toc-text>相关子查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%88%9B%E5%BB%BA%E5%92%8C%E7%AE%A1%E7%90%86%E8%A1%A8><span class=toc-number>19.</span> <span class=toc-text>创建和管理表</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%A6%82%E8%BF%B0-2><span class=toc-number>19.1.</span> <span class=toc-text>概述</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#mysql%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B><span class=toc-number>19.2.</span> <span class=toc-text>MySQL中的数据类型</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93><span class=toc-number>19.3.</span> <span class=toc-text>创建数据库</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E7%AE%A1%E7%90%86%E6%95%B0%E6%8D%AE%E5%BA%93><span class=toc-number>19.4.</span> <span class=toc-text>管理数据库</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%88%9B%E5%BB%BA%E8%A1%A8><span class=toc-number>19.5.</span> <span class=toc-text>创建表</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%86%85%E5%AE%B9%E6%89%A9%E5%B1%95><span class=toc-number>19.6.</span> <span class=toc-text>内容扩展</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E5%A2%9E%E5%88%A0%E6%94%B9dml><span class=toc-number>20.</span> <span class=toc-text>增删改(DML)</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE><span class=toc-number>20.1.</span> <span class=toc-text>插入数据</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE><span class=toc-number>20.2.</span> <span class=toc-text>更新数据</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE><span class=toc-number>20.3.</span> <span class=toc-text>删除数据</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E8%AE%A1%E7%AE%97%E5%88%97mysql8><span class=toc-number>20.4.</span> <span class=toc-text>计算列(MySQL8)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class=toc-link href=#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%AF%A6%E8%A7%A3><span class=toc-number>21.</span> <span class=toc-text>数据类型详解</span></a><ol class=toc-child><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%95%B4%E6%95%B0%E7%B1%BB%E5%9E%8B><span class=toc-number>21.1.</span> <span class=toc-text>!整数类型</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%B5%AE%E7%82%B9%E7%B1%BB%E5%9E%8B><span class=toc-number>21.2.</span> <span class=toc-text>!浮点类型</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%AE%9A%E7%82%B9%E6%95%B0%E7%B1%BB%E5%9E%8B><span class=toc-number>21.3.</span> <span class=toc-text>!定点数类型</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E4%BD%8D%E7%B1%BB%E5%9E%8B><span class=toc-number>21.4.</span> <span class=toc-text>位类型</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4%E7%B1%BB%E5%9E%8B><span class=toc-number>21.5.</span> <span class=toc-text>!日期与时间类型</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E6%96%87%E6%9C%AC%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B><span class=toc-number>21.6.</span> <span class=toc-text>!文本字符串类型</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#enum%E7%B1%BB%E5%9E%8B><span class=toc-number>21.7.</span> <span class=toc-text>ENUM类型</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#set%E7%B1%BB%E5%9E%8B><span class=toc-number>21.8.</span> <span class=toc-text>SET类型</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B><span class=toc-number>21.9.</span> <span class=toc-text>!二进制字符串类型</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#json%E7%B1%BB%E5%9E%8B><span class=toc-number>21.10.</span> <span class=toc-text>JSON类型</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E7%A9%BA%E9%97%B4%E7%B1%BB%E5%9E%8B><span class=toc-number>21.11.</span> <span class=toc-text>空间类型</span></a></li><li class="toc-item toc-level-3"><a class=toc-link href=#%E5%B0%8F%E7%BB%93%E5%8F%8A%E9%80%89%E6%8B%A9%E5%BB%BA%E8%AE%AE><span class=toc-number>21.12.</span> <span class=toc-text>小结及选择建议</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title=系列文章><ul><li class=active><a href=/computer-science/programming/database/mysql/mspart1/ rel=bookmark title=MySQL数据库基础-第一部分>MySQL数据库基础-第一部分</a></li><li><a href=/computer-science/programming/database/mysql/mspart2/ rel=bookmark title=MySQL数据库基础-第二部分>MySQL数据库基础-第二部分</a></li></ul></div><div class="overview panel" data-title=站点概览><div class=author itemprop=author itemscope itemtype=http://schema.org/Person><img class=image itemprop=image alt=ReverseSacle data-src=/images/avatar.webp><p class=name itemprop=name>ReverseSacle</p><div class=description itemprop=description>知识书库 & 学习点滴</div></div><nav class=state><div class="item posts"><a href=/archives/ ><span class=count>186</span> <span class=name>文章</span></a></div><div class="item categories"><a href=/categories/ ><span class=count>52</span> <span class=name>分类</span></a></div><div class="item tags"><a href=/tags/ ><span class=count>18</span> <span class=name>标签</span></a></div></nav><div class=social><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL1JldmVyc2VTYWNsZQ==" title=https:&#x2F;&#x2F;github.com&#x2F;ReverseSacle><i class="ic i-github"></i></span><span class="exturl item email" data-url="bWFpbHRvOnByaXZhdGVAcmV2ZXJzZXNhY2xlLmNvbQ==" title=mailto:private@reversesacle.com><i class="ic i-envelope"></i></span></div><ul class=menu><li class=item><a href=/ rel=section><i class="ic i-home"></i> 首页</a></li><li class="item dropdown"><a href=javascript:void(0);><i class="ic i-feather"></i> 文章</a><ul class=submenu><li class=item><a href=/archives/ rel=section><i class="ic i-list-alt"></i> 归档</a></li><li class=item><a href=/categories/ rel=section><i class="ic i-th"></i> 分类</a></li><li class=item><a href=/tags/ rel=section><i class="ic i-tags"></i> 标签</a></li></ul></li><li class=item><a href=/about/ rel=section><i class="ic i-user"></i> 关于</a></li><li class=item><a href=/friend-links/ rel=section><i class="ic i-heart"></i> 友链</a></li></ul></div></div></div><ul id=quick><li class="prev pjax"><a href=/computer-science/programming/database/programming/ rel=prev title=上一篇><i class="ic i-chevron-left"></i></a></li><li class=up><i class="ic i-arrow-up"></i></li><li class=down><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href=/computer-science/programming/database/mysql/mspart2/ rel=next title=下一篇><i class="ic i-chevron-right"></i></a></li><li class=percent></li></ul></div></div><div class=dimmer></div></div></main><footer id=footer><div class=inner><div class=widgets><div class="rpost pjax"><h2>随机文章</h2><ul><li class=item><div class=breadcrumb><a href=/categories/computer-science/ title="分类于 计算机科学">计算机科学</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/ title="分类于 编程">编程</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/reverse-engineering/ title="分类于 逆向工程">逆向工程</a></div><span><a href=/computer-science/programming/reverse-engineering/packet-sniffing/ title="Fiddler Everywhere与Charles抓包">Fiddler Everywhere与Charles抓包</a></span></li><li class=item><div class=breadcrumb><a href=/categories/computer-science/ title="分类于 计算机科学">计算机科学</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/ title="分类于 编程">编程</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/c-language/ title="分类于 C语言">C语言</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/c-language/binary-tree/ title="分类于 二叉树">二叉树</a></div><span><a href=/computer-science/programming/c-language/c-algorithm/binary-tree/sum/ title=二叉树-求和>二叉树-求和</a></span></li><li class=item><div class=breadcrumb><a href=/categories/general-science-and-technology/ title="分类于 通用科学技术">通用科学技术</a><i class="ic i-angle-right"></i> <a href=/categories/general-science-and-technology/pc/ title="分类于 通用技术之PC端">通用技术之PC端</a><i class="ic i-angle-right"></i> <a href=/categories/general-science-and-technology/pc/external-device/ title="分类于 外接设备">外接设备</a></div><span><a href=/general-science-and-technology/pc/external-device/external-screen-guidance/ title=外接显示屏DIY指南>外接显示屏DIY指南</a></span></li><li class=item><div class=breadcrumb><a href=/categories/computer-science/ title="分类于 计算机科学">计算机科学</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/ title="分类于 编程">编程</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/network-programming/ title="分类于 网络编程">网络编程</a></div><span><a href=/computer-science/programming/network-programming/gdb-debugging-tool/ title=GDB调试工具>GDB调试工具</a></span></li><li class=item><div class=breadcrumb><a href=/categories/computer-science/ title="分类于 计算机科学">计算机科学</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/ title="分类于 编程">编程</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/c-language/ title="分类于 C语言">C语言</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/c-language/string/ title="分类于 字符串">字符串</a></div><span><a href=/computer-science/programming/c-language/c-algorithm/string/nums/ title=字符串-数理>字符串-数理</a></span></li><li class=item><div class=breadcrumb><a href=/categories/computer-science/ title="分类于 计算机科学">计算机科学</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/ title="分类于 编程">编程</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/c-language/ title="分类于 C语言">C语言</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/c-language/c-data-structure/ title="分类于 C语言数据结构">C语言数据结构</a></div><span><a href=/computer-science/programming/c-language/c-data-structure/graph/ title=非线性结构之图>非线性结构之图</a></span></li><li class=item><div class=breadcrumb><a href=/categories/computer-science/ title="分类于 计算机科学">计算机科学</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/ title="分类于 编程">编程</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/dev-tool/ title="分类于 开发工具">开发工具</a></div><span><a href=/computer-science/programming/dev-tool/git/ title=分布式版本控制系统Git>分布式版本控制系统Git</a></span></li><li class=item><div class=breadcrumb><a href=/categories/computer-science/ title="分类于 计算机科学">计算机科学</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/computer-basic/ title="分类于 计算机基础">计算机基础</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/computer-basic/computer-network/ title="分类于 计算机网络">计算机网络</a></div><span><a href=/computer-science/computer-basic/network/nwpart1/ title=计算机网络-第一部分>计算机网络-第一部分</a></span></li><li class=item><div class=breadcrumb><a href=/categories/computer-science/ title="分类于 计算机科学">计算机科学</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/ title="分类于 编程">编程</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/c-language/ title="分类于 C语言">C语言</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/c-language/c-algorithm/ title="分类于 C版算法">C版算法</a></div><span><a href=/computer-science/programming/c-language/c-algorithm/nums/ title=数理>数理</a></span></li><li class=item><div class=breadcrumb><a href=/categories/computer-science/ title="分类于 计算机科学">计算机科学</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/ title="分类于 编程">编程</a><i class="ic i-angle-right"></i> <a href=/categories/computer-science/programming/network-programming/ title="分类于 网络编程">网络编程</a></div><span><a href=/computer-science/programming/network-programming/executable-program/ title=在C&#x2F;C++程序中调用可执行程序>在C/C++程序中调用可执行程序</a></span></li></ul></div><div><h2>最新评论</h2><ul id=waline-recent></ul></div></div><div class=status><div class=copyright>&copy; 2021 – <span itemprop=copyrightYear>2025</span><span class=with-love><i class="ic i-sakura rotate"></i></span> <span class=author itemprop=copyrightHolder>ReverseSacle @ ReverseSacle-Blog</span></div><div class=count><i class="ic i-clock" aria-hidden=true></i> <span id=time align=center>载入时间中...<script defer>var now=new Date;function createtime(){var n=new Date("2021-11-16 22:30:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("time").innerHTML="已经过 "+dnum+" 天 "+hnum+" 小时 "+mnum+" 分 "+snum+" 秒 "}setInterval("createtime()",250)</script></span><span class=post-meta-item-icon>|&nbsp<i class="ic i-chart-area"></i></span> <span title=站点总字数>2.1m 字</span> <span class=post-meta-item-icon>|&nbsp<i class="ic i-coffee"></i></span> <span title=站点阅读时长>40:40</span></div></div></div></footer></div><script data-config>var LOCAL={path:"computer-science/programming/database/mysql/mspart1/",favicon:{show:"ReverseSacle-Blog",hide:"ReverseSacle-Blog"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},waline:!0,copy_tex:!0,katex:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src=https://polyfill.alicdn.com/v3/polyfill.min.js></script><script src=https://cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1.16.0/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js></script><script src=/js/app.js></script></body></html>